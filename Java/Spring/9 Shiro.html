<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Shiro | Conanan</title>
    <meta name="description" content="Good Good Study, Day Day Up!">
    <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <script src="https://cdn.jsdelivr.net/npm/react/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
    
    <link rel="preload" href="/assets/css/0.styles.721694fb.css" as="style"><link rel="preload" href="/assets/js/app.4c2406b8.js" as="script"><link rel="preload" href="/assets/js/2.4ce794f3.js" as="script"><link rel="preload" href="/assets/js/31.c168f15b.js" as="script"><link rel="preload" href="/assets/js/33.9b523a1b.js" as="script"><link rel="prefetch" href="/assets/js/10.23584843.js"><link rel="prefetch" href="/assets/js/100.c8b7e6eb.js"><link rel="prefetch" href="/assets/js/101.22710827.js"><link rel="prefetch" href="/assets/js/102.369790c1.js"><link rel="prefetch" href="/assets/js/103.a7c7b572.js"><link rel="prefetch" href="/assets/js/104.7e45de8b.js"><link rel="prefetch" href="/assets/js/105.4791b02d.js"><link rel="prefetch" href="/assets/js/106.61e23a2f.js"><link rel="prefetch" href="/assets/js/107.8ae0e37f.js"><link rel="prefetch" href="/assets/js/108.ad785e65.js"><link rel="prefetch" href="/assets/js/109.f6c3b7e5.js"><link rel="prefetch" href="/assets/js/11.1af6c419.js"><link rel="prefetch" href="/assets/js/110.55979e31.js"><link rel="prefetch" href="/assets/js/111.09bcf468.js"><link rel="prefetch" href="/assets/js/112.17a7c3b1.js"><link rel="prefetch" href="/assets/js/113.9f55e6f6.js"><link rel="prefetch" href="/assets/js/114.ae0d1063.js"><link rel="prefetch" href="/assets/js/115.2b45ae89.js"><link rel="prefetch" href="/assets/js/116.286c2ead.js"><link rel="prefetch" href="/assets/js/117.bd5437e0.js"><link rel="prefetch" href="/assets/js/118.4dd27249.js"><link rel="prefetch" href="/assets/js/119.7be1a2b0.js"><link rel="prefetch" href="/assets/js/12.bc5e4411.js"><link rel="prefetch" href="/assets/js/120.03a04cae.js"><link rel="prefetch" href="/assets/js/121.b657ffcb.js"><link rel="prefetch" href="/assets/js/122.eb76f0ee.js"><link rel="prefetch" href="/assets/js/123.cebd7ceb.js"><link rel="prefetch" href="/assets/js/124.be49618b.js"><link rel="prefetch" href="/assets/js/125.d7aa08e6.js"><link rel="prefetch" href="/assets/js/126.4ad7d0d8.js"><link rel="prefetch" href="/assets/js/127.fe7a1fc9.js"><link rel="prefetch" href="/assets/js/128.18adee58.js"><link rel="prefetch" href="/assets/js/129.65155f32.js"><link rel="prefetch" href="/assets/js/13.46b8bbae.js"><link rel="prefetch" href="/assets/js/130.115199fd.js"><link rel="prefetch" href="/assets/js/131.c30c37e8.js"><link rel="prefetch" href="/assets/js/132.800d09de.js"><link rel="prefetch" href="/assets/js/133.485f2c5a.js"><link rel="prefetch" href="/assets/js/134.68cc802a.js"><link rel="prefetch" href="/assets/js/135.b48b5611.js"><link rel="prefetch" href="/assets/js/136.273edc30.js"><link rel="prefetch" href="/assets/js/137.c51bf33b.js"><link rel="prefetch" href="/assets/js/138.cc73926e.js"><link rel="prefetch" href="/assets/js/139.7f0835b0.js"><link rel="prefetch" href="/assets/js/14.813fdf39.js"><link rel="prefetch" href="/assets/js/140.4b5c8664.js"><link rel="prefetch" href="/assets/js/141.f645668a.js"><link rel="prefetch" href="/assets/js/142.9c31754b.js"><link rel="prefetch" href="/assets/js/143.8dbb577a.js"><link rel="prefetch" href="/assets/js/144.615f3d5a.js"><link rel="prefetch" href="/assets/js/145.3372b6f7.js"><link rel="prefetch" href="/assets/js/146.9d166547.js"><link rel="prefetch" href="/assets/js/147.b35e2060.js"><link rel="prefetch" href="/assets/js/148.2ca9cb36.js"><link rel="prefetch" href="/assets/js/149.b7aae87e.js"><link rel="prefetch" href="/assets/js/15.c027e524.js"><link rel="prefetch" href="/assets/js/150.bad9858c.js"><link rel="prefetch" href="/assets/js/151.fd17d6b4.js"><link rel="prefetch" href="/assets/js/152.2567ef97.js"><link rel="prefetch" href="/assets/js/153.74559d88.js"><link rel="prefetch" href="/assets/js/154.7acecdef.js"><link rel="prefetch" href="/assets/js/155.f457419c.js"><link rel="prefetch" href="/assets/js/156.6fe3ee1a.js"><link rel="prefetch" href="/assets/js/157.fd08fd72.js"><link rel="prefetch" href="/assets/js/158.2b46cf37.js"><link rel="prefetch" href="/assets/js/159.3ace6e8d.js"><link rel="prefetch" href="/assets/js/16.485682dd.js"><link rel="prefetch" href="/assets/js/160.512cf1fa.js"><link rel="prefetch" href="/assets/js/161.0d0ee2ea.js"><link rel="prefetch" href="/assets/js/162.bbdff718.js"><link rel="prefetch" href="/assets/js/163.4fdc9dff.js"><link rel="prefetch" href="/assets/js/164.20d6ef11.js"><link rel="prefetch" href="/assets/js/165.2881201e.js"><link rel="prefetch" href="/assets/js/166.3c7c3ba0.js"><link rel="prefetch" href="/assets/js/167.2143078a.js"><link rel="prefetch" href="/assets/js/168.9f3840f3.js"><link rel="prefetch" href="/assets/js/169.2da8b99f.js"><link rel="prefetch" href="/assets/js/17.53e3a4c9.js"><link rel="prefetch" href="/assets/js/170.997a014a.js"><link rel="prefetch" href="/assets/js/171.addd9a55.js"><link rel="prefetch" href="/assets/js/172.d3d12b0c.js"><link rel="prefetch" href="/assets/js/173.ebd6be51.js"><link rel="prefetch" href="/assets/js/174.c3546734.js"><link rel="prefetch" href="/assets/js/175.e786b04c.js"><link rel="prefetch" href="/assets/js/176.8a72d21e.js"><link rel="prefetch" href="/assets/js/177.4d74c35d.js"><link rel="prefetch" href="/assets/js/178.05b55aba.js"><link rel="prefetch" href="/assets/js/179.06c93c02.js"><link rel="prefetch" href="/assets/js/18.dac780ce.js"><link rel="prefetch" href="/assets/js/180.7a721d6a.js"><link rel="prefetch" href="/assets/js/181.854b3f72.js"><link rel="prefetch" href="/assets/js/182.19f58d6b.js"><link rel="prefetch" href="/assets/js/183.8f49d5b6.js"><link rel="prefetch" href="/assets/js/184.2128f02f.js"><link rel="prefetch" href="/assets/js/19.5bd66b43.js"><link rel="prefetch" href="/assets/js/20.8b0be400.js"><link rel="prefetch" href="/assets/js/21.26154688.js"><link rel="prefetch" href="/assets/js/22.75f3ad5d.js"><link rel="prefetch" href="/assets/js/23.205b8a93.js"><link rel="prefetch" href="/assets/js/24.78eaf948.js"><link rel="prefetch" href="/assets/js/25.5ac44d02.js"><link rel="prefetch" href="/assets/js/26.44e96c5e.js"><link rel="prefetch" href="/assets/js/27.9149de82.js"><link rel="prefetch" href="/assets/js/28.a117fe70.js"><link rel="prefetch" href="/assets/js/29.03c4dd26.js"><link rel="prefetch" href="/assets/js/3.a07e7c66.js"><link rel="prefetch" href="/assets/js/30.add3b4ce.js"><link rel="prefetch" href="/assets/js/32.6df3dd67.js"><link rel="prefetch" href="/assets/js/34.87d0684d.js"><link rel="prefetch" href="/assets/js/35.07031e68.js"><link rel="prefetch" href="/assets/js/36.b2d8e023.js"><link rel="prefetch" href="/assets/js/37.6693f2b8.js"><link rel="prefetch" href="/assets/js/38.0adc87b6.js"><link rel="prefetch" href="/assets/js/39.4ee1b450.js"><link rel="prefetch" href="/assets/js/4.3601d982.js"><link rel="prefetch" href="/assets/js/40.3a15c4d2.js"><link rel="prefetch" href="/assets/js/41.5089de95.js"><link rel="prefetch" href="/assets/js/42.b6c516e6.js"><link rel="prefetch" href="/assets/js/43.4d729b64.js"><link rel="prefetch" href="/assets/js/44.afb6ada5.js"><link rel="prefetch" href="/assets/js/45.f90fef77.js"><link rel="prefetch" href="/assets/js/46.3f992a07.js"><link rel="prefetch" href="/assets/js/47.3df4792a.js"><link rel="prefetch" href="/assets/js/48.b1b42695.js"><link rel="prefetch" href="/assets/js/49.1f57735c.js"><link rel="prefetch" href="/assets/js/5.c77010ac.js"><link rel="prefetch" href="/assets/js/50.fb1f131c.js"><link rel="prefetch" href="/assets/js/51.621e6bbe.js"><link rel="prefetch" href="/assets/js/52.d3c5f8e8.js"><link rel="prefetch" href="/assets/js/53.fc428b5d.js"><link rel="prefetch" href="/assets/js/54.a8c7b4e7.js"><link rel="prefetch" href="/assets/js/55.9491ad4c.js"><link rel="prefetch" href="/assets/js/56.cc5535aa.js"><link rel="prefetch" href="/assets/js/57.08a4a942.js"><link rel="prefetch" href="/assets/js/58.ea5e0d13.js"><link rel="prefetch" href="/assets/js/59.e9ab1cc2.js"><link rel="prefetch" href="/assets/js/6.3dc37407.js"><link rel="prefetch" href="/assets/js/60.a0651ffe.js"><link rel="prefetch" href="/assets/js/61.9657adee.js"><link rel="prefetch" href="/assets/js/62.5522a97a.js"><link rel="prefetch" href="/assets/js/63.2c5c6db3.js"><link rel="prefetch" href="/assets/js/64.57e79c12.js"><link rel="prefetch" href="/assets/js/65.5e0e9f19.js"><link rel="prefetch" href="/assets/js/66.e80de9ef.js"><link rel="prefetch" href="/assets/js/67.147e8e38.js"><link rel="prefetch" href="/assets/js/68.26a3c0d4.js"><link rel="prefetch" href="/assets/js/69.8f293aac.js"><link rel="prefetch" href="/assets/js/7.53864b7a.js"><link rel="prefetch" href="/assets/js/70.291565bb.js"><link rel="prefetch" href="/assets/js/71.fe0bdf0f.js"><link rel="prefetch" href="/assets/js/72.61d2bc84.js"><link rel="prefetch" href="/assets/js/73.9fcb62aa.js"><link rel="prefetch" href="/assets/js/74.9d682c13.js"><link rel="prefetch" href="/assets/js/75.3264a4ce.js"><link rel="prefetch" href="/assets/js/76.1f8b1f97.js"><link rel="prefetch" href="/assets/js/77.32b48d28.js"><link rel="prefetch" href="/assets/js/78.b50a8708.js"><link rel="prefetch" href="/assets/js/79.e9abf630.js"><link rel="prefetch" href="/assets/js/8.50c01faa.js"><link rel="prefetch" href="/assets/js/80.180a3806.js"><link rel="prefetch" href="/assets/js/81.7800a9ae.js"><link rel="prefetch" href="/assets/js/82.388bd268.js"><link rel="prefetch" href="/assets/js/83.27d7c820.js"><link rel="prefetch" href="/assets/js/84.a7be62b6.js"><link rel="prefetch" href="/assets/js/85.e286c095.js"><link rel="prefetch" href="/assets/js/86.84fed10f.js"><link rel="prefetch" href="/assets/js/87.4b95dccb.js"><link rel="prefetch" href="/assets/js/88.dd70f5b5.js"><link rel="prefetch" href="/assets/js/89.4a04d404.js"><link rel="prefetch" href="/assets/js/9.947b77c2.js"><link rel="prefetch" href="/assets/js/90.699f3eeb.js"><link rel="prefetch" href="/assets/js/91.9f21bc4f.js"><link rel="prefetch" href="/assets/js/92.8e8caa65.js"><link rel="prefetch" href="/assets/js/93.08b1a369.js"><link rel="prefetch" href="/assets/js/94.8aa7234f.js"><link rel="prefetch" href="/assets/js/95.1d25fc22.js"><link rel="prefetch" href="/assets/js/96.8bb62cc7.js"><link rel="prefetch" href="/assets/js/97.eed16352.js"><link rel="prefetch" href="/assets/js/98.623e948b.js"><link rel="prefetch" href="/assets/js/99.45cfef32.js">
    <link rel="stylesheet" href="/assets/css/0.styles.721694fb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Conanan</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Basic" class="dropdown-title"><span class="title">Basic</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>OS</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Basic/OS/Linux/0 Intro.html" class="nav-link">Linux</a></li><li class="dropdown-subitem"><a href="/Basic/OS/Docker/0 Docker.html" class="nav-link">Docker</a></li><li class="dropdown-subitem"><a href="/Basic/OS/K8/0 Intro.html" class="nav-link">K8</a></li></ul></li><li class="dropdown-item"><h4>Network</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Basic/Network/TCP/IP/0 Intro.html" class="nav-link">TCP/IP</a></li><li class="dropdown-subitem"><a href="/Basic/Network/HTTP/0 Intro.html" class="nav-link">HTTP</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="DataBase" class="dropdown-title"><span class="title">DataBase</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/DataBase/RDBMS/0 Primer.html" class="nav-link">RDBMS</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Redis/0 Intro.html" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Mongo/0 Intro.html" class="nav-link">Mongo</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Lucene/0 Primer.html" class="nav-link">Lucene</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Solr/0 Primer.html" class="nav-link">Solr</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Elasticsearch/0 Primer.html" class="nav-link">Elasticsearch</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Design" class="dropdown-title"><span class="title">Design</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Design/Design Pattern/0 Intro.html" class="nav-link">Design Pattern</a></li><li class="dropdown-item"><!----> <a href="/Design/DDD/0 Basic.html" class="nav-link">DDD</a></li><li class="dropdown-item"><!----> <a href="/Design/MicroServer/0 Intro.html" class="nav-link">MicroServer</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java Study" class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Java/Core/0 Basic.html" class="nav-link">Core</a></li><li class="dropdown-item"><!----> <a href="/Java/Jakarta EE/0 Servlet.html" class="nav-link">Jakarta EE</a></li><li class="dropdown-item"><!----> <a href="/Java/Spring/primer/0 Primer.html" class="nav-link">Spring</a></li><li class="dropdown-item"><!----> <a href="/Java/Persistence/Mybatis/0 Primer.html" class="nav-link">Persistence</a></li><li class="dropdown-item"><!----> <a href="/Java/Authe&amp;Autho/0 Primer.html" class="nav-link">认证&amp;授权</a></li><li class="dropdown-item"><h4>分布式&amp;微服务</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/language/chinese/" class="nav-link">Dubbo</a></li><li class="dropdown-subitem"><a href="/language/japanese/" class="nav-link">Spring Cloud Netflix</a></li><li class="dropdown-subitem"><a href="/language/japanese/" class="nav-link">Spring Cloud Alibaba</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Tools" class="dropdown-title"><span class="title">Tools</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Tools/Vim/Vim.html" class="nav-link">Vim</a></li><li class="dropdown-item"><!----> <a href="/Tools/Git/Git.html" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/Tools/Maven/Maven.html" class="nav-link">Maven</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Server" class="dropdown-title"><span class="title">Server</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Server/Tomcat/0 Primer.html" class="nav-link">Tomcat</a></li><li class="dropdown-item"><!----> <a href="/Server/Nginx/0 Primer.html" class="nav-link">Nginx</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Front End" class="dropdown-title"><span class="title">Front End</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Front End/H5&amp;CSS3/1 HTML.html" class="nav-link">H5&amp;CSS3</a></li><li class="dropdown-item"><!----> <a href="/Front End/JS/0 入门-0 入门.html" class="nav-link">JS</a></li><li class="dropdown-item"><!----> <a href="/Front End/NodeJS/NodeJS-1 入门.html" class="nav-link">NodeJS</a></li><li class="dropdown-item"><!----> <a href="/Front End/Vue/1-1 Primer.html" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/Front End/微信小程序/1-1 Primer.html" class="nav-link">微信小程序</a></li><li class="dropdown-item"><!----> <a href="/Front End/Android/0 Intro.html" class="nav-link">Android</a></li><li class="dropdown-item"><!----> <a href="/Front End/Flutter/0 Intro.html" class="nav-link">Flutter</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Environment" class="dropdown-title"><span class="title">Environment</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Environment/macOS/macOS.html" class="nav-link">macOS</a></li><li class="dropdown-item"><!----> <a href="/Environment/Windows/Windows.html" class="nav-link">Windows</a></li><li class="dropdown-item"><!----> <a href="/Environment/Software/IDEA.html" class="nav-link">Software</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Project" class="dropdown-title"><span class="title">Project</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Project/电商/简介.html" class="nav-link">电商</a></li><li class="dropdown-item"><!----> <a href="/Environment/Linux/Linux.html" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/Environment/Windows/Windows.html" class="nav-link">Windows</a></li><li class="dropdown-item"><!----> <a href="/Environment/Software/Software.html" class="nav-link">Software</a></li></ul></div></div> <a href="https://github.com/apple54whn/notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Basic" class="dropdown-title"><span class="title">Basic</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>OS</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Basic/OS/Linux/0 Intro.html" class="nav-link">Linux</a></li><li class="dropdown-subitem"><a href="/Basic/OS/Docker/0 Docker.html" class="nav-link">Docker</a></li><li class="dropdown-subitem"><a href="/Basic/OS/K8/0 Intro.html" class="nav-link">K8</a></li></ul></li><li class="dropdown-item"><h4>Network</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Basic/Network/TCP/IP/0 Intro.html" class="nav-link">TCP/IP</a></li><li class="dropdown-subitem"><a href="/Basic/Network/HTTP/0 Intro.html" class="nav-link">HTTP</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="DataBase" class="dropdown-title"><span class="title">DataBase</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/DataBase/RDBMS/0 Primer.html" class="nav-link">RDBMS</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Redis/0 Intro.html" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Mongo/0 Intro.html" class="nav-link">Mongo</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Lucene/0 Primer.html" class="nav-link">Lucene</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Solr/0 Primer.html" class="nav-link">Solr</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Elasticsearch/0 Primer.html" class="nav-link">Elasticsearch</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Design" class="dropdown-title"><span class="title">Design</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Design/Design Pattern/0 Intro.html" class="nav-link">Design Pattern</a></li><li class="dropdown-item"><!----> <a href="/Design/DDD/0 Basic.html" class="nav-link">DDD</a></li><li class="dropdown-item"><!----> <a href="/Design/MicroServer/0 Intro.html" class="nav-link">MicroServer</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java Study" class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Java/Core/0 Basic.html" class="nav-link">Core</a></li><li class="dropdown-item"><!----> <a href="/Java/Jakarta EE/0 Servlet.html" class="nav-link">Jakarta EE</a></li><li class="dropdown-item"><!----> <a href="/Java/Spring/primer/0 Primer.html" class="nav-link">Spring</a></li><li class="dropdown-item"><!----> <a href="/Java/Persistence/Mybatis/0 Primer.html" class="nav-link">Persistence</a></li><li class="dropdown-item"><!----> <a href="/Java/Authe&amp;Autho/0 Primer.html" class="nav-link">认证&amp;授权</a></li><li class="dropdown-item"><h4>分布式&amp;微服务</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/language/chinese/" class="nav-link">Dubbo</a></li><li class="dropdown-subitem"><a href="/language/japanese/" class="nav-link">Spring Cloud Netflix</a></li><li class="dropdown-subitem"><a href="/language/japanese/" class="nav-link">Spring Cloud Alibaba</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Tools" class="dropdown-title"><span class="title">Tools</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Tools/Vim/Vim.html" class="nav-link">Vim</a></li><li class="dropdown-item"><!----> <a href="/Tools/Git/Git.html" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/Tools/Maven/Maven.html" class="nav-link">Maven</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Server" class="dropdown-title"><span class="title">Server</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Server/Tomcat/0 Primer.html" class="nav-link">Tomcat</a></li><li class="dropdown-item"><!----> <a href="/Server/Nginx/0 Primer.html" class="nav-link">Nginx</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Front End" class="dropdown-title"><span class="title">Front End</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Front End/H5&amp;CSS3/1 HTML.html" class="nav-link">H5&amp;CSS3</a></li><li class="dropdown-item"><!----> <a href="/Front End/JS/0 入门-0 入门.html" class="nav-link">JS</a></li><li class="dropdown-item"><!----> <a href="/Front End/NodeJS/NodeJS-1 入门.html" class="nav-link">NodeJS</a></li><li class="dropdown-item"><!----> <a href="/Front End/Vue/1-1 Primer.html" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/Front End/微信小程序/1-1 Primer.html" class="nav-link">微信小程序</a></li><li class="dropdown-item"><!----> <a href="/Front End/Android/0 Intro.html" class="nav-link">Android</a></li><li class="dropdown-item"><!----> <a href="/Front End/Flutter/0 Intro.html" class="nav-link">Flutter</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Environment" class="dropdown-title"><span class="title">Environment</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Environment/macOS/macOS.html" class="nav-link">macOS</a></li><li class="dropdown-item"><!----> <a href="/Environment/Windows/Windows.html" class="nav-link">Windows</a></li><li class="dropdown-item"><!----> <a href="/Environment/Software/IDEA.html" class="nav-link">Software</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Project" class="dropdown-title"><span class="title">Project</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Project/电商/简介.html" class="nav-link">电商</a></li><li class="dropdown-item"><!----> <a href="/Environment/Linux/Linux.html" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/Environment/Windows/Windows.html" class="nav-link">Windows</a></li><li class="dropdown-item"><!----> <a href="/Environment/Software/Software.html" class="nav-link">Software</a></li></ul></div></div> <a href="https://github.com/apple54whn/notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Primer</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Spring</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>SpringMVC</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Other</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Shiro</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Java/Spring/9 Shiro.html" class="active sidebar-link">Shiro</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#功能" class="sidebar-link">功能</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#架构" class="sidebar-link">架构</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#subject-🔥" class="sidebar-link">Subject 🔥</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#securitymanager-🔥" class="sidebar-link">SecurityManager 🔥</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#realm-🔥" class="sidebar-link">Realm 🔥</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#authenticator" class="sidebar-link">Authenticator</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#authrizer" class="sidebar-link">Authrizer</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#sessionmanager" class="sidebar-link">SessionManager</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#sessiondao" class="sidebar-link">SessionDAO</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#cachemanager" class="sidebar-link">CacheManager</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#cryptography" class="sidebar-link">Cryptography</a></li></ul></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#术语" class="sidebar-link">术语</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#authentication—认证" class="sidebar-link">Authentication—认证</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#authorization—授权" class="sidebar-link">Authorization—授权</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#cipher—加密算法" class="sidebar-link">Cipher—加密算法</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#credential—凭据-🔥" class="sidebar-link">Credential—凭据 🔥</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#cryptography—加密" class="sidebar-link">Cryptography—加密</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#hash—哈希" class="sidebar-link">Hash—哈希</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#permission—权限" class="sidebar-link">Permission—权限</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#principal—主体-🔥" class="sidebar-link">Principal—主体 🔥</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#realm—领域" class="sidebar-link">Realm—领域</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#role—角色" class="sidebar-link">Role—角色</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#session—会话" class="sidebar-link">Session—会话</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#subject" class="sidebar-link">Subject</a></li></ul></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#authentication—认证-2" class="sidebar-link">Authentication—认证</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#认证流程" class="sidebar-link">认证流程</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#authenticator-2" class="sidebar-link">Authenticator</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#authenticationstrategy" class="sidebar-link">AuthenticationStrategy</a></li></ul></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#quickstart" class="sidebar-link">QuickStart</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#引入依赖" class="sidebar-link">引入依赖</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#配置" class="sidebar-link">配置</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#示例" class="sidebar-link">示例</a></li></ul></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#web-应用程序" class="sidebar-link">Web 应用程序</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#引入依赖-2" class="sidebar-link">引入依赖</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#提供-realm-实现" class="sidebar-link">提供 Realm 实现</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#shirofilterchaindefinition" class="sidebar-link">ShiroFilterChainDefinition</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#shiro-注解" class="sidebar-link">Shiro 注解</a></li></ul></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#独立应用程序—☠️" class="sidebar-link">独立应用程序—☠️</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#引入依赖-3" class="sidebar-link">引入依赖</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#自定义-realm-类" class="sidebar-link">自定义 Realm 类</a></li></ul></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#过滤器" class="sidebar-link">过滤器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#anon-🔥" class="sidebar-link">anon 🔥</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#authc-🔥" class="sidebar-link">authc 🔥</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#perms-🔥" class="sidebar-link">perms 🔥</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#roles" class="sidebar-link">roles</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#logout-🔥" class="sidebar-link">logout 🔥</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#rest-🔥" class="sidebar-link">rest 🔥</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#user" class="sidebar-link">user</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#authcbasic-🔥" class="sidebar-link">authcBasic 🔥</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#authcbearer" class="sidebar-link">authcBearer</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#nosessioncreation" class="sidebar-link">noSessionCreation</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#port" class="sidebar-link">port</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#ssl" class="sidebar-link">ssl</a></li></ul></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#tag" class="sidebar-link">Tag</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#caching" class="sidebar-link">Caching</a></li><li class="sidebar-sub-header"><a href="/Java/Spring/9 Shiro.html#configuration-properties" class="sidebar-link">Configuration Properties</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="shiro"><a href="#shiro" class="header-anchor">#</a> Shiro</h1> <h2 id="功能"><a href="#功能" class="header-anchor">#</a> 功能</h2> <p><a href="https://shiro.apache.org/index.html" target="_blank" rel="noopener noreferrer">官方文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>Apache Shiro是一个功能强大且灵活的开源安全框架，可以干净地处理身份认证，授权，企业会话管理和加密。Apache Shiro的首要目标是易于使用和理解。 安全有时可能非常复杂，甚至会很痛苦，但这不是必须的。 框架应尽可能掩盖复杂性，并公开简洁直观的API，以简化开发人员确保其应用程序安全的工作。Shiro功能如下：</p> <p><img src="/assets/img/ShiroFeatures.7f3d6693.png" alt="img"></p> <p>Primary Concerns</p> <ul><li><strong>认证</strong>：有时称为“登录”，这是证明用户就是他们所说的身份的行为。</li> <li><strong>授权</strong>：访问控制的过程，即确定“谁”有权访问“什么”。</li> <li>会话管理：即使在非Web或EJB应用程序中，也可以管理用户特定的会话。</li> <li>加密：使用密码算法保持数据安全，同时仍然易于使用。</li></ul> <p>Supporting Features</p> <ul><li>网络支持：Shiro的网络支持API可帮助轻松保护网络应用程序。</li> <li>缓存：缓存是Apache Shiro API的一线公民，可确保安全操作保持快速有效。比如用户登录后，其用户信息、拥有的角色/权限不必每次去查，这样可以提高效率；</li> <li>并发性：Apache Shiro的并发功能支持多线程应用程序。即如在一个线程中开启另一个线程，能把权限自动传播过去；</li> <li>测试：测试支持可帮助您编写单元测试和集成测试，并确保您的代码将按预期进行保护。</li> <li>“<strong>Run As</strong>”：允许用户采用其他用户的身份（如果允许）的功能，有时在管理方案中很有用。</li> <li>“<strong>Remember Me</strong>”：记住用户在各个会话中的身份，因此他们只需要在必要时登录即可。</li></ul> <h2 id="架构"><a href="#架构" class="header-anchor">#</a> 架构</h2> <p>Apache Shiro的设计目标是通过直观且易于使用来简化应用程序安全性。Shiro的核心设计模拟了大多数人如何在与某人（或某物）进行交互的情况下如何考虑应用程序安全性。</p> <p>在最高概念层次，Shiro 的架构有3个主要的概念：<code>Subject</code>，<code>SecurityManager</code>和<code>Realms</code>。下图是这些组件如何交互的高级概述，我们将在下面介绍每个概念：</p> <p><img src="/assets/img/ShiroBasicArchitecture.a54b0384.png" alt="img"></p> <h3 id="subject-🔥"><a href="#subject-🔥" class="header-anchor">#</a> Subject 🔥</h3> <p><strong>Subject 本质上是当前执行用户的特定于安全性的“视图”</strong>。 “用户”一词通常表示一个人，而主题可以是一个人，但是它也可以表示第三方服务，守护程序帐户，定时任务或类似的东西，基本上是<strong>当前与该软件交互的任何东西</strong>。<strong>Subject 实例都绑定到（并需要）SecurityManager</strong>。与 Subject 进行交互时，这些交互会转换为与 SecurityManager 的特定 Subject 的交互。</p> <h3 id="securitymanager-🔥"><a href="#securitymanager-🔥" class="header-anchor">#</a> SecurityManager 🔥</h3> <p><strong>SecurityManager 是 Shiro 体系结构的核心</strong>，充当一种伞形对象，协调其内部安全组件，这些组件一起形成一个对象图。但是，一旦为应用程序配置了SecurityManager及其内部对象图，它通常就会被搁置，应用程序开发人员几乎把所有时间都花在Subject API上。稍后我们将详细讨论SecurityManager，但重要的是要认识到，当您与主题交互时，实际上是SecurityManager在幕后执行<strong>所有操作</strong>。</p> <h3 id="realm-🔥"><a href="#realm-🔥" class="header-anchor">#</a> Realm 🔥</h3> <p>领域充当 Shiro 和应用程序安全数据之间的桥梁或连接器。当需要与安全相关的数据(如用户帐户)进行实际交互以执行身份验证(登录)和授权(访问控制)时，Shiro会从为应用程序配置的<strong>一个或多个</strong>领域中查找这些内容。</p> <p>从这个意义上说，Realm 本质上是一个安全特定的 <strong>DAO</strong>：它封装了数据源的连接细节，并根据需要将相关数据提供给Shiro。在配置Shiro时，必须指定至少一个用于身份验证和/或授权的领域。SecurityManager <strong>可以配置多个域，但至少需要一个域</strong>。</p> <p>Shiro 提供了开箱即用的 Realm 来连接许多安全数据源，如LDAP、关系数据库(JDBC)、文本配置源(如INI和属性文件)等等。如果缺省领域不能满足您的需要，您可以插入自己的域实现来表示自定义数据源。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>与其他内部组件一样，<strong>SecurityManager 管理如何使用 Realm 来获取安全数据和身份数据，并将其表示为 Subject 实例</strong>。</p></div> <h3 id="authenticator"><a href="#authenticator" class="header-anchor">#</a> Authenticator</h3> <p>认证器</p> <p>是负责执行和响应用户身份验证(登录)尝试的组件。当用户尝试登录时，验证程序将执行该逻辑。Authenticator知道如何与存储相关用户/帐户信息的一个或多个域进行协调。从这些领域获得的数据用于验证用户的身份，以确保用户确实是他们所说的那个人。</p> <p>身份验证策略</p> <p>如果配置了多个域，AuthenticationStrategy将协调域以确定身份验证尝试成功或失败的条件(例如，如果一个域成功但其他域失败，那么尝试成功吗?)所有领域必须成功吗?只有第一个?)</p> <h3 id="authrizer"><a href="#authrizer" class="header-anchor">#</a> Authrizer</h3> <p>授权器是负责确定应用程序中用户访问控制的组件。它是最终决定用户是否被允许做某事的机制。与Authenticator一样，授权器也知道如何与多个后端数据源协调，以访问角色和权限信息。授权方使用此信息准确地确定是否允许用户执行给定的操作。</p> <h3 id="sessionmanager"><a href="#sessionmanager" class="header-anchor">#</a> SessionManager</h3> <p>SessionManager知道如何创建和管理用户会话生命周期，为所有环境中的用户提供健壮的会话体验。这是安全框架世界中的一个独特特性—Shiro能够在任何环境中本地管理用户会话，即使没有Web/Servlet或EJB容器可用。默认情况下，Shiro将使用现有的会话机制(如Servlet容器)，但如果没有，例如在独立应用程序或非web环境中，它将使用内置的企业会话管理来提供相同的编程体验。SessionDAO的存在是为了允许使用任何数据源来持久化会话。</p> <h3 id="sessiondao"><a href="#sessiondao" class="header-anchor">#</a> SessionDAO</h3> <p>SessionDAO代表SessionManager执行会话持久性(CRUD)操作。这允许将任何数据存储插入到会话管理基础设施。</p> <h3 id="cachemanager"><a href="#cachemanager" class="header-anchor">#</a> CacheManager</h3> <p>CacheManager创建和管理其他Shiro组件使用的缓存实例的生命周期。由于Shiro可以访问许多后端数据源来进行身份验证、授权和会话管理，因此缓存一直是框架中的一个一流架构特性，可以在使用这些数据源时提高性能。任何现代的开源和/或企业缓存产品都可以插入到Shiro中，以提供快速和高效的用户体验。</p> <p>缓存控制器，来管理如用户、角色、权限等的缓存的；因为这些数据基本上很少去改变，放到缓存中后可以提高访问的性能</p> <h3 id="cryptography"><a href="#cryptography" class="header-anchor">#</a> Cryptography</h3> <p>密码学是企业安全框架的自然补充。Shiro的加密包包含易于使用和理解的密码、散列(又名摘要)和不同的编解码器实现的表示形式。这个包中的所有类都经过精心设计，非常易于使用和理解。任何使用过Java的本地加密支持的人都知道，要驯服它是一种具有挑战性的动物。Shiro的crypto api简化了复杂的Java机制，使普通人可以轻松地使用密码术。</p> <h2 id="术语"><a href="#术语" class="header-anchor">#</a> 术语</h2> <h3 id="authentication—认证"><a href="#authentication—认证" class="header-anchor">#</a> Authentication—认证</h3> <p>身份验证是验证主体身份的过程——本质上证明某人确实是他们所说的那个人。当身份验证尝试成功时，应用程序可以相信该主题一定是应用程序所期望的。</p> <h3 id="authorization—授权"><a href="#authorization—授权" class="header-anchor">#</a> Authorization—授权</h3> <p>授权，也称为访问控制，是决定 user / Subject 是否被允许做某事的过程。它通常是通过检查和解释 Subject 的角色和权限(见下面)，然后允许或拒绝访问请求的资源或函数来完成的。</p> <h3 id="cipher—加密算法"><a href="#cipher—加密算法" class="header-anchor">#</a> Cipher—加密算法</h3> <p>加密算法是执行加密或解密的算法。该算法通常依赖于一条名为密钥的信息。而加密是根据密钥而变化的，所以没有密钥的解密是非常困难的。
密码有不同的变体。块密码通常在固定大小的符号块上工作，而流密码则在连续的符号流上工作。对称密码使用相同的密钥进行加密和解密，而非对称密码使用不同的密钥。如果非对称密码中的密钥不能从另一个密钥派生出来，则可以公开共享一个密钥，从而创建公共/私有密钥对。</p> <h3 id="credential—凭据-🔥"><a href="#credential—凭据-🔥" class="header-anchor">#</a> Credential—凭据 🔥</h3> <p><strong>凭据</strong>是验证 user / Subject 身份的一段信息。在验证过程中，一个(或多个) Credential 与 Subject 一起提交，以验证提交 Credential 的 user / Subject 实际上是关联的用户。凭证通常是只有特定 user / Subject 才知道的非常秘密的东西，比如密码、PGP密钥、生物统计属性或类似的机制。
其思想是，对于一个负责人，只有一个人知道正确的 Credential 来与该负责人“配对”。如果当前 user / Subject 提供了与系统中存储的 Credential 相匹配的正确 Credential ，那么系统可以假定并相信当前 user / Subject 就是他们所说的那个人。信任程度随着更安全的凭据类型(例如生物特征签名&gt;密码)的增加而增加。</p> <h3 id="cryptography—加密"><a href="#cryptography—加密" class="header-anchor">#</a> Cryptography—加密</h3> <p>加密是一种实践，通过隐藏信息或将其转换成没有意义的信息，从而避免不希望的访问，这样其他人就无法读取信息。Shiro专注于密码学的两个核心元素：使用公钥或私钥加密数据(如电子邮件)的密码，以及不可逆加密数据(如密码)的散列(又名消息摘要)。</p> <h3 id="hash—哈希"><a href="#hash—哈希" class="header-anchor">#</a> Hash—哈希</h3> <p>哈希函数是输入源(有时称为消息)到经过编码的哈希值(有时称为消息摘要)的单向、不可逆转换。它通常用于密码、数字指纹或具有底层字节数组的数据。</p> <h3 id="permission—权限"><a href="#permission—权限" class="header-anchor">#</a> Permission—权限</h3> <p>权限(至少按照Shiro的解释)是描述应用程序原始功能的语句，仅此而已。权限是安全策略中最低级别的构造。它们只定义应用程序可以做什么。它们没有描述“谁”能够执行这些操作。许可只是一种行为的陈述，仅此而已。</p> <h3 id="principal—主体-🔥"><a href="#principal—主体-🔥" class="header-anchor">#</a> Principal—主体 🔥</h3> <p><strong>Principal 是应用程序 user ( Subject ) 的标识属性</strong>。“标识属性”可以是对您的应用程序有意义的任何内容—用户名、姓氏、给定名称、社会安全号码、用户ID等等。
Shiro还引用了我们称为 Principal 的主要原则的东西。 Principal 是在整个应用程序中唯一标识 Subject 的任何 Principal。理想的Principal 是像 RDBMS 用户表主键那样的用户名或用户ID。在<strong>应用程序中， user ( Subject ) 只有一个主 Principal</strong>。</p> <h3 id="realm—领域"><a href="#realm—领域" class="header-anchor">#</a> Realm—领域</h3> <p>略</p> <h3 id="role—角色"><a href="#role—角色" class="header-anchor">#</a> Role—角色</h3> <p>略</p> <h3 id="session—会话"><a href="#session—会话" class="header-anchor">#</a> Session—会话</h3> <p>Session 是与在一段时间内与软件系统交互的单个 user ( Subject ) 相关联的有状态数据上下文。当主题使用应用程序时，可以从会话中添加/读取/删除数据，而应用程序稍后在需要时可以使用这些数据。会话在用户/主题注销应用程序或由于不活动而超时时终止。
对于那些熟悉HttpSession的人来说，Shiro会话具有相同的用途，只是Shiro会话可以在任何环境中使用，即使没有Servlet容器或EJB容器可用。</p> <h3 id="subject"><a href="#subject" class="header-anchor">#</a> Subject</h3> <p>Subject 只是一个花哨的安全术语，基本上是指应用程序用户的特定于安全的“视图”。但是，Subject并不总是需要反映人——它可以表示调用您的应用程序的外部进程，或者可能表示在一段时间内间歇执行某些操作的守护进程系统帐户(例如cron作业)。它基本上是任何对应用程序进行操作的实体的表示。</p> <h2 id="authentication—认证-2"><a href="#authentication—认证-2" class="header-anchor">#</a> Authentication—认证</h2> <p><img src="/assets/img/ShiroAuthenticationSequence.3471ccc8.png" alt="img"></p> <h3 id="认证流程"><a href="#认证流程" class="header-anchor">#</a> 认证流程</h3> <ol><li><p>应用程序代码执行 <code>Subject.login</code> 方法，传递构造的 AuthenticationToken 实例，该实例表示最终用户的 principals 和 credentials。</p></li> <li><p>Subject 实例，通常是一个 DelegatingSubject（或子类）被应用委托来调用<code>SecurityManager.login(token)</code>，实际的身份验证工作从这里开始。</p></li> <li><p>SecurityManager 是一个基本的“伞形”组件，它接收令牌并通过调用<code>Authenticator.authenticate(token)</code>将其简单地委托给它的内部 Authenticator 实例。这几乎总是一个 ModularRealmAuthenticator 实例，它支持在身份验证期间协调一个或多个 Realm 实例。 ModularRealmAuthenticator 本质上为Apache Shiro提供了一个PAM样式的范型(在PAM术语中，每个 Realm 都是一个“模块”)。</p></li> <li><p>如果只配置了单个 Realm，则直接调用它——在单个域应用程序中不需要验证策略。</p></li> <li><p>如果为应用程序配置了多个 Realm，ModularRealmAuthenticator 实例将利用其配置的 AuthenticationStrategy 发起多域身份验证尝试。在为身份验证调用领域之前、期间和之后，将调用 AuthenticationStrategy 以允许它对每个领域的结果作出反应。我们将很快介绍身份验证策略。</p></li> <li><p>每个已配置的 Realm 都将被查询，以查看它是否支持提交的 AuthenticationToken。如果是，将使用提交的令牌调用支持域的<code>getAuthenticationInfo</code>方法。<code>getAuthenticationInfo</code>方法有效地表示该特定 Realm 的单个身份认证尝试。我们稍后将讨论领域身份认证行为。</p></li></ol> <h3 id="authenticator-2"><a href="#authenticator-2" class="header-anchor">#</a> Authenticator</h3> <p>如前所述，Shiro SecurityManager实现默认使用 ModularRealmAuthenticator 实例。ModularRealmAuthenticator 同样支持具有单个 Realm 的应用程序和具有多个 Realm 的应用程序。</p> <p>在单一 Realm 应用程序中，ModularRealmAuthenticator 将直接调用单一领域。如果配置了两个或多个域，它将使用AuthenticationStrategy实例来协调如何进行尝试。我们将在下面讨论身份验证策略。</p> <p>可以自定义认证器，虽然 ModularRealmAuthenticator 可以适应大部分需求。略</p> <h3 id="authenticationstrategy"><a href="#authenticationstrategy" class="header-anchor">#</a> AuthenticationStrategy</h3> <p>多个 Realm 才会使用，见文档，略</p> <h2 id="quickstart"><a href="#quickstart" class="header-anchor">#</a> QuickStart</h2> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>详细代码查看仓库</p></div> <h3 id="引入依赖"><a href="#引入依赖" class="header-anchor">#</a> 引入依赖</h3> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.shiro<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>shiro-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.5.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span><span class="token comment">&lt;!--哔了狗，官网文档给的1.5.2-SNAPSHOT但是并没有存入Maven库里--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="配置"><a href="#配置" class="header-anchor">#</a> 配置</h3> <div class="language-ini extra-class"><pre class="language-ini"><code><span class="token comment"># -----------------------------------------------------------------------------</span>
<span class="token comment"># Users and their assigned roles</span>
<span class="token comment">#</span>
<span class="token comment"># Each line conforms to the format defined in the</span>
<span class="token comment"># org.apache.shiro.realm.text.TextConfigurationRealm#setUserDefinitions JavaDoc</span>
<span class="token comment"># -----------------------------------------------------------------------------</span>
<span class="token selector">[users]</span>
<span class="token comment"># user 'root' with password 'secret' and the 'admin' role</span>
<span class="token constant">root</span> <span class="token attr-value"><span class="token punctuation">=</span> secret, admin</span>
<span class="token comment"># user 'guest' with the password 'guest' and the 'guest' role</span>
<span class="token constant">guest</span> <span class="token attr-value"><span class="token punctuation">=</span> guest, guest</span>
<span class="token comment"># user 'presidentskroob' with password '12345' (&quot;That's the same combination on</span>
<span class="token comment"># my luggage!!!&quot; ;)), and role 'president'</span>
<span class="token constant">presidentskroob</span> <span class="token attr-value"><span class="token punctuation">=</span> 12345, president</span>
<span class="token comment"># user 'darkhelmet' with password 'ludicrousspeed' and roles 'darklord' and 'schwartz'</span>
<span class="token constant">darkhelmet</span> <span class="token attr-value"><span class="token punctuation">=</span> ludicrousspeed, darklord, schwartz</span>
<span class="token comment"># user 'lonestarr' with password 'vespa' and roles 'goodguy' and 'schwartz'</span>
<span class="token constant">lonestarr</span> <span class="token attr-value"><span class="token punctuation">=</span> vespa, goodguy, schwartz</span>

<span class="token comment"># -----------------------------------------------------------------------------</span>
<span class="token comment"># Roles with assigned permissions</span>
<span class="token comment"># </span>
<span class="token comment"># Each line conforms to the format defined in the</span>
<span class="token comment"># org.apache.shiro.realm.text.TextConfigurationRealm#setRoleDefinitions JavaDoc</span>
<span class="token comment"># -----------------------------------------------------------------------------</span>
<span class="token selector">[roles]</span>
<span class="token comment"># 'admin' role has all permissions, indicated by the wildcard '*'</span>
<span class="token constant">admin</span> <span class="token attr-value"><span class="token punctuation">=</span> *</span>
<span class="token comment"># The 'schwartz' role can do anything (*) with any lightsaber:</span>
<span class="token constant">schwartz</span> <span class="token attr-value"><span class="token punctuation">=</span> lightsaber:*</span>
<span class="token comment"># The 'goodguy' role is allowed to 'drive' (action) the winnebago (type) with</span>
<span class="token comment"># license plate 'eagle5' (instance specific id)</span>
<span class="token constant">goodguy</span> <span class="token attr-value"><span class="token punctuation">=</span> winnebago:drive:eagle5</span>
</code></pre></div><h3 id="示例"><a href="#示例" class="header-anchor">#</a> 示例</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">/*
   创建配置了Shiro SecurityManager的最简单方法, realms, users, roles 和 permissions 使用了简单的 INI 配置
   官方给的示例中使用 IniSecurityManagerFactory 构造来获取 SecurityManager 的方式已经过时，推荐使用 Shiro 的 Environment 替代
  */</span>
  <span class="token class-name">BasicIniEnvironment</span> basicIniEnvironment <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BasicIniEnvironment</span><span class="token punctuation">(</span><span class="token string">&quot;classpath:shiro.ini&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">SecurityManager</span> securityManager <span class="token operator">=</span> basicIniEnvironment<span class="token punctuation">.</span><span class="token function">getSecurityManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">/*
   对于这个简单的快速入门示例，使用SecurityManager可作为JVM单例访问。大多数应用程序不会这样做而是依赖于它们的容器配置或 webapps 的web.xml。
   */</span>
  <span class="token class-name">SecurityUtils</span><span class="token punctuation">.</span><span class="token function">setSecurityManager</span><span class="token punctuation">(</span>securityManager<span class="token punctuation">)</span><span class="token punctuation">;</span>


  <span class="token comment">/*
   获取当前执行的用户（安全领域公认的命名 Subject）
   独立应用程序中的 getSubject() 调用可能基于特定于应用程序位置的用户数据返回 Subject，而在服务器环境(例如web应用程序)中，它基于与当前线程或传入请求相关的用户数据获取 Subject。
   */</span>
  <span class="token class-name">Subject</span> currentUser <span class="token operator">=</span> <span class="token class-name">SecurityUtils</span><span class="token punctuation">.</span><span class="token function">getSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">/*
   使用 Session 做一些事情(不需要web或EJB容器!!)
   该 Session 是一个特定于 Shiro 的实例，它提供了常规 HttpSession 所提供的大部分内容，但也提供了一些额外的好处，还有一个很大的区别: 它不需要HTTP环境!
   如果在 web 应用程序中部署，默认情况下会话将基于 HttpSession。但是，在非 web 环境中，比如这个简单的快速入门，Shiro默认情况下会自动使用它的企业会话管理。
   这意味着您可以在任何层的应用程序中使用相同的API，而不管部署环境如何。这打开了一个全新的应用程序世界，因为任何需要会话的应用程序都不需要强制使用HttpSession或EJB有状态会话bean。
   而且，任何客户机技术现在都可以共享会话数据。
   */</span>
  <span class="token class-name">Session</span> session <span class="token operator">=</span> currentUser<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  session<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;conanan&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">String</span> value <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> session<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>value<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;conanan&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;获取到正确的值! [&quot;</span> <span class="token operator">+</span> value <span class="token operator">+</span> <span class="token string">&quot;]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/*
   登录当前用户，可以检查角色和权限
   我们只能对已知用户进行这些检查。上面的 Subject 实例表示当前用户，但是谁是当前用户呢?嗯，他们是匿名的——也就是说，直到他们至少登录一次。让我们这样做:
   */</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>currentUser<span class="token punctuation">.</span><span class="token function">isAuthenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">UsernamePasswordToken</span> token <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UsernamePasswordToken</span><span class="token punctuation">(</span><span class="token string">&quot;lonestarr&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;vespa&quot;</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// token.setRememberMe(true); //也可以在构造中第三个参数添加</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token comment">// 登录失败需捕获异常</span>
      currentUser<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">UnknownAccountException</span> uae<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;该用户不存在：&quot;</span> <span class="token operator">+</span> token<span class="token punctuation">.</span><span class="token function">getPrincipal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IncorrectCredentialsException</span> ice<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>token<span class="token punctuation">.</span><span class="token function">getPrincipal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;账号的密码错误!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">LockedAccountException</span> lae<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;账号&quot;</span> <span class="token operator">+</span> token<span class="token punctuation">.</span><span class="token function">getPrincipal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; 已被锁.  &quot;</span> <span class="token operator">+</span>
               <span class="token string">&quot;请联系管理员解锁.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 在这里捕获更多的异常(可能是特定于您的应用程序的自定义异常?)</span>
    <span class="token comment">// 可参考https://shiro.apache.org/static/1.5.1/apidocs/org/apache/shiro/authc/AuthenticationException.html</span>
    <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">AuthenticationException</span> ae<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//unexpected condition?  error?</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/*
   用户登陆后可以做如下事情：告诉我们当前用户是谁，输出他的 identifying principal（主要身份，在这个示例中是 username）
   */</span>
  log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;用户 [&quot;</span> <span class="token operator">+</span> currentUser<span class="token punctuation">.</span><span class="token function">getPrincipal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;] 登陆成功.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">/*
   测试是否有这个角色
   */</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>currentUser<span class="token punctuation">.</span><span class="token function">hasRole</span><span class="token punctuation">(</span><span class="token string">&quot;schwartz&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;May the Schwartz be with you!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, mere mortal.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/*
   我们还可以看到他们是否有权限对某种类型的实体采取行动:
   */</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>currentUser<span class="token punctuation">.</span><span class="token function">isPermitted</span><span class="token punctuation">(</span><span class="token string">&quot;lightsaber:wield&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;You may use a lightsaber ring.  Use it wisely.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;Sorry, lightsaber rings are for schwartz masters only.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/*
   此外，我们可以执行一个非常强大的实例级权限检查——查看用户是否有能力访问某个类型的特定实例:
   */</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>currentUser<span class="token punctuation">.</span><span class="token function">isPermitted</span><span class="token punctuation">(</span><span class="token string">&quot;winnebago:drive:eagle5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;You are permitted to 'drive' the winnebago with license plate (id) 'eagle5'.  &quot;</span> <span class="token operator">+</span> <span class="token string">&quot;Here are the keys - have fun!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;Sorry, you aren't allowed to drive the 'eagle5' winnebago!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/*
   退出。删除所有标识信息并使其会话无效。
   因为 remember 标示通常使用cookie表示，定向到登陆页面，设置同名cookie且maxAge为0
   */</span>
  currentUser<span class="token punctuation">.</span><span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>执行后的日志</p> <div class="language- extra-class"><pre class="language-text"><code>a.s.s.m.AbstractValidatingSessionManager : Enabling session validation scheduler...
t.c.s.ShiroQuickstartApplication         : 获取到正确的值! [conanan]
t.c.s.ShiroQuickstartApplication         : 用户 [lonestarr] 登陆成功.
t.c.s.ShiroQuickstartApplication         : May the Schwartz be with you!
t.c.s.ShiroQuickstartApplication         : You may use a lightsaber ring.  Use it wisely.
t.c.s.ShiroQuickstartApplication         : You are permitted to 'drive' the winnebago with license plate (id) 'eagle5'.  Here are the keys - have fun!
</code></pre></div><h2 id="web-应用程序"><a href="#web-应用程序" class="header-anchor">#</a> Web 应用程序</h2> <div class="custom-block tip"><p class="custom-block-title">文档&amp;博客</p> <p>集成 Shiro 到 SpringBoot 的<a href="https://shiro.apache.org/spring-boot.html" target="_blank" rel="noopener noreferrer">官方文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。还是用谷歌搜出来的，官方文档没找到入口，👴佛了。<a href="https://github.com/apache/shiro" target="_blank" rel="noopener noreferrer">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 的 samples 也有详细代码。这篇<a href="https://developer.okta.com/blog/2017/07/13/apache-shiro-spring-boot" target="_blank" rel="noopener noreferrer">博客<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>也不错。</p></div> <p>Shiro 对 Spring web应用程序提供了一流的支持。在 web 应用程序中，所有可访问 Shiro 的 web 请求都必须经过一个<strong>主 Shiro 过滤器</strong>。这个过滤器本身非常强大，允许基于任何 URL 路径表达式执行<strong>自定义过滤器链</strong>。</p> <h3 id="引入依赖-2"><a href="#引入依赖-2" class="header-anchor">#</a> 引入依赖</h3> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.shiro<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>shiro-spring-boot-web-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.5.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span><span class="token comment">&lt;!--哔了狗，官网文档给的1.5.2-SNAPSHOT但是并没有存入Maven库里--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>Maven: org.apache.shiro:shiro-cache:1.5.1</li> <li>Maven: org.apache.shiro:shiro-config-core:1.5.1</li> <li>Maven: org.apache.shiro:shiro-config-ogdl:1.5.1</li> <li>Maven: org.apache.shiro:shiro-core:1.5.1</li> <li>Maven: org.apache.shiro:shiro-crypto-cipher:1.5.1</li> <li>Maven: org.apache.shiro:shiro-crypto-core:1.5.1</li> <li>Maven: org.apache.shiro:shiro-crypto-hash:1.5.1</li> <li>Maven: org.apache.shiro:shiro-event:1.5.1</li> <li>Maven: org.apache.shiro:shiro-lang:1.5.1</li> <li>Maven: org.apache.shiro:shiro-spring:1.5.1</li> <li>Maven: org.apache.shiro:shiro-web:1.5.1</li> <li>Maven: org.apache.shiro:shiro-spring-boot-starter:1.5.1</li></ul> <h3 id="提供-realm-实现"><a href="#提供-realm-实现" class="header-anchor">#</a> 提供 Realm 实现</h3> <p><strong>具体Realm实现需要重写一个类，且需将其Bean放入配置类中</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * AuthorizingRealm 继承了顶级抽象类 AuthenticatingRealm（仅用于登陆认证）
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserRealm</span> <span class="token keyword">extends</span> <span class="token class-name">AuthorizingRealm</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * 认证
     *
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">AuthenticationInfo</span> <span class="token function">doGetAuthenticationInfo</span><span class="token punctuation">(</span><span class="token class-name">AuthenticationToken</span> authenticationToken<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">AuthenticationException</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;认证，详细见认证步骤&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 授权
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">AuthorizationInfo</span> <span class="token function">doGetAuthorizationInfo</span><span class="token punctuation">(</span><span class="token class-name">PrincipalCollection</span> principalCollection<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;授权&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token punctuation">}</span>
</code></pre></div><p>如果未定义<code>Realm</code> bean，则默认情况下，<code>ShiroAutoConfiguration</code>将提供<code>IniRealm</code>实现，该实现期望在<code>src/main/resources</code>或<code>src/main/resources/META-INF</code>中找到<code>shiro.ini</code>文件。</p> <h3 id="shirofilterchaindefinition"><a href="#shirofilterchaindefinition" class="header-anchor">#</a> ShiroFilterChainDefinition</h3> <p><strong>可写在一个配置类中</strong></p> <p>它将把任何应用程序特定的路径<strong>映射到给定的过滤器</strong>，以允许<strong>不同的路径不同级别的访问</strong>。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">ShiroFilterChainDefinition</span> <span class="token function">shiroFilterChainDefinition</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">DefaultShiroFilterChainDefinition</span> chainDefinition <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultShiroFilterChainDefinition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// logged in users with the 'admin' role</span>
    chainDefinition<span class="token punctuation">.</span><span class="token function">addPathDefinition</span><span class="token punctuation">(</span><span class="token string">&quot;/admin/**&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;authc, roles[admin]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// logged in users with the 'document:read' permission</span>
    chainDefinition<span class="token punctuation">.</span><span class="token function">addPathDefinition</span><span class="token punctuation">(</span><span class="token string">&quot;/docs/**&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;authc, perms[document:read]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// all other paths require a logged in user</span>
    chainDefinition<span class="token punctuation">.</span><span class="token function">addPathDefinition</span><span class="token punctuation">(</span><span class="token string">&quot;/**&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;authc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> chainDefinition<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果我们不定义一个ShiroFilterChainDefinition bean，那么框架将保护所有路径并将登录URL设置为login.jsp。我们可以通过向application.yml 中添加以下条目来更改这个默认的登录URL和其他默认值</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">shiro</span><span class="token punctuation">:</span>
  <span class="token key atrule">loginUrl</span><span class="token punctuation">:</span> /login.html
  <span class="token key atrule">successUrl</span><span class="token punctuation">:</span> /index.html
  <span class="token key atrule">unauthorizedUrl</span><span class="token punctuation">:</span> /login.html
</code></pre></div><h3 id="shiro-注解"><a href="#shiro-注解" class="header-anchor">#</a> Shiro 注解</h3> <p>在独立应用程序和 web 应用程序中，可以 Shiro 的注释用于安全检查，替代<code>ShiroFilterChainDefinition</code>，例如，<code>@RequiresRoles</code>、<code>@requirespermission</code>等，这些注释在上述两个启动程序中都是自动启用的。只需注释您的方法以便使用它们。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RequiresPermissions</span><span class="token punctuation">(</span><span class="token string">&quot;document:read&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">readDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Shiro 注解完全支持在<code>@Controller</code>类中使用</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Controller</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AccountInfoController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@RequiresRoles</span><span class="token punctuation">(</span><span class="token string">&quot;admin&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/admin/config&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">adminConfig</span><span class="token punctuation">(</span><span class="token class-name">Model</span> model<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;view&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>ShiroFilterChainDefinition</code> bean仍然需要至少一个定义才能工作，二选一：要么配置所有路径为可通过<code>anon</code>过滤器访问，要么配置一个过滤器为允许模式，例如<code>authcBasic[per]</code>。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">ShiroFilterChainDefinition</span> <span class="token function">shiroFilterChainDefinition</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">DefaultShiroFilterChainDefinition</span> chainDefinition <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultShiroFilterChainDefinition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// logged in users with the 'admin' role</span>
    chainDefinition<span class="token punctuation">.</span><span class="token function">addPathDefinition</span><span class="token punctuation">(</span><span class="token string">&quot;/admin/**&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;authc, roles[admin]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// logged in users with the 'document:read' permission</span>
    chainDefinition<span class="token punctuation">.</span><span class="token function">addPathDefinition</span><span class="token punctuation">(</span><span class="token string">&quot;/docs/**&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;authc, perms[document:read]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// all other paths require a logged in user</span>
    chainDefinition<span class="token punctuation">.</span><span class="token function">addPathDefinition</span><span class="token punctuation">(</span><span class="token string">&quot;/**&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;authc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> chainDefinition<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="独立应用程序—☠️"><a href="#独立应用程序—☠️" class="header-anchor">#</a> 独立应用程序—☠️</h2> <h3 id="引入依赖-3"><a href="#引入依赖-3" class="header-anchor">#</a> 引入依赖</h3> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.shiro<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>shiro-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.5.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span><span class="token comment">&lt;!--哔了狗，官网文档给的1.5.2-SNAPSHOT但是并没有存入Maven库里--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="自定义-realm-类"><a href="#自定义-realm-类" class="header-anchor">#</a> 自定义 Realm 类</h3> <p>使用<code>shiro-spring-boot-starter</code>剩下的惟一工作就是配置一个Realm</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">Realm</span> <span class="token function">realm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>设置Shiro的最简单的方法，这样所有的<code>SecurityUtils.*</code>方法在所有情况下都能工作，就是使<code>SecurityManager</code> bean成为一个静态单例。不要在web应用程序中这样做——请参阅上面的web应用程序部分。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> <span class="token class-name">SecurityManager</span> securityManager<span class="token punctuation">;</span>
    
 <span class="token annotation punctuation">@PostConstruct</span>
 <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">initStaticSecurityManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token class-name">SecurityUtils</span><span class="token punctuation">.</span><span class="token function">setSecurityManager</span><span class="token punctuation">(</span>securityManager<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre></div><p>其他自己看文档</p> <h2 id="过滤器"><a href="#过滤器" class="header-anchor">#</a> 过滤器</h2> <p>查看<code>org.apache.shiro.web.filter.mgt.DefaultFilter</code>该枚举</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">DefaultFilter</span> <span class="token punctuation">{</span>

  <span class="token function">anon</span><span class="token punctuation">(</span><span class="token class-name">AnonymousFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">authc</span><span class="token punctuation">(</span><span class="token class-name">FormAuthenticationFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">authcBasic</span><span class="token punctuation">(</span><span class="token class-name">BasicHttpAuthenticationFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">authcBearer</span><span class="token punctuation">(</span><span class="token class-name">BearerHttpAuthenticationFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">logout</span><span class="token punctuation">(</span><span class="token class-name">LogoutFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">noSessionCreation</span><span class="token punctuation">(</span><span class="token class-name">NoSessionCreationFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">perms</span><span class="token punctuation">(</span><span class="token class-name">PermissionsAuthorizationFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">port</span><span class="token punctuation">(</span><span class="token class-name">PortFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">rest</span><span class="token punctuation">(</span><span class="token class-name">HttpMethodPermissionFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">roles</span><span class="token punctuation">(</span><span class="token class-name">RolesAuthorizationFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">ssl</span><span class="token punctuation">(</span><span class="token class-name">SslFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">user</span><span class="token punctuation">(</span><span class="token class-name">UserFilter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="anon-🔥"><a href="#anon-🔥" class="header-anchor">#</a> anon 🔥</h3> <p><strong>无需执行任何类型的安全性检查即可直接访问路径的筛选器。</strong></p> <p>此过滤器主要在<strong>排除策略</strong>中有用，在该策略中，您已定义了url模式以要求一定的安全级别，但也许该模式中仅URL的子集应允许任何访问。例如，如果您有网站的仅用户部分，则可能需要要求该部分中的任何URL访问都必须来自经过身份验证的用户。</p> <p>这是IniShiroFilter配置</p> <div class="language- extra-class"><pre class="language-text"><code>[urls] 
/user/** = authc
</code></pre></div><p>但是，如果您希望<code>/user/signup/**</code>对任何人都可用，则必须排除该路径，因为它是上述IniShiroFilter配置的路径的子集。</p> <div class="language- extra-class"><pre class="language-text"><code>/user/signup/** = anon
/user/** = authc
</code></pre></div><h3 id="authc-🔥"><a href="#authc-🔥" class="header-anchor">#</a> authc 🔥</h3> <p>要求<strong>对请求用户进行身份验证</strong>以使请求继续，如果未通过，则通过将用户重定向到您配置的<code>loginUrl</code>来强制用户登录。</p> <p>此过滤器构造一个UsernamePasswordToken，其中包含在username，password和RememberMe请求参数中找到的值。
然后，它调用Subject.login（usernamePasswordToken），有效地自动执行登录尝试。
请注意，仅当isLoginSubmission（request，response）为true时，才会尝试登录，默认情况下，当请求是针对loginUrl且为POST请求时，才会尝试登录。</p> <p>如果登录失败，则将在AuthenticationKey属性项下将得到的AuthenticationException完全限定的类名设置为请求属性。
该FQCN可用作i18n键或查找机制，以向用户解释其登录尝试失败的原因（例如，无帐户，密码错误等）。</p> <p>如果您希望处理身份验证验证并使用自己的代码登录，请考虑改用PassThruAuthenticationFilter，它允许对loginUrl的请求直接传递到应用程序的代码。</p> <h3 id="perms-🔥"><a href="#perms-🔥" class="header-anchor">#</a> perms 🔥</h3> <p>如果当前用户具有映射值指定的权限，则允许访问的过滤器；如果用户没有指定所有权限，则拒绝访问的过滤器。推荐！</p> <h3 id="roles"><a href="#roles" class="header-anchor">#</a> roles</h3> <p>如果当前用户具有映射值指定的角色，则允许访问的过滤器；如果用户没有指定所有角色，则拒绝访问的过滤器。但不推荐！</p> <h3 id="logout-🔥"><a href="#logout-🔥" class="header-anchor">#</a> logout 🔥</h3> <p>简单过滤器，接收到请求后，将立即注销当前正在执行的 <code>Subject</code>，然后将其重定向到已配置的 <code>redirectUrl</code>。</p> <h3 id="rest-🔥"><a href="#rest-🔥" class="header-anchor">#</a> rest 🔥</h3> <p>一个过滤器，它将HTTP请求的方法（例如GET，POST等）转换为相应的动作（动词），并使用该动词来构造将被检查以确定访问权限的权限。提供此过滤器主要是为了支持REST环境，在该环境中，请求的类型（方法）转换为对一个或多个资源执行的操作。此范例与Shiro的使用权限进行访问控制的概念很好地配合使用，可以轻松地执行权限检查。</p> <p>该过滤器的功能如下：</p> <ol><li><p>发现传入的HTTP请求的方法（GET，POST，PUT，DELETE等）。</p></li> <li><p>该方法被翻译成更“易于应用”的动词，例如“创建”，“编辑”，“删除”等。</p></li> <li><p>该动词将附加到当前匹配路径的任何已配置权限。</p></li> <li><p>如果当前的Subject被允许执行已解决的操作，则允许请求继续。</p></li></ol> <p>例如，如果定义了以下过滤器链，“rest”是赋予该类的过滤器实例的名称：</p> <div class="language- extra-class"><pre class="language-text"><code>/user/** = rest[user]
</code></pre></div><p>然后，对<code>/user/1234</code>的 HTTP GET请求将转换为构造的权限<code>user:read</code>（GET 映射到 read 操作）并执行权限检查<code>Subject.isPermitted(&quot;user:read&quot;)</code>以便允许请求继续。</p> <p>同样，到<code>/user</code>的HTTP POST会转换为构造的权限<code>user:create</code>（POST 映射到 create 操作）并执行权限检查<code>Subject.isPermitted(&quot;user:create&quot;)</code>以便允许请求继续。</p> <p>以下为映射方法：</p> <table><thead><tr><th>HTTP Method</th> <th>Mapped Action</th> <th>Example Permission</th> <th>Runtime Check</th></tr></thead> <tbody><tr><td>head</td> <td>read</td> <td>perm1</td> <td>perm1:read</td></tr> <tr><td>get</td> <td>read</td> <td>perm2</td> <td>perm2:read</td></tr> <tr><td>put</td> <td>update</td> <td>perm3</td> <td>perm3:update</td></tr> <tr><td>post</td> <td>create</td> <td>perm4</td> <td>perm4:create</td></tr> <tr><td>delete</td> <td>delete</td> <td>perm5</td> <td>perm5:delete</td></tr> <tr><td>mkcol</td> <td>create</td> <td>perm6</td> <td>perm6:create</td></tr> <tr><td>options</td> <td>read</td> <td>perm7</td> <td>perm7:read</td></tr> <tr><td>trace</td> <td>read</td> <td>perm8</td> <td>perm8:read</td></tr></tbody></table> <h3 id="user"><a href="#user" class="header-anchor">#</a> user</h3> <p>如果访问者是已知用户（定义为具有已知 principal），则允许访问资源的过滤器。这意味着将允许通过“<strong>记住我</strong>”功能通过身份验证或记住的任何用户访问此过滤器。如果访问者不是已知用户，那么他们将被重定向到 <code>loginUrl</code></p> <h3 id="authcbasic-🔥"><a href="#authcbasic-🔥" class="header-anchor">#</a> authcBasic 🔥</h3> <p>要求对请求用户进行身份验证以使请求继续，否则，要求用户通过特定于HTTP Basic协议的质询登录。成功登录后，允许他们继续访问请求的资源/ URL。</p> <p>此实现是RFC 2617中基本HTTP身份验证规范的“clean room” Java实现。</p> <p>基本身份验证功能如下：</p> <ol><li><p>要求提供需要身份验证的资源。</p></li> <li><p>服务器以401响应状态答复，设置WWW-Authenticate标头，并通知用户输入资源需要认证的页面内容。</p></li> <li><p>从服务器收到此WWW-Authenticate质询后，客户端将采用用户名和密码，并将其设置为以下格式：<code>username:password</code></p></li> <li><p>然后，此令牌以base 64编码。</p></li> <li><p>然后，客户端使用以下 header 发送对同一资源的另一个请求：</p> <div class="language- extra-class"><pre class="language-text"><code>Authorization: Basic
Base64_encoded_username_and_password
</code></pre></div></li></ol> <p>仅当发出请求的主题未通过身份验证时，才会调用onAccessDenied（ServletRequest，ServletResponse）方法</p> <h3 id="authcbearer"><a href="#authcbearer" class="header-anchor">#</a> authcBearer</h3> <p>要求对请求用户进行身份验证以使请求继续，否则，要求用户通过特定于HTTP Bearer协议的质询登录。
成功登录后，允许他们继续访问请求的资源/ URL。</p> <h3 id="nosessioncreation"><a href="#nosessioncreation" class="header-anchor">#</a> noSessionCreation</h3> <p>一个PathMatchingFilter，它将在请求期间禁止创建新的会话。这是一个有用的过滤器，可以放置在任何过滤器链的前面，这些过滤器链可能会导致REST，SOAP或其他不打算参与会话的服务调用。</p> <p>此筛选器启用以下行为：</p> <ol><li><p>如果在调用此过滤器时某个Subject还没有Session，则此过滤器将有效地禁用对subject.getSession（）和subject.getSession（true）的所有调用。如果在请求期间调用了任何一个，则将引发异常。</p></li> <li><p>但是，如果 Subject 在调用此过滤器之前已经具有关联的会话，要么是因为它是在应用程序的另一部分中创建的，要么是在创建的链中更高的过滤器，则此过滤器无效。</p></li></ol> <p>最后，对subject.getSession（false）的调用将不受影响，并且在所有情况下都可以在不受到影响的情况下进行调用。</p> <h3 id="port"><a href="#port" class="header-anchor">#</a> port</h3> <p>要求请求位于特定端口上的过滤器，如果没有，则重定向到该端口上的相同URL。</p> <p>示例配置</p> <div class="language- extra-class"><pre class="language-text"><code>[filters]
port.port = 80
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>[urls]
/some/path/** = port
# override for just this path:
/another/path/** = port[8080]
</code></pre></div><h3 id="ssl"><a href="#ssl" class="header-anchor">#</a> ssl</h3> <p>要求通过SSL进行请求的过滤器。如果在已配置的服务器端口和<code>request.isSecure()</code>上收到请求，则允许访问。
如果任一条件为假，则过滤器链将不会继续。端口属性默认为443，并且还保证请求方案始终为“ https”（端口80除外，端口80保留了“ http”方案）。</p> <p>示例配置</p> <div class="language- extra-class"><pre class="language-text"><code>[urls]
/secure/path/** = ssl
</code></pre></div><h2 id="tag"><a href="#tag" class="header-anchor">#</a> Tag</h2> <p>参考<a href="https://shiro.apache.org/web.html#Web-JSP%2FGSPTagLibrary" target="_blank" rel="noopener noreferrer">文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，介绍的很详细</p> <h2 id="caching"><a href="#caching" class="header-anchor">#</a> Caching</h2> <p>启用缓存只需提供 <code>CacheManager</code> bean</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">protected</span> <span class="token class-name">CacheManager</span> <span class="token function">cacheManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MemoryConstrainedCacheManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="configuration-properties"><a href="#configuration-properties" class="header-anchor">#</a> Configuration Properties</h2> <table><thead><tr><th style="text-align:left;">Key</th> <th style="text-align:left;">Default Value</th> <th style="text-align:left;">Description</th></tr></thead> <tbody><tr><td style="text-align:left;">shiro.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables Shiro’s Spring module</td></tr> <tr><td style="text-align:left;">shiro.web.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables Shiro’s Spring web module</td></tr> <tr><td style="text-align:left;">shiro.annotations.enabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enables Spring support for Shiro’s annotations</td></tr> <tr><td style="text-align:left;">shiro.sessionManager.deleteInvalidSessions</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Remove invalid session from session storage</td></tr> <tr><td style="text-align:left;">shiro.sessionManager.sessionIdCookieEnabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enable session ID to cookie, for session tracking</td></tr> <tr><td style="text-align:left;">shiro.sessionManager.sessionIdUrlRewritingEnabled</td> <td style="text-align:left;"><code>true</code></td> <td style="text-align:left;">Enable session URL rewriting support</td></tr> <tr><td style="text-align:left;">shiro.userNativeSessionManager</td> <td style="text-align:left;"><code>false</code></td> <td style="text-align:left;">If enabled Shiro will manage the HTTP sessions instead of the container</td></tr> <tr><td style="text-align:left;">shiro.sessionManager.cookie.name</td> <td style="text-align:left;"><code>JSESSIONID</code></td> <td style="text-align:left;">Session cookie name</td></tr> <tr><td style="text-align:left;"><strong>shiro.sessionManager.cookie.maxAge</strong></td> <td style="text-align:left;"><code>-1</code></td> <td style="text-align:left;">Session cookie max age</td></tr> <tr><td style="text-align:left;"><strong>shiro.sessionManager.cookie.domain</strong></td> <td style="text-align:left;">null</td> <td style="text-align:left;">Session cookie domain</td></tr> <tr><td style="text-align:left;"><strong>shiro.sessionManager.cookie.path</strong></td> <td style="text-align:left;">null</td> <td style="text-align:left;">Session cookie path</td></tr> <tr><td style="text-align:left;">shiro.sessionManager.cookie.secure</td> <td style="text-align:left;"><code>false</code></td> <td style="text-align:left;">Session cookie secure flag</td></tr> <tr><td style="text-align:left;"><strong>shiro.rememberMeManager.cookie.name</strong></td> <td style="text-align:left;"><code>rememberMe</code></td> <td style="text-align:left;">RememberMe cookie name</td></tr> <tr><td style="text-align:left;"><strong>shiro.rememberMeManager.cookie.maxAge</strong></td> <td style="text-align:left;">one year</td> <td style="text-align:left;">RememberMe cookie max age</td></tr> <tr><td style="text-align:left;"><strong>shiro.rememberMeManager.cookie.domain</strong></td> <td style="text-align:left;">null</td> <td style="text-align:left;">RememberMe cookie domain</td></tr> <tr><td style="text-align:left;"><strong>shiro.rememberMeManager.cookie.path</strong></td> <td style="text-align:left;">null</td> <td style="text-align:left;">RememberMe cookie path</td></tr> <tr><td style="text-align:left;"><strong>shiro.rememberMeManager.cookie.secure</strong></td> <td style="text-align:left;"><code>false</code></td> <td style="text-align:left;">RememberMe cookie secure flag</td></tr> <tr><td style="text-align:left;"><strong>shiro.loginUrl</strong></td> <td style="text-align:left;"><code>/login.jsp</code></td> <td style="text-align:left;">Login URL used when unauthenticated users are redirected to login page</td></tr> <tr><td style="text-align:left;"><strong>shiro.successUrl</strong></td> <td style="text-align:left;"><code>/</code></td> <td style="text-align:left;">Default landing page after a user logs in (if alternative cannot be found in the current session)</td></tr> <tr><td style="text-align:left;"><strong>shiro.unauthorizedUrl</strong></td> <td style="text-align:left;">null</td> <td style="text-align:left;">Page to redirect user to if they are unauthorized (403 page)</td></tr></tbody></table></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/apple54whn/notes/edit/master/docs/Java/Spring/9 Shiro.md" target="_blank" rel="noopener noreferrer">编辑文档！</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次更新时间:</span> <span class="time">10/14/2020, 11:15:56 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Java/Spring/Servlet 3.0.html" class="prev">Servlet 3.0及纯注解配置</a></span> <!----></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.4c2406b8.js" defer></script><script src="/assets/js/2.4ce794f3.js" defer></script><script src="/assets/js/31.c168f15b.js" defer></script><script src="/assets/js/33.9b523a1b.js" defer></script>
  </body>
</html>
