<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Primer | Conanan</title>
    <meta name="description" content="Good Good Study, Day Day Up!">
    <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <script src="https://cdn.jsdelivr.net/npm/react/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
    
    <link rel="preload" href="/assets/css/0.styles.721694fb.css" as="style"><link rel="preload" href="/assets/js/app.4c2406b8.js" as="script"><link rel="preload" href="/assets/js/2.4ce794f3.js" as="script"><link rel="preload" href="/assets/js/36.b2d8e023.js" as="script"><link rel="preload" href="/assets/js/33.9b523a1b.js" as="script"><link rel="prefetch" href="/assets/js/10.23584843.js"><link rel="prefetch" href="/assets/js/100.c8b7e6eb.js"><link rel="prefetch" href="/assets/js/101.22710827.js"><link rel="prefetch" href="/assets/js/102.369790c1.js"><link rel="prefetch" href="/assets/js/103.a7c7b572.js"><link rel="prefetch" href="/assets/js/104.7e45de8b.js"><link rel="prefetch" href="/assets/js/105.4791b02d.js"><link rel="prefetch" href="/assets/js/106.61e23a2f.js"><link rel="prefetch" href="/assets/js/107.8ae0e37f.js"><link rel="prefetch" href="/assets/js/108.ad785e65.js"><link rel="prefetch" href="/assets/js/109.f6c3b7e5.js"><link rel="prefetch" href="/assets/js/11.1af6c419.js"><link rel="prefetch" href="/assets/js/110.55979e31.js"><link rel="prefetch" href="/assets/js/111.09bcf468.js"><link rel="prefetch" href="/assets/js/112.17a7c3b1.js"><link rel="prefetch" href="/assets/js/113.9f55e6f6.js"><link rel="prefetch" href="/assets/js/114.ae0d1063.js"><link rel="prefetch" href="/assets/js/115.2b45ae89.js"><link rel="prefetch" href="/assets/js/116.286c2ead.js"><link rel="prefetch" href="/assets/js/117.bd5437e0.js"><link rel="prefetch" href="/assets/js/118.4dd27249.js"><link rel="prefetch" href="/assets/js/119.7be1a2b0.js"><link rel="prefetch" href="/assets/js/12.bc5e4411.js"><link rel="prefetch" href="/assets/js/120.03a04cae.js"><link rel="prefetch" href="/assets/js/121.b657ffcb.js"><link rel="prefetch" href="/assets/js/122.eb76f0ee.js"><link rel="prefetch" href="/assets/js/123.cebd7ceb.js"><link rel="prefetch" href="/assets/js/124.be49618b.js"><link rel="prefetch" href="/assets/js/125.d7aa08e6.js"><link rel="prefetch" href="/assets/js/126.4ad7d0d8.js"><link rel="prefetch" href="/assets/js/127.fe7a1fc9.js"><link rel="prefetch" href="/assets/js/128.18adee58.js"><link rel="prefetch" href="/assets/js/129.65155f32.js"><link rel="prefetch" href="/assets/js/13.46b8bbae.js"><link rel="prefetch" href="/assets/js/130.115199fd.js"><link rel="prefetch" href="/assets/js/131.c30c37e8.js"><link rel="prefetch" href="/assets/js/132.800d09de.js"><link rel="prefetch" href="/assets/js/133.485f2c5a.js"><link rel="prefetch" href="/assets/js/134.68cc802a.js"><link rel="prefetch" href="/assets/js/135.b48b5611.js"><link rel="prefetch" href="/assets/js/136.273edc30.js"><link rel="prefetch" href="/assets/js/137.c51bf33b.js"><link rel="prefetch" href="/assets/js/138.cc73926e.js"><link rel="prefetch" href="/assets/js/139.7f0835b0.js"><link rel="prefetch" href="/assets/js/14.813fdf39.js"><link rel="prefetch" href="/assets/js/140.4b5c8664.js"><link rel="prefetch" href="/assets/js/141.f645668a.js"><link rel="prefetch" href="/assets/js/142.9c31754b.js"><link rel="prefetch" href="/assets/js/143.8dbb577a.js"><link rel="prefetch" href="/assets/js/144.615f3d5a.js"><link rel="prefetch" href="/assets/js/145.3372b6f7.js"><link rel="prefetch" href="/assets/js/146.9d166547.js"><link rel="prefetch" href="/assets/js/147.b35e2060.js"><link rel="prefetch" href="/assets/js/148.2ca9cb36.js"><link rel="prefetch" href="/assets/js/149.b7aae87e.js"><link rel="prefetch" href="/assets/js/15.c027e524.js"><link rel="prefetch" href="/assets/js/150.bad9858c.js"><link rel="prefetch" href="/assets/js/151.fd17d6b4.js"><link rel="prefetch" href="/assets/js/152.2567ef97.js"><link rel="prefetch" href="/assets/js/153.74559d88.js"><link rel="prefetch" href="/assets/js/154.7acecdef.js"><link rel="prefetch" href="/assets/js/155.f457419c.js"><link rel="prefetch" href="/assets/js/156.6fe3ee1a.js"><link rel="prefetch" href="/assets/js/157.fd08fd72.js"><link rel="prefetch" href="/assets/js/158.2b46cf37.js"><link rel="prefetch" href="/assets/js/159.3ace6e8d.js"><link rel="prefetch" href="/assets/js/16.485682dd.js"><link rel="prefetch" href="/assets/js/160.512cf1fa.js"><link rel="prefetch" href="/assets/js/161.0d0ee2ea.js"><link rel="prefetch" href="/assets/js/162.bbdff718.js"><link rel="prefetch" href="/assets/js/163.4fdc9dff.js"><link rel="prefetch" href="/assets/js/164.20d6ef11.js"><link rel="prefetch" href="/assets/js/165.2881201e.js"><link rel="prefetch" href="/assets/js/166.3c7c3ba0.js"><link rel="prefetch" href="/assets/js/167.2143078a.js"><link rel="prefetch" href="/assets/js/168.9f3840f3.js"><link rel="prefetch" href="/assets/js/169.2da8b99f.js"><link rel="prefetch" href="/assets/js/17.53e3a4c9.js"><link rel="prefetch" href="/assets/js/170.997a014a.js"><link rel="prefetch" href="/assets/js/171.addd9a55.js"><link rel="prefetch" href="/assets/js/172.d3d12b0c.js"><link rel="prefetch" href="/assets/js/173.ebd6be51.js"><link rel="prefetch" href="/assets/js/174.c3546734.js"><link rel="prefetch" href="/assets/js/175.e786b04c.js"><link rel="prefetch" href="/assets/js/176.8a72d21e.js"><link rel="prefetch" href="/assets/js/177.4d74c35d.js"><link rel="prefetch" href="/assets/js/178.05b55aba.js"><link rel="prefetch" href="/assets/js/179.06c93c02.js"><link rel="prefetch" href="/assets/js/18.dac780ce.js"><link rel="prefetch" href="/assets/js/180.7a721d6a.js"><link rel="prefetch" href="/assets/js/181.854b3f72.js"><link rel="prefetch" href="/assets/js/182.19f58d6b.js"><link rel="prefetch" href="/assets/js/183.8f49d5b6.js"><link rel="prefetch" href="/assets/js/184.2128f02f.js"><link rel="prefetch" href="/assets/js/19.5bd66b43.js"><link rel="prefetch" href="/assets/js/20.8b0be400.js"><link rel="prefetch" href="/assets/js/21.26154688.js"><link rel="prefetch" href="/assets/js/22.75f3ad5d.js"><link rel="prefetch" href="/assets/js/23.205b8a93.js"><link rel="prefetch" href="/assets/js/24.78eaf948.js"><link rel="prefetch" href="/assets/js/25.5ac44d02.js"><link rel="prefetch" href="/assets/js/26.44e96c5e.js"><link rel="prefetch" href="/assets/js/27.9149de82.js"><link rel="prefetch" href="/assets/js/28.a117fe70.js"><link rel="prefetch" href="/assets/js/29.03c4dd26.js"><link rel="prefetch" href="/assets/js/3.a07e7c66.js"><link rel="prefetch" href="/assets/js/30.add3b4ce.js"><link rel="prefetch" href="/assets/js/31.c168f15b.js"><link rel="prefetch" href="/assets/js/32.6df3dd67.js"><link rel="prefetch" href="/assets/js/34.87d0684d.js"><link rel="prefetch" href="/assets/js/35.07031e68.js"><link rel="prefetch" href="/assets/js/37.6693f2b8.js"><link rel="prefetch" href="/assets/js/38.0adc87b6.js"><link rel="prefetch" href="/assets/js/39.4ee1b450.js"><link rel="prefetch" href="/assets/js/4.3601d982.js"><link rel="prefetch" href="/assets/js/40.3a15c4d2.js"><link rel="prefetch" href="/assets/js/41.5089de95.js"><link rel="prefetch" href="/assets/js/42.b6c516e6.js"><link rel="prefetch" href="/assets/js/43.4d729b64.js"><link rel="prefetch" href="/assets/js/44.afb6ada5.js"><link rel="prefetch" href="/assets/js/45.f90fef77.js"><link rel="prefetch" href="/assets/js/46.3f992a07.js"><link rel="prefetch" href="/assets/js/47.3df4792a.js"><link rel="prefetch" href="/assets/js/48.b1b42695.js"><link rel="prefetch" href="/assets/js/49.1f57735c.js"><link rel="prefetch" href="/assets/js/5.c77010ac.js"><link rel="prefetch" href="/assets/js/50.fb1f131c.js"><link rel="prefetch" href="/assets/js/51.621e6bbe.js"><link rel="prefetch" href="/assets/js/52.d3c5f8e8.js"><link rel="prefetch" href="/assets/js/53.fc428b5d.js"><link rel="prefetch" href="/assets/js/54.a8c7b4e7.js"><link rel="prefetch" href="/assets/js/55.9491ad4c.js"><link rel="prefetch" href="/assets/js/56.cc5535aa.js"><link rel="prefetch" href="/assets/js/57.08a4a942.js"><link rel="prefetch" href="/assets/js/58.ea5e0d13.js"><link rel="prefetch" href="/assets/js/59.e9ab1cc2.js"><link rel="prefetch" href="/assets/js/6.3dc37407.js"><link rel="prefetch" href="/assets/js/60.a0651ffe.js"><link rel="prefetch" href="/assets/js/61.9657adee.js"><link rel="prefetch" href="/assets/js/62.5522a97a.js"><link rel="prefetch" href="/assets/js/63.2c5c6db3.js"><link rel="prefetch" href="/assets/js/64.57e79c12.js"><link rel="prefetch" href="/assets/js/65.5e0e9f19.js"><link rel="prefetch" href="/assets/js/66.e80de9ef.js"><link rel="prefetch" href="/assets/js/67.147e8e38.js"><link rel="prefetch" href="/assets/js/68.26a3c0d4.js"><link rel="prefetch" href="/assets/js/69.8f293aac.js"><link rel="prefetch" href="/assets/js/7.53864b7a.js"><link rel="prefetch" href="/assets/js/70.291565bb.js"><link rel="prefetch" href="/assets/js/71.fe0bdf0f.js"><link rel="prefetch" href="/assets/js/72.61d2bc84.js"><link rel="prefetch" href="/assets/js/73.9fcb62aa.js"><link rel="prefetch" href="/assets/js/74.9d682c13.js"><link rel="prefetch" href="/assets/js/75.3264a4ce.js"><link rel="prefetch" href="/assets/js/76.1f8b1f97.js"><link rel="prefetch" href="/assets/js/77.32b48d28.js"><link rel="prefetch" href="/assets/js/78.b50a8708.js"><link rel="prefetch" href="/assets/js/79.e9abf630.js"><link rel="prefetch" href="/assets/js/8.50c01faa.js"><link rel="prefetch" href="/assets/js/80.180a3806.js"><link rel="prefetch" href="/assets/js/81.7800a9ae.js"><link rel="prefetch" href="/assets/js/82.388bd268.js"><link rel="prefetch" href="/assets/js/83.27d7c820.js"><link rel="prefetch" href="/assets/js/84.a7be62b6.js"><link rel="prefetch" href="/assets/js/85.e286c095.js"><link rel="prefetch" href="/assets/js/86.84fed10f.js"><link rel="prefetch" href="/assets/js/87.4b95dccb.js"><link rel="prefetch" href="/assets/js/88.dd70f5b5.js"><link rel="prefetch" href="/assets/js/89.4a04d404.js"><link rel="prefetch" href="/assets/js/9.947b77c2.js"><link rel="prefetch" href="/assets/js/90.699f3eeb.js"><link rel="prefetch" href="/assets/js/91.9f21bc4f.js"><link rel="prefetch" href="/assets/js/92.8e8caa65.js"><link rel="prefetch" href="/assets/js/93.08b1a369.js"><link rel="prefetch" href="/assets/js/94.8aa7234f.js"><link rel="prefetch" href="/assets/js/95.1d25fc22.js"><link rel="prefetch" href="/assets/js/96.8bb62cc7.js"><link rel="prefetch" href="/assets/js/97.eed16352.js"><link rel="prefetch" href="/assets/js/98.623e948b.js"><link rel="prefetch" href="/assets/js/99.45cfef32.js">
    <link rel="stylesheet" href="/assets/css/0.styles.721694fb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Conanan</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Basic" class="dropdown-title"><span class="title">Basic</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>OS</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Basic/OS/Linux/0 Intro.html" class="nav-link">Linux</a></li><li class="dropdown-subitem"><a href="/Basic/OS/Docker/0 Docker.html" class="nav-link">Docker</a></li><li class="dropdown-subitem"><a href="/Basic/OS/K8/0 Intro.html" class="nav-link">K8</a></li></ul></li><li class="dropdown-item"><h4>Network</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Basic/Network/TCP/IP/0 Intro.html" class="nav-link">TCP/IP</a></li><li class="dropdown-subitem"><a href="/Basic/Network/HTTP/0 Intro.html" class="nav-link">HTTP</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="DataBase" class="dropdown-title"><span class="title">DataBase</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/DataBase/RDBMS/0 Primer.html" class="nav-link">RDBMS</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Redis/0 Intro.html" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Mongo/0 Intro.html" class="nav-link">Mongo</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Lucene/0 Primer.html" class="nav-link">Lucene</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Solr/0 Primer.html" class="nav-link">Solr</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Elasticsearch/0 Primer.html" class="nav-link">Elasticsearch</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Design" class="dropdown-title"><span class="title">Design</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Design/Design Pattern/0 Intro.html" class="nav-link">Design Pattern</a></li><li class="dropdown-item"><!----> <a href="/Design/DDD/0 Basic.html" class="nav-link">DDD</a></li><li class="dropdown-item"><!----> <a href="/Design/MicroServer/0 Intro.html" class="nav-link">MicroServer</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java Study" class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Java/Core/0 Basic.html" class="nav-link">Core</a></li><li class="dropdown-item"><!----> <a href="/Java/Jakarta EE/0 Servlet.html" class="nav-link">Jakarta EE</a></li><li class="dropdown-item"><!----> <a href="/Java/Spring/primer/0 Primer.html" class="nav-link">Spring</a></li><li class="dropdown-item"><!----> <a href="/Java/Persistence/Mybatis/0 Primer.html" class="nav-link">Persistence</a></li><li class="dropdown-item"><!----> <a href="/Java/Authe&amp;Autho/0 Primer.html" class="nav-link">认证&amp;授权</a></li><li class="dropdown-item"><h4>分布式&amp;微服务</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/language/chinese/" class="nav-link">Dubbo</a></li><li class="dropdown-subitem"><a href="/language/japanese/" class="nav-link">Spring Cloud Netflix</a></li><li class="dropdown-subitem"><a href="/language/japanese/" class="nav-link">Spring Cloud Alibaba</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Tools" class="dropdown-title"><span class="title">Tools</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Tools/Vim/Vim.html" class="nav-link">Vim</a></li><li class="dropdown-item"><!----> <a href="/Tools/Git/Git.html" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/Tools/Maven/Maven.html" class="nav-link">Maven</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Server" class="dropdown-title"><span class="title">Server</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Server/Tomcat/0 Primer.html" class="nav-link">Tomcat</a></li><li class="dropdown-item"><!----> <a href="/Server/Nginx/0 Primer.html" class="nav-link">Nginx</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Front End" class="dropdown-title"><span class="title">Front End</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Front End/H5&amp;CSS3/1 HTML.html" class="nav-link">H5&amp;CSS3</a></li><li class="dropdown-item"><!----> <a href="/Front End/JS/0 入门-0 入门.html" class="nav-link">JS</a></li><li class="dropdown-item"><!----> <a href="/Front End/NodeJS/NodeJS-1 入门.html" class="nav-link">NodeJS</a></li><li class="dropdown-item"><!----> <a href="/Front End/Vue/1-1 Primer.html" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/Front End/微信小程序/1-1 Primer.html" class="nav-link">微信小程序</a></li><li class="dropdown-item"><!----> <a href="/Front End/Android/0 Intro.html" class="nav-link">Android</a></li><li class="dropdown-item"><!----> <a href="/Front End/Flutter/0 Intro.html" class="nav-link">Flutter</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Environment" class="dropdown-title"><span class="title">Environment</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Environment/macOS/macOS.html" class="nav-link">macOS</a></li><li class="dropdown-item"><!----> <a href="/Environment/Windows/Windows.html" class="nav-link">Windows</a></li><li class="dropdown-item"><!----> <a href="/Environment/Software/IDEA.html" class="nav-link">Software</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Project" class="dropdown-title"><span class="title">Project</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Project/电商/简介.html" class="nav-link">电商</a></li><li class="dropdown-item"><!----> <a href="/Environment/Linux/Linux.html" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/Environment/Windows/Windows.html" class="nav-link">Windows</a></li><li class="dropdown-item"><!----> <a href="/Environment/Software/Software.html" class="nav-link">Software</a></li></ul></div></div> <a href="https://github.com/apple54whn/notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Basic" class="dropdown-title"><span class="title">Basic</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>OS</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Basic/OS/Linux/0 Intro.html" class="nav-link">Linux</a></li><li class="dropdown-subitem"><a href="/Basic/OS/Docker/0 Docker.html" class="nav-link">Docker</a></li><li class="dropdown-subitem"><a href="/Basic/OS/K8/0 Intro.html" class="nav-link">K8</a></li></ul></li><li class="dropdown-item"><h4>Network</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Basic/Network/TCP/IP/0 Intro.html" class="nav-link">TCP/IP</a></li><li class="dropdown-subitem"><a href="/Basic/Network/HTTP/0 Intro.html" class="nav-link">HTTP</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="DataBase" class="dropdown-title"><span class="title">DataBase</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/DataBase/RDBMS/0 Primer.html" class="nav-link">RDBMS</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Redis/0 Intro.html" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Mongo/0 Intro.html" class="nav-link">Mongo</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Lucene/0 Primer.html" class="nav-link">Lucene</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Solr/0 Primer.html" class="nav-link">Solr</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Elasticsearch/0 Primer.html" class="nav-link">Elasticsearch</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Design" class="dropdown-title"><span class="title">Design</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Design/Design Pattern/0 Intro.html" class="nav-link">Design Pattern</a></li><li class="dropdown-item"><!----> <a href="/Design/DDD/0 Basic.html" class="nav-link">DDD</a></li><li class="dropdown-item"><!----> <a href="/Design/MicroServer/0 Intro.html" class="nav-link">MicroServer</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java Study" class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Java/Core/0 Basic.html" class="nav-link">Core</a></li><li class="dropdown-item"><!----> <a href="/Java/Jakarta EE/0 Servlet.html" class="nav-link">Jakarta EE</a></li><li class="dropdown-item"><!----> <a href="/Java/Spring/primer/0 Primer.html" class="nav-link">Spring</a></li><li class="dropdown-item"><!----> <a href="/Java/Persistence/Mybatis/0 Primer.html" class="nav-link">Persistence</a></li><li class="dropdown-item"><!----> <a href="/Java/Authe&amp;Autho/0 Primer.html" class="nav-link">认证&amp;授权</a></li><li class="dropdown-item"><h4>分布式&amp;微服务</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/language/chinese/" class="nav-link">Dubbo</a></li><li class="dropdown-subitem"><a href="/language/japanese/" class="nav-link">Spring Cloud Netflix</a></li><li class="dropdown-subitem"><a href="/language/japanese/" class="nav-link">Spring Cloud Alibaba</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Tools" class="dropdown-title"><span class="title">Tools</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Tools/Vim/Vim.html" class="nav-link">Vim</a></li><li class="dropdown-item"><!----> <a href="/Tools/Git/Git.html" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/Tools/Maven/Maven.html" class="nav-link">Maven</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Server" class="dropdown-title"><span class="title">Server</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Server/Tomcat/0 Primer.html" class="nav-link">Tomcat</a></li><li class="dropdown-item"><!----> <a href="/Server/Nginx/0 Primer.html" class="nav-link">Nginx</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Front End" class="dropdown-title"><span class="title">Front End</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Front End/H5&amp;CSS3/1 HTML.html" class="nav-link">H5&amp;CSS3</a></li><li class="dropdown-item"><!----> <a href="/Front End/JS/0 入门-0 入门.html" class="nav-link">JS</a></li><li class="dropdown-item"><!----> <a href="/Front End/NodeJS/NodeJS-1 入门.html" class="nav-link">NodeJS</a></li><li class="dropdown-item"><!----> <a href="/Front End/Vue/1-1 Primer.html" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/Front End/微信小程序/1-1 Primer.html" class="nav-link">微信小程序</a></li><li class="dropdown-item"><!----> <a href="/Front End/Android/0 Intro.html" class="nav-link">Android</a></li><li class="dropdown-item"><!----> <a href="/Front End/Flutter/0 Intro.html" class="nav-link">Flutter</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Environment" class="dropdown-title"><span class="title">Environment</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Environment/macOS/macOS.html" class="nav-link">macOS</a></li><li class="dropdown-item"><!----> <a href="/Environment/Windows/Windows.html" class="nav-link">Windows</a></li><li class="dropdown-item"><!----> <a href="/Environment/Software/IDEA.html" class="nav-link">Software</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Project" class="dropdown-title"><span class="title">Project</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Project/电商/简介.html" class="nav-link">电商</a></li><li class="dropdown-item"><!----> <a href="/Environment/Linux/Linux.html" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/Environment/Windows/Windows.html" class="nav-link">Windows</a></li><li class="dropdown-item"><!----> <a href="/Environment/Software/Software.html" class="nav-link">Software</a></li></ul></div></div> <a href="https://github.com/apple54whn/notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Primer</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/DataBase/Lucene/0 Primer.html" class="active sidebar-link">Primer</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/DataBase/Lucene/0 Primer.html#什么是全文检索" class="sidebar-link">什么是全文检索</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/DataBase/Lucene/0 Primer.html#数据分类" class="sidebar-link">数据分类</a></li><li class="sidebar-sub-header"><a href="/DataBase/Lucene/0 Primer.html#结构化数据搜索" class="sidebar-link">结构化数据搜索</a></li><li class="sidebar-sub-header"><a href="/DataBase/Lucene/0 Primer.html#非结构化数据查询方法" class="sidebar-link">非结构化数据查询方法</a></li><li class="sidebar-sub-header"><a href="/DataBase/Lucene/0 Primer.html#如何实现全文检索" class="sidebar-link">如何实现全文检索</a></li><li class="sidebar-sub-header"><a href="/DataBase/Lucene/0 Primer.html#全文检索的应用场景" class="sidebar-link">全文检索的应用场景</a></li></ul></li><li class="sidebar-sub-header"><a href="/DataBase/Lucene/0 Primer.html#lucene实现全文检索的流程" class="sidebar-link">Lucene实现全文检索的流程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/DataBase/Lucene/0 Primer.html#创建索引" class="sidebar-link">创建索引</a></li><li class="sidebar-sub-header"><a href="/DataBase/Lucene/0 Primer.html#查询索引" class="sidebar-link">查询索引</a></li></ul></li><li class="sidebar-sub-header"><a href="/DataBase/Lucene/0 Primer.html#hello-world" class="sidebar-link">Hello World</a></li><li class="sidebar-sub-header"><a href="/DataBase/Lucene/0 Primer.html#分析器" class="sidebar-link">分析器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/DataBase/Lucene/0 Primer.html#中文分析器" class="sidebar-link">中文分析器</a></li></ul></li><li class="sidebar-sub-header"><a href="/DataBase/Lucene/0 Primer.html#索引库的维护（field及增删改）" class="sidebar-link">索引库的维护（Field及增删改）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/DataBase/Lucene/0 Primer.html#field域的属性" class="sidebar-link">Field域的属性</a></li><li class="sidebar-sub-header"><a href="/DataBase/Lucene/0 Primer.html#索引库增删改" class="sidebar-link">索引库增删改</a></li><li class="sidebar-sub-header"><a href="/DataBase/Lucene/0 Primer.html#索引库查询" class="sidebar-link">索引库查询</a></li></ul></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="primer"><a href="#primer" class="header-anchor">#</a> Primer</h1> <h2 id="什么是全文检索"><a href="#什么是全文检索" class="header-anchor">#</a> 什么是全文检索</h2> <h3 id="数据分类"><a href="#数据分类" class="header-anchor">#</a> 数据分类</h3> <ul><li><strong>结构化数据</strong>：指具有固定格式或有限长度的数据，如数据库，元数据等</li> <li><strong>非结构化数据</strong>：指不定长或无固定格式的数据，如邮件，word文档等磁盘上的文件</li></ul> <h3 id="结构化数据搜索"><a href="#结构化数据搜索" class="header-anchor">#</a> 结构化数据搜索</h3> <p>​	常见的<strong>结构化数据</strong>也就是<strong>数据库中</strong>的数据。在数据库中搜索很容易实现，通常都是使用sql语句进行查询，而且能很快的得到查询结果（数据库中的数据存储是有规律的，有行有列而且数据格式、数据长度都是固定的）。</p> <h3 id="非结构化数据查询方法"><a href="#非结构化数据查询方法" class="header-anchor">#</a> 非结构化数据查询方法</h3> <ul><li><p><strong>顺序扫描法</strong>(Serial Scanning)：如对于每一个文档，从头看到尾......</p></li> <li><p><strong>全文检索</strong>(Full-text Search)：</p> <p>将非结构化数据中的一部分信息提取出来，重新组织，使其变得有一定结构，然后对此有一定结构的数据进行搜索，从而达到搜索相对较快的目的。这部分<strong>从非结构化数据中提取出的然后重新组织的信息</strong>，我们称之<strong>索引</strong>。</p> <p>例如：字典。字典的拼音表和部首检字表就相当于字典的索引，对每一个字的解释是非结构化的，如果字典没有音节表和部首检字表，在茫茫辞海中找一个字只能顺序扫描。然而字的某些信息可以提取出来进行结构化处理，比如读音，就比较结构化，分声母和韵母，分别只有几种可以一一列举，于是将读音拿出来按一定的顺序排列，每一项读音都指向此字的详细解释的页数。我们搜索时按结构化的拼音搜到读音，然后按其指向的页数，便可找到我们的非结构化数据——也即对字的解释。</p> <p><strong>这种先建立索引，再对索引进行搜索的过程就叫全文检索(Full-text Search)。<strong>虽然创建索引的过程也是非常耗时的，但是</strong>索引</strong>一旦创建就可以<strong>多次使用</strong>，全文检索主要处理的是查询，所以耗时间创建索引是值得的。</p></li></ul> <h3 id="如何实现全文检索"><a href="#如何实现全文检索" class="header-anchor">#</a> 如何实现全文检索</h3> <p>可以使用Lucene实现全文检索。Lucene是apache下的一个开放源代码的全文检索引擎工具包。提供了完整的查询引擎和索引引擎，部分文本分析引擎。Lucene的目的是为软件开发人员提供一个简单易用的工具包，以方便的在目标系统中实现全文检索的功能。</p> <h3 id="全文检索的应用场景"><a href="#全文检索的应用场景" class="header-anchor">#</a> 全文检索的应用场景</h3> <p>​	对于<strong>数据量大</strong>、<strong>数据结构不固定的数据</strong>可采用全文检索方式搜索，比如百度、Google等<strong>搜索引擎</strong>、<strong>论坛站内搜索</strong>、<strong>电商网站站内搜索</strong>等。</p> <h2 id="lucene实现全文检索的流程"><a href="#lucene实现全文检索的流程" class="header-anchor">#</a> Lucene实现全文检索的流程</h2> <p><img src="/assets/img/1549724395120.1668ab0b.png" alt="1549724395120"></p> <ul><li><p>绿色表示索引过程，对要搜索的原始内容进行索引构建一个索引库，索引过程包括：</p> <p>确定原始内容即要搜索的内容（原始文档）—&gt;采集文档—&gt;创建文档—&gt;分析文档—&gt;索引文档</p></li> <li><p>红色表示搜索过程，从索引库中搜索内容，搜索过程包括：</p> <p>用户通过搜索界面—&gt;创建查询—&gt;执行搜索，从索引库搜索—&gt;渲染搜索结果</p></li></ul> <h3 id="创建索引"><a href="#创建索引" class="header-anchor">#</a> 创建索引</h3> <blockquote><p>将用户要搜索的文档内容创建索引，索引存储在索引库（index）中</p></blockquote> <ol><li><p><strong>获得原始文档</strong></p> <p>原始文档是指<strong>要索引和搜索的内容</strong>。原始内容包括互联网上的网页（爬虫）、数据库中的数据、磁盘上的文件等</p></li> <li><p><strong>创建文档对象</strong></p> <p>获取原始内容的目的是为了索引，在索引前需要将原始内容创建成文档（<strong>Document</strong>），文档中包括<strong>一个一个的域（Field，如文件名/文件内容/大小等）</strong>，域中存储内容（key-value类型）</p> <p>注意：每个Document可以有多个Field，不同的Document可以有不同的Field，同一个Document可以有相同的Field（域名和域值都相同）。<strong>每个文档都有一个唯一的编号，就是文档ID</strong>。</p></li> <li><p><strong>分析文档</strong></p> <p>将原始内容创建为包含域（Field）的文档（Document），需要再对域中的内容进行分析，分析的过程是经过对原始文档<strong>提取单词</strong>、将<strong>字母转为小写</strong>、<strong>去除标点符号</strong>、<strong>去除停用词等</strong>过程生成最终的语汇单元，可以将语汇单元理解为一个一个的单词。</p> <p><strong>每个单词叫做一个Term</strong>，不同的域中拆分出来的相同的单词是不同的Term。<strong>Term中</strong>包含两部分一部分是<strong>文档的域名</strong>，另一部分是<strong>单词的内容</strong>。</p></li> <li><p><strong>创建索引</strong></p> <p>对所有文档分析得出的语汇单元进行索引，索引的目的是为了搜索，最终要实现<strong>只搜索被索引的语汇单元</strong>从而<strong>找到Document（文档）</strong></p> <p>注意：创建索引是对语汇单元索引，==<strong>通过词语（内容）找文档</strong>==，这种索引的结构叫==<strong>倒排索引结构</strong>==。</p> <p>传统方法是根据<strong>文件找到该文件的内容</strong>，在文件内容中匹配搜索关键字，这种方法是顺序扫描方法，数据量大、搜索慢。</p> <p><strong>倒排索引结构也叫反向索引结构，包括索引和文档两部分，索引即词汇表，它的规模较小，而文档集合较大。</strong></p></li></ol> <p><img src="/assets/img/1549726346135.7c490d59.png" alt="1549726346135"></p> <h3 id="查询索引"><a href="#查询索引" class="header-anchor">#</a> 查询索引</h3> <blockquote><p>查询索引也是搜索的过程。搜索就是用户输入关键字，从索引（index）中进行搜索的过程。根据关键字搜索索引，根据索引找到对应的文档，从而找到要搜索的内容（此处案例指磁盘上的文件）</p></blockquote> <ol><li><p><strong>用户查询接口</strong></p> <p>全文检索系统提供用户搜索的界面供用户提交<strong>搜索的关键字</strong>，搜索完成展示搜索结果。</p> <blockquote><p>Lucene不提供制作用户搜索界面的功能，需要根据自己的需求开发搜索界面</p></blockquote></li> <li><p><strong>创建查询</strong></p> <p>用户输入查询关键字执行搜索之前需要先<strong>构建一个查询对象</strong>，查询对象中可以指定查询要搜索的<strong>Field</strong>文档域、<strong>查询关键字</strong>等，查询对象会生成具体的查询语法，例如：语法 “fileName:lucene”表示要搜索Field域的文件名为“lucene”的文档</p></li> <li><p><strong>执行查询</strong></p> <p>搜索索引过程：根据查询语法<strong>在倒排索引词典表中分别找出对应搜索词的索引</strong>，从而找到索引所链接的<strong>文档链表</strong>。</p> <p>比如搜索语法为“fileName:lucene”表示搜索出fileName域中包含Lucene的文档。搜索过程就是<strong>在索引上查找域为fileName，并且关键字为Lucene的Term，并根据Term找到文档id列表</strong>。</p></li> <li><p><strong>渲染结果</strong></p> <p>以一个友好的界面将查询结果展示给用户，用户根据搜索结果找自己想要的信息，为了帮助用户很快找到自己的结果，提供了很多展示的效果，比如搜索结果中将关键字高亮显示，百度提供的快照等。</p></li></ol> <h2 id="hello-world"><a href="#hello-world" class="header-anchor">#</a> Hello World</h2> <blockquote><p>实现一个文件的搜索功能，通过关键字搜索文件，凡是文件名或文件内容包括关键字的文件都需要找出来。还可以根据中文词语进行查询，并且需要支持多个条件查询。</p></blockquote> <ol><li><p>Lucene是开发全文检索功能的工具包，从<a href="http://lucene.apache.org/" target="_blank" rel="noopener noreferrer">官方网站<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>下载如<code>lucene-7.4.0</code>（要求JDK1.8以上），并解压</p> <p>其中core为核心包；analysis为分析包；queryparse为查询分析器</p> <p>需要使用的有：<code>lucene-core-7.4.0.jar</code> <code>lucene-analyzers-common-7.4.0.jar</code>，还需要<code>common-io</code>来操作文件</p></li> <li><p><strong>创建索引</strong></p> <ol><li>创建一个java工程，并导入jar包</li> <li>创建<code>Directory</code>对象，指定索引库的存放位置</li> <li>创建一个<code>IndexWriterConfig</code>对象</li> <li>创建一个<code>IndexWriter</code>对象。</li> <li>创建<code>Document</code>对象</li> <li>创建<code>Field</code>对象，将field<strong>添加</strong>到Document对象中</li> <li>使用<code>IndexWriter</code>对象将<code>Document</code>对象写入索引库，此过程进行索引创建。并将索引和<code>Document</code>对象写入索引库。</li> <li>关闭<code>IndexWriter</code>对象。</li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">createIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token comment">//1.指定索引库存放的路径，存入磁盘</span>
    <span class="token class-name">Directory</span> directory <span class="token operator">=</span> <span class="token class-name">FSDirectory</span><span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;C:\\Develop\\lucene-7.4.0\\index&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//索引库还可以存放到内存中</span>
    <span class="token comment">//Directory directory = new RAMDirectory();</span>

    <span class="token comment">//2.创建IndexWriterConfig对象，若不指定参数则为使用标准分析器</span>
    <span class="token class-name">IndexWriterConfig</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IndexWriterConfig</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">IKAnalyzer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//3.创建IndexWriter对象</span>
    <span class="token class-name">IndexWriter</span> indexWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IndexWriter</span><span class="token punctuation">(</span>directory<span class="token punctuation">,</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//原始文档的路径</span>
    <span class="token class-name">File</span> dir <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;F:\\00000\\0000000博学谷JavaEE\\5-流行框架\\1 lucene\\02.参考资料\\searchsource&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">File</span><span class="token punctuation">[</span><span class="token punctuation">]</span> files <span class="token operator">=</span> dir<span class="token punctuation">.</span><span class="token function">listFiles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">File</span> file <span class="token operator">:</span> files<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//文件名</span>
        <span class="token class-name">String</span> fileName <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//文件内容</span>
        <span class="token class-name">String</span> fileContent <span class="token operator">=</span> <span class="token class-name">FileUtils</span><span class="token punctuation">.</span><span class="token function">readFileToString</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//文件路径</span>
        <span class="token class-name">String</span> filePath <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//文件的大小</span>
        <span class="token keyword">long</span> fileSize  <span class="token operator">=</span> <span class="token class-name">FileUtils</span><span class="token punctuation">.</span><span class="token function">sizeOf</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//4.创建文件名域</span>
        <span class="token comment">//第一个参数：域的名称；第二个参数：域的内容；第三个参数：是否存储</span>
        <span class="token class-name">Field</span> fileNameField <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TextField</span><span class="token punctuation">(</span><span class="token string">&quot;filename&quot;</span><span class="token punctuation">,</span> fileName<span class="token punctuation">,</span> <span class="token class-name">Field</span><span class="token punctuation">.</span><span class="token class-name">Store</span><span class="token punctuation">.</span>YES<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//文件内容域</span>
        <span class="token class-name">Field</span> fileContentField <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TextField</span><span class="token punctuation">(</span><span class="token string">&quot;content&quot;</span><span class="token punctuation">,</span> fileContent<span class="token punctuation">,</span> <span class="token class-name">Field</span><span class="token punctuation">.</span><span class="token class-name">Store</span><span class="token punctuation">.</span>YES<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//文件路径域（不分析、不索引、只存储）</span>
        <span class="token class-name">Field</span> filePathField <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TextField</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">,</span> filePath<span class="token punctuation">,</span> <span class="token class-name">Field</span><span class="token punctuation">.</span><span class="token class-name">Store</span><span class="token punctuation">.</span>YES<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//文件大小域</span>
        <span class="token class-name">Field</span> fileSizeField <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TextField</span><span class="token punctuation">(</span><span class="token string">&quot;size&quot;</span><span class="token punctuation">,</span> fileSize <span class="token operator">+</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Field</span><span class="token punctuation">.</span><span class="token class-name">Store</span><span class="token punctuation">.</span>YES<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//5.创建document对象</span>
        <span class="token class-name">Document</span> document <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Document</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>fileNameField<span class="token punctuation">)</span><span class="token punctuation">;</span>
        document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>fileContentField<span class="token punctuation">)</span><span class="token punctuation">;</span>
        document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>filePathField<span class="token punctuation">)</span><span class="token punctuation">;</span>
        document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>fileSizeField<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//6.创建索引，并写入索引库</span>
        indexWriter<span class="token punctuation">.</span><span class="token function">addDocument</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//7.关闭Indexwriter对象</span>
    indexWriter<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>可以使用luke-7.4.0（利用JavaFx开发的应用，版本和lucene对应）查看index目录中索引库的信息，软件要求JDK9.0以上</p></li> <li><p><strong>查询索引库</strong></p> <ol><li>创建一个<code>Directory</code>对象，也就是索引库存放的位置。</li> <li>创建一个<code>IndexReader</code>对象，需要指定<code>Directory</code>对象。</li> <li>创建一个<code>Indexsearcher</code>对象，需要指定<code>IndexReader</code>对象</li> <li>创建一个<code>Query</code>对象<code>TermQuery</code>，指定查询的<strong>域</strong>和查询的<strong>关键词</strong>。</li> <li>执行查询，得到<code>TopDocs</code>对象</li> <li>返回查询结果。遍历查询结果并输出。</li> <li>关闭<code>IndexReader</code>对象。</li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">searchIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token comment">//1.指定索引库存放的路径</span>
    <span class="token class-name">Directory</span> directory <span class="token operator">=</span> <span class="token class-name">FSDirectory</span><span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;C:\\Develop\\lucene-7.4.0\\index&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//2.创建IndexReader对象</span>
    <span class="token class-name">IndexReader</span> indexReader <span class="token operator">=</span> <span class="token class-name">DirectoryReader</span><span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span>directory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//3.创建IndexSearcher对象</span>
    <span class="token class-name">IndexSearcher</span> indexSearcher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IndexSearcher</span><span class="token punctuation">(</span>indexReader<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//4.创建查询，指定查询的域和查询的关键词</span>
    <span class="token class-name">Query</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TermQuery</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Term</span><span class="token punctuation">(</span><span class="token string">&quot;content&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;spring&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//执行查询</span>
    <span class="token comment">//第一个参数是查询对象，第二个参数是查询结果返回的最大值</span>
    <span class="token class-name">TopDocs</span> topDocs <span class="token operator">=</span> indexSearcher<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//查询结果的总条数</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;查询结果的总条数：&quot;</span><span class="token operator">+</span> topDocs<span class="token punctuation">.</span>totalHits<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//遍历查询结果</span>
    <span class="token comment">//topDocs.scoreDocs存储了document对象的id</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ScoreDoc</span> scoreDoc <span class="token operator">:</span> topDocs<span class="token punctuation">.</span>scoreDocs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//scoreDoc.doc属性就是document对象的id</span>
        <span class="token comment">//根据document的id找到document对象</span>
        <span class="token class-name">Document</span> document <span class="token operator">=</span> indexSearcher<span class="token punctuation">.</span><span class="token function">doc</span><span class="token punctuation">(</span>scoreDoc<span class="token punctuation">.</span>doc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;filename&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//System.out.println(document.get(&quot;content&quot;));</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;size&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;-------------------------&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//关闭Indexreader对象</span>
    indexReader<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ol> <h2 id="分析器"><a href="#分析器" class="header-anchor">#</a> 分析器</h2> <p>查看分析器的分词效果</p> <ol><li><p>创建一个标准分析器对象<code>Analyzer</code></p></li> <li><p>获得<code>TokenStream</code>对象</p></li> <li><p>添加一个引用，可以获得每个关键词</p></li> <li><p>将指针调整到列表的头部</p></li> <li><p>遍历关键词列表，通过<code>incrementToken</code>方法判断列表是否结束</p></li> <li><p>关闭<code>TokenStream</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testTokenStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token comment">//创建一个标准分析器对象，对中文分词只能按字分</span>
    <span class="token comment">//Analyzer analyzer = new StandardAnalyzer();</span>
    
    <span class="token comment">//创建一个IKAnalyzer分析器对象</span>
    <span class="token class-name">Analyzer</span> analyzer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IKAnalyzer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//获得tokenStream对象</span>
    <span class="token comment">//第一个参数：Field，可以随便给一个（这里只是测试）；第二个参数：要分析的文本内容</span>
    <span class="token class-name">TokenStream</span> tokenStream <span class="token operator">=</span> analyzer<span class="token punctuation">.</span><span class="token function">tokenStream</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;The Spring Framework provides a comprehensive programming and configuration model.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//添加一个引用，可以获得每个关键词</span>
    <span class="token class-name">CharTermAttribute</span> charTermAttribute <span class="token operator">=</span> tokenStream<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token class-name">CharTermAttribute</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//添加一个偏移量的引用，记录了关键词的开始位置以及结束位置</span>
    <span class="token class-name">OffsetAttribute</span> offsetAttribute <span class="token operator">=</span> tokenStream<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token class-name">OffsetAttribute</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//将指针调整到列表的头部</span>
    tokenStream<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//遍历关键词列表，通过incrementToken方法判断列表是否结束</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>tokenStream<span class="token punctuation">.</span><span class="token function">incrementToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//关键词的起始位置</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;start-&gt;&quot;</span> <span class="token operator">+</span> offsetAttribute<span class="token punctuation">.</span><span class="token function">startOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//取关键词，直接打印调用toString()方法</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>charTermAttribute<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//结束位置</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;end-&gt;&quot;</span> <span class="token operator">+</span> offsetAttribute<span class="token punctuation">.</span><span class="token function">endOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    tokenStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ol> <h3 id="中文分析器"><a href="#中文分析器" class="header-anchor">#</a> 中文分析器</h3> <ul><li><p>Lucene自带中文分词器</p> <ul><li>StandardAnalyzer：单字分词</li> <li>SmartChineseAnalyzer：对中文支持较好，但扩展性差，扩展词库，禁用词库和同义词库等不好处理</li></ul></li> <li><p><strong>IKAnalyzer</strong></p> <ol><li><p>把<code>IK-Analyzer-1.0-SNAPSHOT.jar</code>包添加到工程中</p></li> <li><p>把配置文件和扩展词典和停用词词典添加到classpath下</p> <p>注意：hotword.dic和ext_stopword.dic文件的格式为UTF-8，注意是无BOM 的UTF-8 编码</p></li> <li><p>使用自定义分析器<code>IndexWriterConfig config = new IndexWriterConfig(new IKAnalyzer());</code></p></li></ol></li></ul> <h2 id="索引库的维护（field及增删改）"><a href="#索引库的维护（field及增删改）" class="header-anchor">#</a> 索引库的维护（Field及增删改）</h2> <h3 id="field域的属性"><a href="#field域的属性" class="header-anchor">#</a> Field域的属性</h3> <ul><li><p><strong>是否分析</strong>：是否对域的内容进行<strong>分词</strong>处理。前提是我们要对域的内容进行查询。</p></li> <li><p><strong>是否索引</strong>：将Field分析后的词或整个Field值进行索引，只有索引方可搜索到。</p> <p>比如：商品名称、商品简介分析后进行索引，订单号、身份证号不用分析但也要索引，这些将来都要作为<strong>查询条件</strong>。</p></li> <li><p><strong>是否存储</strong>：将Field值存储在文档中，存储在文档中的Field才可以从Document中获取。</p> <p>比如：商品名称、订单号，凡是将来要从Document中获取的Field都要存储。<strong>是否要将内容展示给用户</strong>。</p></li></ul> <table><thead><tr><th style="text-align:center;">Field类</th> <th style="text-align:center;">数据类型</th> <th style="text-align:center;">Analyzed是否分析</th> <th style="text-align:center;">Indexed是否索引</th> <th style="text-align:center;">Stored是否存储</th> <th style="text-align:center;">说明</th></tr></thead> <tbody><tr><td style="text-align:center;">StoredField(FieldName, FieldValue)</td> <td style="text-align:center;">重载方法，支持多种类型</td> <td style="text-align:center;">N</td> <td style="text-align:center;">N</td> <td style="text-align:center;">Y</td> <td style="text-align:center;">这个Field用来构建不同类型Field   不分析，不索引，但要Field存储在文档中</td></tr> <tr><td style="text-align:center;">LongPoint(String name, long... point)</td> <td style="text-align:center;">Long型</td> <td style="text-align:center;">Y</td> <td style="text-align:center;">Y</td> <td style="text-align:center;">N</td> <td style="text-align:center;">可以使用LongPoint、IntPoint等类型存储数值类型的数据。让数值类型可以进行索引。但是不能存储数据，如果想存储数据还需要使用StoredField。</td></tr> <tr><td style="text-align:center;">StringField(FieldName,   FieldValue,Store.YES))</td> <td style="text-align:center;">字符串</td> <td style="text-align:center;">N</td> <td style="text-align:center;">Y</td> <td style="text-align:center;">Y或N</td> <td style="text-align:center;">这个Field用来构建一个字符串Field，但是不会进行分析，会将整个串存储在索引中，比如(订单号,姓名等)   是否存储在文档中用Store.YES或Store.NO决定</td></tr> <tr><td style="text-align:center;">TextField(FieldName, FieldValue, Store.NO)或   TextField(FieldName, reader)</td> <td style="text-align:center;">字符串   或   流</td> <td style="text-align:center;">Y</td> <td style="text-align:center;">Y</td> <td style="text-align:center;">Y或N</td> <td style="text-align:center;">如果是一个Reader, lucene猜测内容比较多,会采用Unstored的策略.</td></tr></tbody></table> <p>修改之前的创建索引中方法</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//不同的document可以有不同的域，同一个document可以有相同的域。</span>
document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TextField</span><span class="token punctuation">(</span><span class="token string">&quot;filename&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;新添加的文档&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Field</span><span class="token punctuation">.</span><span class="token class-name">Store</span><span class="token punctuation">.</span>YES<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TextField</span><span class="token punctuation">(</span><span class="token string">&quot;content&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;新添加的文档的内容&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Field</span><span class="token punctuation">.</span><span class="token class-name">Store</span><span class="token punctuation">.</span>NO<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//LongPoint创建索引</span>
document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">LongPoint</span><span class="token punctuation">(</span><span class="token string">&quot;size&quot;</span><span class="token punctuation">,</span> <span class="token number">1000l</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//StoreField存储数据</span>
document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StoredField</span><span class="token punctuation">(</span><span class="token string">&quot;size&quot;</span><span class="token punctuation">,</span> <span class="token number">1000l</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//不需要创建索引的就使用StoreField存储</span>
document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StoredField</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;d:/temp/1.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="索引库增删改"><a href="#索引库增删改" class="header-anchor">#</a> 索引库增删改</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">IndexManager</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">IndexWriter</span> indexWriter<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Before</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">//创建一个IndexWriter对象，需要使用IKAnalyzer作为分析器</span>
        indexWriter <span class="token operator">=</span>
                <span class="token keyword">new</span> <span class="token class-name">IndexWriter</span><span class="token punctuation">(</span><span class="token class-name">FSDirectory</span><span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;C:\\temp\\index&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token keyword">new</span> <span class="token class-name">IndexWriterConfig</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">IKAnalyzer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">//创建一个IndexWriter对象，需要使用IKAnalyzer作为分析器</span>
        <span class="token class-name">IndexWriter</span> indexWriter <span class="token operator">=</span>
                <span class="token keyword">new</span> <span class="token class-name">IndexWriter</span><span class="token punctuation">(</span><span class="token class-name">FSDirectory</span><span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;C:\\temp\\index&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">IndexWriterConfig</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">IKAnalyzer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//创建一个Document对象</span>
        <span class="token class-name">Document</span> document <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Document</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//向document对象中添加域</span>
        document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TextField</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;新添加的文件&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Field</span><span class="token punctuation">.</span><span class="token class-name">Store</span><span class="token punctuation">.</span>YES<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TextField</span><span class="token punctuation">(</span><span class="token string">&quot;content&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;新添加的文件内容&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Field</span><span class="token punctuation">.</span><span class="token class-name">Store</span><span class="token punctuation">.</span>NO<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StoredField</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;c:/temp/helo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 把文档写入索引库</span>
        indexWriter<span class="token punctuation">.</span><span class="token function">addDocument</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//关闭索引库</span>
        indexWriter<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//将索引目录的索引信息全部删除，直接彻底删除，无法恢复！！！！！</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deleteAllDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">//删除全部文档</span>
        indexWriter<span class="token punctuation">.</span><span class="token function">deleteAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//关闭索引库</span>
        indexWriter<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deleteDocumentByQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        indexWriter<span class="token punctuation">.</span><span class="token function">deleteDocuments</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Term</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;apache&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//参数为Query也可以，好像只是再封装了一层</span>
        indexWriter<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//原理是先删除！！！后添加！！！</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">//创建一个新的文档对象</span>
        <span class="token class-name">Document</span> document <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Document</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//向文档对象中添加域</span>
        document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TextField</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;更新之后的文档&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Field</span><span class="token punctuation">.</span><span class="token class-name">Store</span><span class="token punctuation">.</span>YES<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TextField</span><span class="token punctuation">(</span><span class="token string">&quot;name1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;更新之后的文档2&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Field</span><span class="token punctuation">.</span><span class="token class-name">Store</span><span class="token punctuation">.</span>YES<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        document<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TextField</span><span class="token punctuation">(</span><span class="token string">&quot;name2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;更新之后的文档3&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Field</span><span class="token punctuation">.</span><span class="token class-name">Store</span><span class="token punctuation">.</span>YES<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//更新操作</span>
        indexWriter<span class="token punctuation">.</span><span class="token function">updateDocument</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Term</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;spring&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> document<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//关闭索引库</span>
        indexWriter<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="索引库查询"><a href="#索引库查询" class="header-anchor">#</a> 索引库查询</h3> <p>对要搜索的信息创建Query查询对象，Lucene会根据Query查询对象生成最终的查询语法，类似关系数据库Sql语法一样Lucene也有自己的查询语法，比如：“name:lucene”表示查询Field的name为“lucene”的文档信息。可通过两种方法创建查询对象：</p> <ul><li><p>使用Lucene提供Query子类</p> <ul><li><strong>TermQuery</strong>，根据<strong>域</strong>和<strong>关键词</strong>进行查询，<strong>TermQuery不使用分析器所以建议匹配不分词的Field域查询</strong>，比如订单号</li> <li>LongPoint.<strong>newRangeQuery</strong>，<strong>数值范围查询</strong></li></ul></li> <li><p>使用<strong>QueryParse</strong>解析查询表达式（<strong>先分词</strong>，再查询，需要指定<strong>默认查找Field</strong>和<strong>分析器</strong>）</p> <ul><li><p>通过QueryParser也可以创建Query，QueryParser提供一个Parse方法，此方法可以直接根据查询语法来查询。Query对象执行的查询语法可通过<code>System.out.println(query);</code>查询。</p> <p>需要使用到分析器。建议创建索引时使用的分析器和查询索引时使用的分析器要一致。</p> <p>需要加入queryParser依赖的<code>lucene-queryparser-7.4.0.jar</code>包</p></li></ul></li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SearchIndex</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">IndexReader</span> indexReader<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">IndexSearcher</span> indexSearcher<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Before</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        indexReader <span class="token operator">=</span> <span class="token class-name">DirectoryReader</span><span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span><span class="token class-name">FSDirectory</span><span class="token punctuation">.</span><span class="token keyword">open</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;C:\\temp\\index&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        indexSearcher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IndexSearcher</span><span class="token punctuation">(</span>indexReader<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testTermQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">//创建一个Query对象</span>
        <span class="token class-name">Query</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TermQuery</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Term</span><span class="token punctuation">(</span><span class="token string">&quot;content&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;lucene&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printResult</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    
    <span class="token comment">//数值范围查询</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testRangeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">//创建一个Query对象</span>
        <span class="token class-name">Query</span> query <span class="token operator">=</span> <span class="token class-name">LongPoint</span><span class="token punctuation">.</span><span class="token function">newRangeQuery</span><span class="token punctuation">(</span><span class="token string">&quot;size&quot;</span><span class="token punctuation">,</span> <span class="token number">0L</span><span class="token punctuation">,</span> <span class="token number">100L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printResult</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testQueryParser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">//创建一个QueryPaser对象，两个参数</span>
        <span class="token comment">//参数1：默认搜索域，参数2：分析器对象</span>
        <span class="token class-name">QueryParser</span> queryParser <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryParser</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">IKAnalyzer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//使用QueryPaser对象创建一个Query对象</span>
        <span class="token class-name">Query</span> query <span class="token operator">=</span> queryParser<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;lucene是一个Java开发的全文检索工具包&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//执行查询</span>
        <span class="token function">printResult</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token comment">//========================================================================================</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">printResult</span><span class="token punctuation">(</span><span class="token class-name">Query</span> query<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">//执行查询</span>
        <span class="token class-name">TopDocs</span> topDocs <span class="token operator">=</span> indexSearcher<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;总记录数：&quot;</span> <span class="token operator">+</span> topDocs<span class="token punctuation">.</span>totalHits<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ScoreDoc</span><span class="token punctuation">[</span><span class="token punctuation">]</span> scoreDocs <span class="token operator">=</span> topDocs<span class="token punctuation">.</span>scoreDocs<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ScoreDoc</span> doc<span class="token operator">:</span>scoreDocs<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">//取文档id</span>
            <span class="token keyword">int</span> docId <span class="token operator">=</span> doc<span class="token punctuation">.</span>doc<span class="token punctuation">;</span>
            <span class="token comment">//根据id取文档对象</span>
            <span class="token class-name">Document</span> document <span class="token operator">=</span> indexSearcher<span class="token punctuation">.</span><span class="token function">doc</span><span class="token punctuation">(</span>docId<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;size&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//System.out.println(document.get(&quot;content&quot;));</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;-----------------寂寞的分割线&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        indexReader<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/apple54whn/notes/edit/master/docs/DataBase/Lucene/0 Primer.md" target="_blank" rel="noopener noreferrer">编辑文档！</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次更新时间:</span> <span class="time">3/24/2020, 12:47:11 AM</span></div></footer> <!----> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.4c2406b8.js" defer></script><script src="/assets/js/2.4ce794f3.js" defer></script><script src="/assets/js/36.b2d8e023.js" defer></script><script src="/assets/js/33.9b523a1b.js" defer></script>
  </body>
</html>
