<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Index &amp; Document | Conanan</title>
    <meta name="description" content="Good Good Study, Day Day Up!">
    <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <script src="https://cdn.jsdelivr.net/npm/react/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
    
    <link rel="preload" href="/assets/css/0.styles.721694fb.css" as="style"><link rel="preload" href="/assets/js/app.4c2406b8.js" as="script"><link rel="preload" href="/assets/js/2.4ce794f3.js" as="script"><link rel="preload" href="/assets/js/35.07031e68.js" as="script"><link rel="preload" href="/assets/js/33.9b523a1b.js" as="script"><link rel="prefetch" href="/assets/js/10.23584843.js"><link rel="prefetch" href="/assets/js/100.c8b7e6eb.js"><link rel="prefetch" href="/assets/js/101.22710827.js"><link rel="prefetch" href="/assets/js/102.369790c1.js"><link rel="prefetch" href="/assets/js/103.a7c7b572.js"><link rel="prefetch" href="/assets/js/104.7e45de8b.js"><link rel="prefetch" href="/assets/js/105.4791b02d.js"><link rel="prefetch" href="/assets/js/106.61e23a2f.js"><link rel="prefetch" href="/assets/js/107.8ae0e37f.js"><link rel="prefetch" href="/assets/js/108.ad785e65.js"><link rel="prefetch" href="/assets/js/109.f6c3b7e5.js"><link rel="prefetch" href="/assets/js/11.1af6c419.js"><link rel="prefetch" href="/assets/js/110.55979e31.js"><link rel="prefetch" href="/assets/js/111.09bcf468.js"><link rel="prefetch" href="/assets/js/112.17a7c3b1.js"><link rel="prefetch" href="/assets/js/113.9f55e6f6.js"><link rel="prefetch" href="/assets/js/114.ae0d1063.js"><link rel="prefetch" href="/assets/js/115.2b45ae89.js"><link rel="prefetch" href="/assets/js/116.286c2ead.js"><link rel="prefetch" href="/assets/js/117.bd5437e0.js"><link rel="prefetch" href="/assets/js/118.4dd27249.js"><link rel="prefetch" href="/assets/js/119.7be1a2b0.js"><link rel="prefetch" href="/assets/js/12.bc5e4411.js"><link rel="prefetch" href="/assets/js/120.03a04cae.js"><link rel="prefetch" href="/assets/js/121.b657ffcb.js"><link rel="prefetch" href="/assets/js/122.eb76f0ee.js"><link rel="prefetch" href="/assets/js/123.cebd7ceb.js"><link rel="prefetch" href="/assets/js/124.be49618b.js"><link rel="prefetch" href="/assets/js/125.d7aa08e6.js"><link rel="prefetch" href="/assets/js/126.4ad7d0d8.js"><link rel="prefetch" href="/assets/js/127.fe7a1fc9.js"><link rel="prefetch" href="/assets/js/128.18adee58.js"><link rel="prefetch" href="/assets/js/129.65155f32.js"><link rel="prefetch" href="/assets/js/13.46b8bbae.js"><link rel="prefetch" href="/assets/js/130.115199fd.js"><link rel="prefetch" href="/assets/js/131.c30c37e8.js"><link rel="prefetch" href="/assets/js/132.800d09de.js"><link rel="prefetch" href="/assets/js/133.485f2c5a.js"><link rel="prefetch" href="/assets/js/134.68cc802a.js"><link rel="prefetch" href="/assets/js/135.b48b5611.js"><link rel="prefetch" href="/assets/js/136.273edc30.js"><link rel="prefetch" href="/assets/js/137.c51bf33b.js"><link rel="prefetch" href="/assets/js/138.cc73926e.js"><link rel="prefetch" href="/assets/js/139.7f0835b0.js"><link rel="prefetch" href="/assets/js/14.813fdf39.js"><link rel="prefetch" href="/assets/js/140.4b5c8664.js"><link rel="prefetch" href="/assets/js/141.f645668a.js"><link rel="prefetch" href="/assets/js/142.9c31754b.js"><link rel="prefetch" href="/assets/js/143.8dbb577a.js"><link rel="prefetch" href="/assets/js/144.615f3d5a.js"><link rel="prefetch" href="/assets/js/145.3372b6f7.js"><link rel="prefetch" href="/assets/js/146.9d166547.js"><link rel="prefetch" href="/assets/js/147.b35e2060.js"><link rel="prefetch" href="/assets/js/148.2ca9cb36.js"><link rel="prefetch" href="/assets/js/149.b7aae87e.js"><link rel="prefetch" href="/assets/js/15.c027e524.js"><link rel="prefetch" href="/assets/js/150.bad9858c.js"><link rel="prefetch" href="/assets/js/151.fd17d6b4.js"><link rel="prefetch" href="/assets/js/152.2567ef97.js"><link rel="prefetch" href="/assets/js/153.74559d88.js"><link rel="prefetch" href="/assets/js/154.7acecdef.js"><link rel="prefetch" href="/assets/js/155.f457419c.js"><link rel="prefetch" href="/assets/js/156.6fe3ee1a.js"><link rel="prefetch" href="/assets/js/157.fd08fd72.js"><link rel="prefetch" href="/assets/js/158.2b46cf37.js"><link rel="prefetch" href="/assets/js/159.3ace6e8d.js"><link rel="prefetch" href="/assets/js/16.485682dd.js"><link rel="prefetch" href="/assets/js/160.512cf1fa.js"><link rel="prefetch" href="/assets/js/161.0d0ee2ea.js"><link rel="prefetch" href="/assets/js/162.bbdff718.js"><link rel="prefetch" href="/assets/js/163.4fdc9dff.js"><link rel="prefetch" href="/assets/js/164.20d6ef11.js"><link rel="prefetch" href="/assets/js/165.2881201e.js"><link rel="prefetch" href="/assets/js/166.3c7c3ba0.js"><link rel="prefetch" href="/assets/js/167.2143078a.js"><link rel="prefetch" href="/assets/js/168.9f3840f3.js"><link rel="prefetch" href="/assets/js/169.2da8b99f.js"><link rel="prefetch" href="/assets/js/17.53e3a4c9.js"><link rel="prefetch" href="/assets/js/170.997a014a.js"><link rel="prefetch" href="/assets/js/171.addd9a55.js"><link rel="prefetch" href="/assets/js/172.d3d12b0c.js"><link rel="prefetch" href="/assets/js/173.ebd6be51.js"><link rel="prefetch" href="/assets/js/174.c3546734.js"><link rel="prefetch" href="/assets/js/175.e786b04c.js"><link rel="prefetch" href="/assets/js/176.8a72d21e.js"><link rel="prefetch" href="/assets/js/177.4d74c35d.js"><link rel="prefetch" href="/assets/js/178.05b55aba.js"><link rel="prefetch" href="/assets/js/179.06c93c02.js"><link rel="prefetch" href="/assets/js/18.dac780ce.js"><link rel="prefetch" href="/assets/js/180.7a721d6a.js"><link rel="prefetch" href="/assets/js/181.854b3f72.js"><link rel="prefetch" href="/assets/js/182.19f58d6b.js"><link rel="prefetch" href="/assets/js/183.8f49d5b6.js"><link rel="prefetch" href="/assets/js/184.2128f02f.js"><link rel="prefetch" href="/assets/js/19.5bd66b43.js"><link rel="prefetch" href="/assets/js/20.8b0be400.js"><link rel="prefetch" href="/assets/js/21.26154688.js"><link rel="prefetch" href="/assets/js/22.75f3ad5d.js"><link rel="prefetch" href="/assets/js/23.205b8a93.js"><link rel="prefetch" href="/assets/js/24.78eaf948.js"><link rel="prefetch" href="/assets/js/25.5ac44d02.js"><link rel="prefetch" href="/assets/js/26.44e96c5e.js"><link rel="prefetch" href="/assets/js/27.9149de82.js"><link rel="prefetch" href="/assets/js/28.a117fe70.js"><link rel="prefetch" href="/assets/js/29.03c4dd26.js"><link rel="prefetch" href="/assets/js/3.a07e7c66.js"><link rel="prefetch" href="/assets/js/30.add3b4ce.js"><link rel="prefetch" href="/assets/js/31.c168f15b.js"><link rel="prefetch" href="/assets/js/32.6df3dd67.js"><link rel="prefetch" href="/assets/js/34.87d0684d.js"><link rel="prefetch" href="/assets/js/36.b2d8e023.js"><link rel="prefetch" href="/assets/js/37.6693f2b8.js"><link rel="prefetch" href="/assets/js/38.0adc87b6.js"><link rel="prefetch" href="/assets/js/39.4ee1b450.js"><link rel="prefetch" href="/assets/js/4.3601d982.js"><link rel="prefetch" href="/assets/js/40.3a15c4d2.js"><link rel="prefetch" href="/assets/js/41.5089de95.js"><link rel="prefetch" href="/assets/js/42.b6c516e6.js"><link rel="prefetch" href="/assets/js/43.4d729b64.js"><link rel="prefetch" href="/assets/js/44.afb6ada5.js"><link rel="prefetch" href="/assets/js/45.f90fef77.js"><link rel="prefetch" href="/assets/js/46.3f992a07.js"><link rel="prefetch" href="/assets/js/47.3df4792a.js"><link rel="prefetch" href="/assets/js/48.b1b42695.js"><link rel="prefetch" href="/assets/js/49.1f57735c.js"><link rel="prefetch" href="/assets/js/5.c77010ac.js"><link rel="prefetch" href="/assets/js/50.fb1f131c.js"><link rel="prefetch" href="/assets/js/51.621e6bbe.js"><link rel="prefetch" href="/assets/js/52.d3c5f8e8.js"><link rel="prefetch" href="/assets/js/53.fc428b5d.js"><link rel="prefetch" href="/assets/js/54.a8c7b4e7.js"><link rel="prefetch" href="/assets/js/55.9491ad4c.js"><link rel="prefetch" href="/assets/js/56.cc5535aa.js"><link rel="prefetch" href="/assets/js/57.08a4a942.js"><link rel="prefetch" href="/assets/js/58.ea5e0d13.js"><link rel="prefetch" href="/assets/js/59.e9ab1cc2.js"><link rel="prefetch" href="/assets/js/6.3dc37407.js"><link rel="prefetch" href="/assets/js/60.a0651ffe.js"><link rel="prefetch" href="/assets/js/61.9657adee.js"><link rel="prefetch" href="/assets/js/62.5522a97a.js"><link rel="prefetch" href="/assets/js/63.2c5c6db3.js"><link rel="prefetch" href="/assets/js/64.57e79c12.js"><link rel="prefetch" href="/assets/js/65.5e0e9f19.js"><link rel="prefetch" href="/assets/js/66.e80de9ef.js"><link rel="prefetch" href="/assets/js/67.147e8e38.js"><link rel="prefetch" href="/assets/js/68.26a3c0d4.js"><link rel="prefetch" href="/assets/js/69.8f293aac.js"><link rel="prefetch" href="/assets/js/7.53864b7a.js"><link rel="prefetch" href="/assets/js/70.291565bb.js"><link rel="prefetch" href="/assets/js/71.fe0bdf0f.js"><link rel="prefetch" href="/assets/js/72.61d2bc84.js"><link rel="prefetch" href="/assets/js/73.9fcb62aa.js"><link rel="prefetch" href="/assets/js/74.9d682c13.js"><link rel="prefetch" href="/assets/js/75.3264a4ce.js"><link rel="prefetch" href="/assets/js/76.1f8b1f97.js"><link rel="prefetch" href="/assets/js/77.32b48d28.js"><link rel="prefetch" href="/assets/js/78.b50a8708.js"><link rel="prefetch" href="/assets/js/79.e9abf630.js"><link rel="prefetch" href="/assets/js/8.50c01faa.js"><link rel="prefetch" href="/assets/js/80.180a3806.js"><link rel="prefetch" href="/assets/js/81.7800a9ae.js"><link rel="prefetch" href="/assets/js/82.388bd268.js"><link rel="prefetch" href="/assets/js/83.27d7c820.js"><link rel="prefetch" href="/assets/js/84.a7be62b6.js"><link rel="prefetch" href="/assets/js/85.e286c095.js"><link rel="prefetch" href="/assets/js/86.84fed10f.js"><link rel="prefetch" href="/assets/js/87.4b95dccb.js"><link rel="prefetch" href="/assets/js/88.dd70f5b5.js"><link rel="prefetch" href="/assets/js/89.4a04d404.js"><link rel="prefetch" href="/assets/js/9.947b77c2.js"><link rel="prefetch" href="/assets/js/90.699f3eeb.js"><link rel="prefetch" href="/assets/js/91.9f21bc4f.js"><link rel="prefetch" href="/assets/js/92.8e8caa65.js"><link rel="prefetch" href="/assets/js/93.08b1a369.js"><link rel="prefetch" href="/assets/js/94.8aa7234f.js"><link rel="prefetch" href="/assets/js/95.1d25fc22.js"><link rel="prefetch" href="/assets/js/96.8bb62cc7.js"><link rel="prefetch" href="/assets/js/97.eed16352.js"><link rel="prefetch" href="/assets/js/98.623e948b.js"><link rel="prefetch" href="/assets/js/99.45cfef32.js">
    <link rel="stylesheet" href="/assets/css/0.styles.721694fb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Conanan</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Basic" class="dropdown-title"><span class="title">Basic</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>OS</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Basic/OS/Linux/0 Intro.html" class="nav-link">Linux</a></li><li class="dropdown-subitem"><a href="/Basic/OS/Docker/0 Docker.html" class="nav-link">Docker</a></li><li class="dropdown-subitem"><a href="/Basic/OS/K8/0 Intro.html" class="nav-link">K8</a></li></ul></li><li class="dropdown-item"><h4>Network</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Basic/Network/TCP/IP/0 Intro.html" class="nav-link">TCP/IP</a></li><li class="dropdown-subitem"><a href="/Basic/Network/HTTP/0 Intro.html" class="nav-link">HTTP</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="DataBase" class="dropdown-title"><span class="title">DataBase</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/DataBase/RDBMS/0 Primer.html" class="nav-link">RDBMS</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Redis/0 Intro.html" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Mongo/0 Intro.html" class="nav-link">Mongo</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Lucene/0 Primer.html" class="nav-link">Lucene</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Solr/0 Primer.html" class="nav-link">Solr</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Elasticsearch/0 Primer.html" class="nav-link">Elasticsearch</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Design" class="dropdown-title"><span class="title">Design</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Design/Design Pattern/0 Intro.html" class="nav-link">Design Pattern</a></li><li class="dropdown-item"><!----> <a href="/Design/DDD/0 Basic.html" class="nav-link">DDD</a></li><li class="dropdown-item"><!----> <a href="/Design/MicroServer/0 Intro.html" class="nav-link">MicroServer</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java Study" class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Java/Core/0 Basic.html" class="nav-link">Core</a></li><li class="dropdown-item"><!----> <a href="/Java/Jakarta EE/0 Servlet.html" class="nav-link">Jakarta EE</a></li><li class="dropdown-item"><!----> <a href="/Java/Spring/primer/0 Primer.html" class="nav-link">Spring</a></li><li class="dropdown-item"><!----> <a href="/Java/Persistence/Mybatis/0 Primer.html" class="nav-link">Persistence</a></li><li class="dropdown-item"><!----> <a href="/Java/Authe&amp;Autho/0 Primer.html" class="nav-link">认证&amp;授权</a></li><li class="dropdown-item"><h4>分布式&amp;微服务</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/language/chinese/" class="nav-link">Dubbo</a></li><li class="dropdown-subitem"><a href="/language/japanese/" class="nav-link">Spring Cloud Netflix</a></li><li class="dropdown-subitem"><a href="/language/japanese/" class="nav-link">Spring Cloud Alibaba</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Tools" class="dropdown-title"><span class="title">Tools</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Tools/Vim/Vim.html" class="nav-link">Vim</a></li><li class="dropdown-item"><!----> <a href="/Tools/Git/Git.html" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/Tools/Maven/Maven.html" class="nav-link">Maven</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Server" class="dropdown-title"><span class="title">Server</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Server/Tomcat/0 Primer.html" class="nav-link">Tomcat</a></li><li class="dropdown-item"><!----> <a href="/Server/Nginx/0 Primer.html" class="nav-link">Nginx</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Front End" class="dropdown-title"><span class="title">Front End</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Front End/H5&amp;CSS3/1 HTML.html" class="nav-link">H5&amp;CSS3</a></li><li class="dropdown-item"><!----> <a href="/Front End/JS/0 入门-0 入门.html" class="nav-link">JS</a></li><li class="dropdown-item"><!----> <a href="/Front End/NodeJS/NodeJS-1 入门.html" class="nav-link">NodeJS</a></li><li class="dropdown-item"><!----> <a href="/Front End/Vue/1-1 Primer.html" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/Front End/微信小程序/1-1 Primer.html" class="nav-link">微信小程序</a></li><li class="dropdown-item"><!----> <a href="/Front End/Android/0 Intro.html" class="nav-link">Android</a></li><li class="dropdown-item"><!----> <a href="/Front End/Flutter/0 Intro.html" class="nav-link">Flutter</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Environment" class="dropdown-title"><span class="title">Environment</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Environment/macOS/macOS.html" class="nav-link">macOS</a></li><li class="dropdown-item"><!----> <a href="/Environment/Windows/Windows.html" class="nav-link">Windows</a></li><li class="dropdown-item"><!----> <a href="/Environment/Software/IDEA.html" class="nav-link">Software</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Project" class="dropdown-title"><span class="title">Project</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Project/电商/简介.html" class="nav-link">电商</a></li><li class="dropdown-item"><!----> <a href="/Environment/Linux/Linux.html" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/Environment/Windows/Windows.html" class="nav-link">Windows</a></li><li class="dropdown-item"><!----> <a href="/Environment/Software/Software.html" class="nav-link">Software</a></li></ul></div></div> <a href="https://github.com/apple54whn/notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Basic" class="dropdown-title"><span class="title">Basic</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>OS</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Basic/OS/Linux/0 Intro.html" class="nav-link">Linux</a></li><li class="dropdown-subitem"><a href="/Basic/OS/Docker/0 Docker.html" class="nav-link">Docker</a></li><li class="dropdown-subitem"><a href="/Basic/OS/K8/0 Intro.html" class="nav-link">K8</a></li></ul></li><li class="dropdown-item"><h4>Network</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Basic/Network/TCP/IP/0 Intro.html" class="nav-link">TCP/IP</a></li><li class="dropdown-subitem"><a href="/Basic/Network/HTTP/0 Intro.html" class="nav-link">HTTP</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="DataBase" class="dropdown-title"><span class="title">DataBase</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/DataBase/RDBMS/0 Primer.html" class="nav-link">RDBMS</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Redis/0 Intro.html" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Mongo/0 Intro.html" class="nav-link">Mongo</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Lucene/0 Primer.html" class="nav-link">Lucene</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Solr/0 Primer.html" class="nav-link">Solr</a></li><li class="dropdown-item"><!----> <a href="/DataBase/Elasticsearch/0 Primer.html" class="nav-link">Elasticsearch</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Design" class="dropdown-title"><span class="title">Design</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Design/Design Pattern/0 Intro.html" class="nav-link">Design Pattern</a></li><li class="dropdown-item"><!----> <a href="/Design/DDD/0 Basic.html" class="nav-link">DDD</a></li><li class="dropdown-item"><!----> <a href="/Design/MicroServer/0 Intro.html" class="nav-link">MicroServer</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java Study" class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Java/Core/0 Basic.html" class="nav-link">Core</a></li><li class="dropdown-item"><!----> <a href="/Java/Jakarta EE/0 Servlet.html" class="nav-link">Jakarta EE</a></li><li class="dropdown-item"><!----> <a href="/Java/Spring/primer/0 Primer.html" class="nav-link">Spring</a></li><li class="dropdown-item"><!----> <a href="/Java/Persistence/Mybatis/0 Primer.html" class="nav-link">Persistence</a></li><li class="dropdown-item"><!----> <a href="/Java/Authe&amp;Autho/0 Primer.html" class="nav-link">认证&amp;授权</a></li><li class="dropdown-item"><h4>分布式&amp;微服务</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/language/chinese/" class="nav-link">Dubbo</a></li><li class="dropdown-subitem"><a href="/language/japanese/" class="nav-link">Spring Cloud Netflix</a></li><li class="dropdown-subitem"><a href="/language/japanese/" class="nav-link">Spring Cloud Alibaba</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Tools" class="dropdown-title"><span class="title">Tools</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Tools/Vim/Vim.html" class="nav-link">Vim</a></li><li class="dropdown-item"><!----> <a href="/Tools/Git/Git.html" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/Tools/Maven/Maven.html" class="nav-link">Maven</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Server" class="dropdown-title"><span class="title">Server</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Server/Tomcat/0 Primer.html" class="nav-link">Tomcat</a></li><li class="dropdown-item"><!----> <a href="/Server/Nginx/0 Primer.html" class="nav-link">Nginx</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Front End" class="dropdown-title"><span class="title">Front End</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Front End/H5&amp;CSS3/1 HTML.html" class="nav-link">H5&amp;CSS3</a></li><li class="dropdown-item"><!----> <a href="/Front End/JS/0 入门-0 入门.html" class="nav-link">JS</a></li><li class="dropdown-item"><!----> <a href="/Front End/NodeJS/NodeJS-1 入门.html" class="nav-link">NodeJS</a></li><li class="dropdown-item"><!----> <a href="/Front End/Vue/1-1 Primer.html" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/Front End/微信小程序/1-1 Primer.html" class="nav-link">微信小程序</a></li><li class="dropdown-item"><!----> <a href="/Front End/Android/0 Intro.html" class="nav-link">Android</a></li><li class="dropdown-item"><!----> <a href="/Front End/Flutter/0 Intro.html" class="nav-link">Flutter</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Environment" class="dropdown-title"><span class="title">Environment</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Environment/macOS/macOS.html" class="nav-link">macOS</a></li><li class="dropdown-item"><!----> <a href="/Environment/Windows/Windows.html" class="nav-link">Windows</a></li><li class="dropdown-item"><!----> <a href="/Environment/Software/IDEA.html" class="nav-link">Software</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Project" class="dropdown-title"><span class="title">Project</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Project/电商/简介.html" class="nav-link">电商</a></li><li class="dropdown-item"><!----> <a href="/Environment/Linux/Linux.html" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/Environment/Windows/Windows.html" class="nav-link">Windows</a></li><li class="dropdown-item"><!----> <a href="/Environment/Software/Software.html" class="nav-link">Software</a></li></ul></div></div> <a href="https://github.com/apple54whn/notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Primer</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/DataBase/Elasticsearch/0 Primer.html" class="sidebar-link">概述</a></li><li><a href="/DataBase/Elasticsearch/1 配置.html" class="sidebar-link">配置</a></li><li><a href="/DataBase/Elasticsearch/2 部署.html" class="sidebar-link">部署</a></li><li><a href="/DataBase/Elasticsearch/3 插件.html" class="sidebar-link">插件</a></li><li><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html" class="active sidebar-link">Index &amp; Document</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#dev-和-ops-视角" class="sidebar-link">Dev 和 Ops 视角</a></li><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#index" class="sidebar-link">Index</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#查询" class="sidebar-link">查询</a></li><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#创建" class="sidebar-link">创建</a></li><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#只可删除-index" class="sidebar-link">只可删除 index</a></li><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#无法修改，只能迁移数据" class="sidebar-link">无法修改，只能迁移数据</a></li></ul></li><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#setting" class="sidebar-link">setting</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#查询-2" class="sidebar-link">查询</a></li><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#创建-2" class="sidebar-link">创建</a></li><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#只可删除-index-2" class="sidebar-link">只可删除 index</a></li><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#无法修改，只能迁移数据-2" class="sidebar-link">无法修改，只能迁移数据</a></li></ul></li><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#mapping" class="sidebar-link">mapping</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#查询-3" class="sidebar-link">查询</a></li><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#创建-3" class="sidebar-link">创建</a></li><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#添加新字段" class="sidebar-link">添加新字段</a></li><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#已有字段不允许更新-field" class="sidebar-link">已有字段不允许更新 Field</a></li><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#只可删除-index-3" class="sidebar-link">只可删除 index</a></li></ul></li><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#常用映射类型" class="sidebar-link">常用映射类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#字符串—text" class="sidebar-link">字符串—text</a></li><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#字符串—keyword" class="sidebar-link">字符串—keyword</a></li><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#数值类型" class="sidebar-link">数值类型</a></li><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#te-布尔值" class="sidebar-link">te 布尔值</a></li><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#date" class="sidebar-link">date</a></li><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#二进制" class="sidebar-link">二进制</a></li><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#综合例子" class="sidebar-link">综合例子</a></li></ul></li><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#type" class="sidebar-link">~~Type~~</a></li><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#document" class="sidebar-link">Document</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#元数据" class="sidebar-link">元数据</a></li><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#创建-4" class="sidebar-link">创建</a></li><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#修改（覆盖）" class="sidebar-link">修改（覆盖）</a></li><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#修改（局部修改）🔥" class="sidebar-link">修改（局部修改）🔥</a></li><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#删除" class="sidebar-link">删除</a></li></ul></li><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#cat-查询" class="sidebar-link">_cat 查询</a></li><li class="sidebar-sub-header"><a href="/DataBase/Elasticsearch/4 Index &amp; Document.html#reindex-alias-迁移数据" class="sidebar-link">Reindex &amp; alias 迁移数据</a></li></ul></li><li><a href="/DataBase/Elasticsearch/5 搜索.html" class="sidebar-link">搜索</a></li><li><a href="/DataBase/Elasticsearch/5 原理.html" class="sidebar-link">原理</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="index-document"><a href="#index-document" class="header-anchor">#</a> Index &amp; Document</h1> <p>ES 作为一个索引及搜索服务，对外提供丰富的 RESTful 接口。如下示例使用 Kibana 操作，PostMan 同理。</p> <h2 id="dev-和-ops-视角"><a href="#dev-和-ops-视角" class="header-anchor">#</a> Dev 和 Ops 视角</h2> <p><img src="/assets/img/image-20200420003109861.efa6d206.png" alt="image-20200420003109861"></p> <ul><li><p>Index 索引</p> <ul><li><s>Type 类型</s></li> <li>Document 文档</li></ul></li> <li><p>Node 节点</p> <ul><li>Shard 分片</li></ul></li></ul> <h2 id="index"><a href="#index" class="header-anchor">#</a> Index</h2> <ul><li>Index 是 <strong>Document 的容器</strong>，是<strong>同一类（7.0 之后只允许为<code>_doc</code>） Document 的集合</strong>。</li> <li>Index 体现了<strong>逻辑</strong>空间的概念，与 Node 体现物理空间不同</li> <li>Index 就相当于 RDBMS 中的<strong>表</strong>，或相当于 Mongodb 中的<strong>集合</strong></li> <li>Index 包括了<strong>分词列表</strong>及<strong>文档列表</strong></li> <li>每个 Index 都有自己的 <strong>mapping</strong> 定义，用于定义包含的 <strong>Document 的 Field 名称 和 Field 类型</strong>。不定义 mapping 直接插入 Document 时 ES 会自动判断 Field 类型并生成。setting 同理也会自动生成。</li></ul> <div class="custom-block tip"><p class="custom-block-title">思考</p> <p>创建索引库相当于关系数据库中的数据库还是表？</p> <ul><li><p>如果相当于<strong>数据库</strong>就表示一个索引库可以创建很多不同类型的文档，这在ES中也是允许的（但是 7.0 之后不允许！）</p></li> <li><p>如果相当于<strong>表</strong>就表示一个索引库只能存储相同类型的文档，ES官方<strong>建议</strong>在一个索引库中只存<strong>储相同类型的文档</strong></p> <table><thead><tr><th style="text-align:center;">RDBMS</th> <th style="text-align:center;">ES</th></tr></thead> <tbody><tr><td style="text-align:center;">Table</td> <td style="text-align:center;">Index（Type）</td></tr> <tr><td style="text-align:center;">Row</td> <td style="text-align:center;">Document</td></tr> <tr><td style="text-align:center;">Column</td> <td style="text-align:center;">Field</td></tr> <tr><td style="text-align:center;">Schema</td> <td style="text-align:center;">Mapping</td></tr> <tr><td style="text-align:center;">SQL</td> <td style="text-align:center;">DSL</td></tr></tbody></table></li></ul></div> <div class="custom-block tip"><p class="custom-block-title">Index 的不同语义</p> <p>Indexing （动词）Document 到 ES 的 Index（名词）中</p> <ul><li>名词：一个 ES 集群中，可以创建很多个不同的 Index</li> <li>动词：保存一个 Document 到 ES 的过程也称作 Indexing（ES 创建一个倒排 Index 的过程）</li> <li>名词：一个 B 树 Index，一个倒排 Index</li></ul></div> <h3 id="查询"><a href="#查询" class="header-anchor">#</a> 查询</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 查询 index 的信息，包括 setting 和 mapping</span>
GET /<span class="token operator">&lt;</span>index<span class="token operator">&gt;</span>
</code></pre></div><h3 id="创建"><a href="#创建" class="header-anchor">#</a> 创建</h3> <p>综合 setting 和 mapping</p> <div class="language-bash extra-class"><pre class="language-bash"><code>PUT /<span class="token operator">&lt;</span>index<span class="token operator">&gt;</span>
<span class="token punctuation">{</span>
    <span class="token string">&quot;settings&quot;</span>:<span class="token punctuation">{</span>
        <span class="token string">&quot;index&quot;</span>:<span class="token punctuation">{</span>
            <span class="token string">&quot;number_of_shards&quot;</span>:1,
            <span class="token string">&quot;number_of_replicas&quot;</span>:0
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>,
    <span class="token string">&quot;properties&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;description&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;text&quot;</span>,
            <span class="token string">&quot;analyzer&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;ik_max_word&quot;</span>,
            <span class="token string">&quot;search_analyzer&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;ik_smart&quot;</span>
        <span class="token punctuation">}</span>,
        <span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;text&quot;</span>,
            <span class="token string">&quot;analyzer&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;ik_max_word&quot;</span>,
            <span class="token string">&quot;search_analyzer&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;ik_smart&quot;</span>
        <span class="token punctuation">}</span>,
        <span class="token string">&quot;pic&quot;</span>:<span class="token punctuation">{</span>
            <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;text&quot;</span>,
            <span class="token string">&quot;index&quot;</span>:false
        <span class="token punctuation">}</span>,
        <span class="token string">&quot;price&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;float&quot;</span>
        <span class="token punctuation">}</span>,
        <span class="token string">&quot;studymodel&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;keyword&quot;</span>
        <span class="token punctuation">}</span>,
        <span class="token string">&quot;timestamp&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;date&quot;</span>,
            <span class="token string">&quot;format&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;yyyy‐MM‐dd HH:mm:ss||yyyy‐MM‐dd||epoch_millis&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="只可删除-index"><a href="#只可删除-index" class="header-anchor">#</a> 只可删除 index</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>DELETE /<span class="token operator">&lt;</span>index<span class="token operator">&gt;</span>
</code></pre></div><p>删除 Index 的同时会删除该 Index 下的所有 setting、mapping 和 Document</p> <h3 id="无法修改，只能迁移数据"><a href="#无法修改，只能迁移数据" class="header-anchor">#</a> 无法修改，只能迁移数据</h3> <p>映射创建成功可以<strong>添加新字段</strong>，<strong>已有字段不允许更新 type</strong></p> <h2 id="setting"><a href="#setting" class="header-anchor">#</a> setting</h2> <p>setting 定义了不同的数据分布（索引的分片，副本）</p> <h3 id="查询-2"><a href="#查询-2" class="header-anchor">#</a> 查询</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>GET /<span class="token operator">&lt;</span>index<span class="token operator">&gt;</span>/_settings

<span class="token comment"># 查询所有 index 的 setting</span>
GET /_settings
</code></pre></div><h3 id="创建-2"><a href="#创建-2" class="header-anchor">#</a> 创建</h3> <div class="custom-block tip"><p class="custom-block-title">注意</p> <p>使用 PUT 是由于<strong>幂等</strong>；不能使用 POST 是由于<strong>非幂等</strong>且 POST <strong>默认会添加 Document</strong>，同时设置 setting 和 mapping</p></div> <div class="language-bash extra-class"><pre class="language-bash"><code>PUT /<span class="token operator">&lt;</span>index<span class="token operator">&gt;</span>
<span class="token punctuation">{</span>
    <span class="token string">&quot;settings&quot;</span>:<span class="token punctuation">{</span>
        <span class="token string">&quot;index&quot;</span>:<span class="token punctuation">{</span>
            <span class="token string">&quot;number_of_shards&quot;</span>:1,
            <span class="token string">&quot;number_of_replicas&quot;</span>:0
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><p><code>number_of_shards</code>：设置<strong>分片的数量</strong>，在集群中通常设置多个分片，表示一个索引库将拆分成多片分别存储不同的结点，提高了ES的处理能力和高可用性，入门程序使用单机环境，这里设置为1。</p></li> <li><p><code>number_of_replicas</code>：设置<strong>副本</strong>的数量，设置副本是为了提高 ES 的高可靠性，单机环境设置为0。</p></li></ul> <div class="custom-block tip"><p class="custom-block-title">注意</p> <p>ES6.0 之前的版本有 Type（类型）概念，相当于关系数据库的表，ES 官方将在 ES9.0 版本中彻底删除 Type</p></div> <h3 id="只可删除-index-2"><a href="#只可删除-index-2" class="header-anchor">#</a> 只可删除 index</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>DELETE /<span class="token operator">&lt;</span>index<span class="token operator">&gt;</span>
</code></pre></div><p>删除 Index 的同时会删除该 Index 下的所有 setting、mapping 和 Document</p> <h3 id="无法修改，只能迁移数据-2"><a href="#无法修改，只能迁移数据-2" class="header-anchor">#</a> 无法修改，只能迁移数据</h3> <h2 id="mapping"><a href="#mapping" class="header-anchor">#</a> mapping</h2> <p>在 Index 中每个 Document 都包括了一个或多个 Field，创建 mapping 就是向<strong>Index（索引库）<strong>中</strong>创建 Field</strong> 并指定 <strong>Field 类型</strong>的过程。虽然 ES 会根据 Document 自动设置类型，但是有些 Field 需要自己手动设置！</p> <h3 id="查询-3"><a href="#查询-3" class="header-anchor">#</a> 查询</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>GET /<span class="token operator">&lt;</span>index<span class="token operator">&gt;</span>/_mapping

<span class="token comment"># 查询所有 index 的 mapping</span>
GET /_mapping
</code></pre></div><h3 id="创建-3"><a href="#创建-3" class="header-anchor">#</a> 创建</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 创建 Index 的 mapping</span>
PUT /<span class="token operator">&lt;</span>index<span class="token operator">&gt;</span>
<span class="token punctuation">{</span>
  <span class="token string">&quot;mappings&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;properties&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
                <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;text&quot;</span>
            <span class="token punctuation">}</span>,
            <span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
                <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;integer&quot;</span>
            <span class="token punctuation">}</span>,
            <span class="token string">&quot;mail&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
                <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;keyword&quot;</span>
            <span class="token punctuation">}</span>,
            <span class="token string">&quot;hobby&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
                <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;text&quot;</span>,
                <span class="token string">&quot;analyzer&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;ik_max_word&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="添加新字段"><a href="#添加新字段" class="header-anchor">#</a> 添加新字段</h3> <p>映射创建成功后可以<strong>添加新字段</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>PUT /<span class="token operator">&lt;</span>index<span class="token operator">&gt;</span>/_mapping/_doc
<span class="token punctuation">{</span>
	<span class="token string">&quot;properties&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
		<span class="token string">&quot;sex&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
			<span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;text&quot;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="已有字段不允许更新-field"><a href="#已有字段不允许更新-field" class="header-anchor">#</a> 已有字段不允许更新 Field</h3> <p>可以迁移数据，使用 Reindex 和 alias 完成</p> <h3 id="只可删除-index-3"><a href="#只可删除-index-3" class="header-anchor">#</a> 只可删除 index</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>DELETE /<span class="token operator">&lt;</span>index<span class="token operator">&gt;</span>
</code></pre></div><p>删除 Index 的同时会删除该 Index 下的所有 setting、mapping 和 Document</p> <h2 id="常用映射类型"><a href="#常用映射类型" class="header-anchor">#</a> 常用映射类型</h2> <h3 id="字符串—text"><a href="#字符串—text" class="header-anchor">#</a> 字符串—text</h3> <ul><li><p><strong>index</strong></p> <p>通过index属性指定<strong>是否索引</strong>，<strong>默认为index=true</strong>，即要进行索引，只有进行索引才可以从索引库搜索到。</p> <p>但是也有一些内容不需要索引，比如：商品图片地址只被用来展示图片，不进行搜索图片，此时可以将index设置为false</p></li> <li><p><strong>analyzer</strong></p> <p>通过analyzer属性指定分词器。下边指定name的字段类型为text，使用ik分词器的ik_max_word分词模式。</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span><span class="token string">&quot;ik_max_word&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p><strong>search_analyzer</strong></p> <p>上边指定了analyzer是指在索引和搜索都使用ik_max_word，如果<strong>单独</strong>想定义<strong>搜索时使用的分词器</strong>则可以通过该属性</p> <p>对于ik分词器建议是<strong>索引</strong>时使用**<code>ik_max_word</code><strong>将搜索内容进行细粒度分词，<strong>搜索</strong>时使用</strong><code>ik_smart</code>**提高搜索精确性</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span><span class="token string">&quot;ik_max_word&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;search_analyzer&quot;</span><span class="token operator">:</span><span class="token string">&quot;ik_smart&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p><strong>store</strong></p> <p>是否在source之外存储，默认为false。每个文档索引后会在 ES中保存一份原始文档，存放在&quot;<code>_source</code>&quot;中，一般情况下不需要设置store为true，因为在_source中已经有一份原始文档了。</p></li></ul> <p>测试</p> <ul><li><p>手动删除xc_course/doc下的映射，即删除索引库，创建索引库</p></li> <li><p>创建新映射：<code>Post http://localhost:9200/xc_course/doc/_mapping</code></p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span><span class="token string">&quot;ik_max_word&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;search_analyzer&quot;</span><span class="token operator">:</span><span class="token string">&quot;ik_smart&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span><span class="token string">&quot;ik_max_word&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;search_analyzer&quot;</span><span class="token operator">:</span><span class="token string">&quot;ik_smart&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;pic&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token boolean">false</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;studymodel&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;text&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>插入文档：<code>post http://localhost:9200/xc_course/doc/4028e58161bcf7f40161bcf8b77c0000</code></p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;Bootstrap开发框架&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;description&quot;</span><span class="token operator">:</span><span class="token string">&quot;Bootstrap是由Twitter推出的一个前台页面开发框架，在行业之中使用较为广泛。此开发框架包含了大量的CSS、JS程序代码，可以帮助开发者（尤其是不擅长页面开发的程序人员）轻松的实现一个不受浏览器限制的精美界面效果。&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;pic&quot;</span><span class="token operator">:</span><span class="token string">&quot;group1/M00/00/01/wKhlQFqO4MmAOP53AAAcwDwm6SU490.jpg&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;studymodel&quot;</span><span class="token operator">:</span><span class="token string">&quot;201002&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>查询测试：</p> <ul><li><code>Get http://localhost:9200/xc_course/_search?q=name:java开发</code>。也能搜到，会先搜索分词</li> <li><code>Get http://localhost:9200/xc_course/_search?q=description:开发</code></li> <li><code>Get http://localhost:9200/xc_course/_search? q=pic:group1/M00/00/01/wKhlQFqO4MmAOP53AAAcwDwm6SU490.jpg</code></li> <li><code>Get http://localhost:9200/xc_course/_search?q=studymodel:201002</code></li></ul> <p>【结论】name、description和studymodel都支持全文检索，pic不可作为查询条件</p></li></ul> <h3 id="字符串—keyword"><a href="#字符串—keyword" class="header-anchor">#</a> 字符串—keyword</h3> <p>上边介绍的text文本字段在映射时要设置分词器，keyword字段为关键字字段，通常搜索keyword按照<strong>整体搜索精确匹配</strong>，所以创建keyword字段的索引时是<strong>不进行分词</strong>的，比如：邮政编码、手机号码、身份证等。keyword字段通常用于<strong>过虑、排序、聚合</strong>等</p> <p>测试：</p> <ul><li><p>手动删除xc_course/doc下的映射，即删除索引库，创建索引库</p></li> <li><p>创建新映射：<code>Post http://localhost:9200/xc_course/doc/_mapping</code></p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span><span class="token string">&quot;ik_max_word&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;search_analyzer&quot;</span><span class="token operator">:</span><span class="token string">&quot;ik_smart&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;pic&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;index&quot;</span><span class="token operator">:</span><span class="token boolean">false</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;studymodel&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;keyword&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>插入文档：<code>post http://localhost:9200/xc_course/doc/4028e58161bcf7f40161bcf8b77c0000</code></p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;java编程基础&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;java语言是世界第一编程语言，在软件开发领域使用人数最多。&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;pic&quot;</span><span class="token operator">:</span><span class="token string">&quot;group1/M00/00/01/wKhlQFqO4MmAOP53AAAcwDwm6SU490.jpg&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;studymodel&quot;</span><span class="token operator">:</span> <span class="token string">&quot;201001&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>根据studymodel查询文档：<code>get http://localhost:9200/xc_course/_search?q=name:java</code></p> <p>name是keyword类型，所以查询方式是精确查询，全部匹配！！！</p></li></ul> <h3 id="数值类型"><a href="#数值类型" class="header-anchor">#</a> 数值类型</h3> <p>下边是ES支持的数值类型</p> <p><img src="/assets/img/1551547245658.81dc0a5d.png" alt="1551547245658"></p> <ul><li><p>尽量选择<strong>范围小</strong>的类型，提高搜索效率（比如long类型别乱选）</p></li> <li><p>对于<strong>浮点数</strong>尽量用<strong>比例因子</strong>，比如一个价格字段，单位为元，我们将比例因子设置为100这在ES中会按分存储，映射如下：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;price&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;scaled_float&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;scaling_factor&quot;</span><span class="token operator">:</span> <span class="token number">100</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>由于比例因子为100，如果我们输入的价格是23.45则ES中会将23.45乘以100存储在ES中</p> <p>如果输入的价格是23.456，ES会将23.456乘以100再取一个接近原始值的数，得出2346</p> <p>使用比例因子的好处是<strong>整型比浮点型更易压缩</strong>，<strong>节省磁盘空间</strong></p> <p>如果比例因子不适合，则从下表选择范围小的去用：</p> <p><img src="images/1551547392387.png" alt="1551547392387"></p></li></ul> <h3 id="te-布尔值"><a href="#te-布尔值" class="header-anchor">#</a> te 布尔值</h3> <ul><li>boolean</li></ul> <h3 id="date"><a href="#date" class="header-anchor">#</a> date</h3> <p>日期类型不用设置分词器。通常用于<strong>排序</strong>。</p> <ul><li>format：设置日期格式</li></ul> <p>测试</p> <ul><li><p>下边的设置允许date字段存储年月日时分秒、年月日及毫秒三种格式：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;date&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;format&quot;</span><span class="token operator">:</span> <span class="token string">&quot;yyyy‐MM‐dd HH:mm:ss||yyyy‐MM‐dd&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>插入文档：<code>Post http://localhost:9200/xc_course/doc/3</code></p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;spring开发基础&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;spring 在java领域非常流行，java程序员都在用。&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;studymodel&quot;</span><span class="token operator">:</span> <span class="token string">&quot;201001&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;pic&quot;</span><span class="token operator">:</span><span class="token string">&quot;group1/M00/00/01/wKhlQFqO4MmAOP53AAAcwDwm6SU490.jpg&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span><span class="token string">&quot;2018‐07‐04 18:28:58&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul> <h3 id="二进制"><a href="#二进制" class="header-anchor">#</a> 二进制</h3> <ul><li>binary</li></ul> <h3 id="综合例子"><a href="#综合例子" class="header-anchor">#</a> 综合例子</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>PUT /<span class="token operator">&lt;</span>index<span class="token operator">&gt;</span>/_doc/_mapping
<span class="token punctuation">{</span>
    <span class="token string">&quot;properties&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;description&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;text&quot;</span>,
            <span class="token string">&quot;analyzer&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;ik_max_word&quot;</span>,
            <span class="token string">&quot;search_analyzer&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;ik_smart&quot;</span>
        <span class="token punctuation">}</span>,
        <span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;text&quot;</span>,
            <span class="token string">&quot;analyzer&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;ik_max_word&quot;</span>,
            <span class="token string">&quot;search_analyzer&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;ik_smart&quot;</span>
        <span class="token punctuation">}</span>,
        <span class="token string">&quot;pic&quot;</span>:<span class="token punctuation">{</span>
            <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;text&quot;</span>,
            <span class="token string">&quot;index&quot;</span>:false
        <span class="token punctuation">}</span>,
        <span class="token string">&quot;price&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;float&quot;</span>
        <span class="token punctuation">}</span>,
        <span class="token string">&quot;studymodel&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;keyword&quot;</span>
        <span class="token punctuation">}</span>,
        <span class="token string">&quot;timestamp&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;date&quot;</span>,
            <span class="token string">&quot;format&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;yyyy‐MM‐dd HH:mm:ss||yyyy‐MM‐dd||epoch_millis&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="type"><a href="#type" class="header-anchor">#</a> <s>Type</s></h2> <ul><li>在 7.0 之前，一个 Index 可以设置多个 Types</li> <li>6.0 开始，Type 已经被 Deprecated。7.0 开始一个 Index 只能创建一个 Type：<code>_doc</code></li></ul> <h2 id="document"><a href="#document" class="header-anchor">#</a> Document</h2> <ul><li>ES 是<strong>面向 Document 的</strong>，Document 是所有<strong>可搜索数据的最小单位</strong> <ul><li>日志文件中的日志项</li> <li>一本电影的具体信息；一张唱片的详细信息</li> <li>MP3 播放器里的一首歌；一篇 PDF 文档中的具体内容</li></ul></li> <li>一篇 Documemt 包含了一系列的 Field，类似数据库中表的一条记录</li> <li><strong>Document 会被序列化成 JSON，保存</strong>在 ES 中
<ul><li><strong>JSON 对象由 Field 组成</strong></li> <li>每个 Field 都有对应的类型（字符串、数值、布尔、日期、二进制、范围类型）</li></ul></li> <li><strong>每个 Document 都有一个 Unique ID</strong> <ul><li>可以自己指定 ID</li> <li>可以通过 ES 自动生成，32 位长度字符串</li></ul></li></ul> <h3 id="元数据"><a href="#元数据" class="header-anchor">#</a> 元数据</h3> <p>每一篇 Document 都有元数据，用于标注 Document 的相关信息</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;_index&quot;</span><span class="token operator">:</span> <span class="token string">&quot;movies&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;_doc&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2665&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_version&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;@version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Earth vs. the Flying Saucers&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;genre&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;Sci-Fi&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;year&quot;</span><span class="token operator">:</span> <span class="token number">1956</span><span class="token punctuation">,</span>
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2665&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>_index：Document 所属的 Index 名</li> <li>_type：Document 所属的 Type 名</li> <li>_id：文档的唯一 ID</li> <li>_version：Document 的版本信息，每次修改都会加一</li> <li>_score：相关性打分</li> <li>_source：文档的原始 JSON 数据</li> <li><s>_all：整合所有 Field 内容到该字段。已被废除</s></li></ul> <h3 id="创建-4"><a href="#创建-4" class="header-anchor">#</a> 创建</h3> <p>ES 中的文档相当于 RDBMS 中的一条<strong>记录</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 创建，如果不指定 id 值 ES 会自动生成ID（不推荐，影响 RESTful 语义）</span>
POST /<span class="token operator">&lt;</span>index<span class="token operator">&gt;</span>/_doc
POST /<span class="token operator">&lt;</span>index<span class="token operator">&gt;</span>/_doc/<span class="token operator">&lt;</span>_id<span class="token operator">&gt;</span>
POST /<span class="token operator">&lt;</span>index<span class="token operator">&gt;</span>/_create/<span class="token operator">&lt;</span>_id<span class="token operator">&gt;</span>
<span class="token punctuation">{</span>
  <span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;zhangsan11111&quot;</span>,
  <span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span> <span class="token number">13</span>,
  <span class="token string">&quot;mail&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;11111@qq.com&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>若不指定 ID 值 ES 会自动生成 ID</li> <li><strong>若 ID 已存在，则修改</strong>，且根据提供的数据修改，没有的 Field 则删除掉。不推荐，影响 RESTful 语义</li></ul> <h3 id="修改（覆盖）"><a href="#修改（覆盖）" class="header-anchor">#</a> 修改（覆盖）</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 修改（全修改），若 ID 所在 Document 不存在，则创建</span>
PUT /<span class="token operator">&lt;</span>index<span class="token operator">&gt;</span>/_doc/<span class="token operator">&lt;</span>_id<span class="token operator">&gt;</span>
<span class="token punctuation">{</span>
  <span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;zhangsan11111&quot;</span>,
  <span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span> <span class="token number">13</span>,
  <span class="token string">&quot;mail&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;11111@qq.com&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>若指定的 ID 值所在 Document 不存在，则创建</li> <li>删除并重新添加，指定同一 ID，Field 数量可能改变</li></ul> <h3 id="修改（局部修改）🔥"><a href="#修改（局部修改）🔥" class="header-anchor">#</a> 修改（局部修改）🔥</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>POST /<span class="token operator">&lt;</span>index<span class="token operator">&gt;</span>/_update/<span class="token operator">&lt;</span>_id<span class="token operator">&gt;</span>
<span class="token punctuation">{</span>
  <span class="token string">&quot;doc&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;3232322&quot;</span>,
    <span class="token string">&quot;age&quot;</span><span class="token builtin class-name">:</span> <span class="token number">13</span>,
    <span class="token string">&quot;mail&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;11111@qq.com&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>当检测到 <strong>Document没有改变时，则 version 不会加一</strong></li></ul> <h3 id="删除"><a href="#删除" class="header-anchor">#</a> 删除</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>DELETE /<span class="token operator">&lt;</span>index<span class="token operator">&gt;</span>/_doc/<span class="token operator">&lt;</span>_id<span class="token operator">&gt;</span>
</code></pre></div><h2 id="cat-查询"><a href="#cat-查询" class="header-anchor">#</a> _cat 查询</h2> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 查询所有 Index</span>
GET /_cat/indices

<span class="token comment">#==================================================================================================</span>
green <span class="token function">open</span> movies                       ILYU9p8_TF-zQ0Dhv6g2lg <span class="token number">1</span> <span class="token number">1</span> <span class="token number">9743</span> <span class="token number">0</span>  <span class="token number">2</span>.7mb    <span class="token number">1</span>.3mb
green <span class="token function">open</span> kibana_sample_data_ecommerce e7UYtIrwTCueNbynAYtzKw <span class="token number">1</span> <span class="token number">1</span> <span class="token number">4675</span> <span class="token number">0</span>  <span class="token number">9</span>.6mb    <span class="token number">4</span>.8mb
green <span class="token function">open</span> .kibana_task_manager_1       GKq_Aw38S_2Ds3A69S-OGQ <span class="token number">1</span> <span class="token number">1</span>    <span class="token number">2</span> <span class="token number">1</span> <span class="token number">17</span>.9kb   <span class="token number">10</span>.8kb
green <span class="token function">open</span> my_index                     yIAGPwWLSbi24XluT-hQ5w <span class="token number">1</span> <span class="token number">0</span>    <span class="token number">0</span> <span class="token number">0</span>   283b     283b
green <span class="token function">open</span> itcast                       YmdieZ30TNOiScO83pRF2g <span class="token number">1</span> <span class="token number">1</span>    <span class="token number">2</span> <span class="token number">2</span> <span class="token number">18</span>.5kb    <span class="token number">7</span>.3kb
green <span class="token function">open</span> .apm-agent-configuration     2wojrVAESi6IBQC1ljromQ <span class="token number">1</span> <span class="token number">1</span>    <span class="token number">0</span> <span class="token number">0</span>   566b     283b
green <span class="token function">open</span> .kibana_1                    wzLuski5Q7CFPUnSNhia2A <span class="token number">1</span> <span class="token number">1</span>   <span class="token number">74</span> <span class="token number">8</span>  <span class="token number">1</span>.9mb <span class="token number">1003</span>.4kb
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 根据 Index name 查询</span>
GET /_cat/indices/<span class="token operator">&lt;</span>index<span class="token operator">&gt;</span>

<span class="token comment">#==================================================================================================</span>
green <span class="token function">open</span> my_index yIAGPwWLSbi24XluT-hQ5w <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> 283b 283b
</code></pre></div><h2 id="reindex-alias-迁移数据"><a href="#reindex-alias-迁移数据" class="header-anchor">#</a> Reindex &amp; alias 迁移数据</h2> <p>Reindex：</p> <ul><li><p>将文档从一个索引复制到另一个索引。</p></li> <li><p>Reindex 要求为源索引中的所有文档启用 <code>_source</code>。</p></li> <li><p>您必须在调用<code>_reindex</code><strong>之前设置目标索引</strong>。 重新索引不会从源索引复制设置。 映射，分片计数，副本等必须提前配置。</p></li></ul> <p>alias：</p> <ul><li>通过 alias 来切换索引，因为 alias 中的多条命令是原子性</li></ul> <p>步骤：</p> <ul><li><p>查询 source index，据此修改</p> <div class="language-bash extra-class"><pre class="language-bash"><code>GET /<span class="token operator">&lt;</span>index<span class="token operator">&gt;</span>
</code></pre></div></li> <li><p>创建 dest index（7.0 后和 7.0 之前有些许区别，自己查文档）</p> <div class="language-bash extra-class"><pre class="language-bash"><code>PUT /<span class="token operator">&lt;</span>index<span class="token operator">&gt;</span>
<span class="token punctuation">{</span>
  <span class="token string">&quot;settings&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;index&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;number_of_shards&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;1&quot;</span>,
      <span class="token string">&quot;number_of_replicas&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;0&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>,
  <span class="token string">&quot;properties&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;docContent&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;analyzer&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;ik_max_word&quot;</span>,
      <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;text&quot;</span>
    <span class="token punctuation">}</span>,
    <span class="token string">&quot;docName&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;analyzer&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;ik_max_word&quot;</span>,
      <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;text&quot;</span>
    <span class="token punctuation">}</span>,
    <span class="token string">&quot;fuseEeason&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;analyzer&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;ik_max_word&quot;</span>,
      <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;text&quot;</span>
    <span class="token punctuation">}</span>,
    <span class="token string">&quot;appliedScope&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;analyzer&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;ik_max_word&quot;</span>,
      <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;text&quot;</span>
    <span class="token punctuation">}</span>,
    <span class="token string">&quot;docNumber&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;analyzer&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;ik_max_word&quot;</span>,
      <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;text&quot;</span>
    <span class="token punctuation">}</span>,
    <span class="token string">&quot;exeDate&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;analyzer&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;ik_max_word&quot;</span>,
      <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;text&quot;</span>
    <span class="token punctuation">}</span>,
    <span class="token string">&quot;departName&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;analyzer&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;ik_max_word&quot;</span>,
      <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;text&quot;</span>
    <span class="token punctuation">}</span>,
    <span class="token string">&quot;fileSuffix&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;text&quot;</span>
    <span class="token punctuation">}</span>,
    <span class="token string">&quot;favType&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;text&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>_reindex 复制索引数据</p> <div class="language-bash extra-class"><pre class="language-bash"><code>POST _reindex
<span class="token punctuation">{</span>
  <span class="token string">&quot;source&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;index&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;index-v1&quot;</span>
  <span class="token punctuation">}</span>,
  <span class="token string">&quot;dest&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;index&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;index-v2&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>alias 切换，之后查询的索引还是 index（别名）</p> <div class="language-bash extra-class"><pre class="language-bash"><code>POST _aliases
<span class="token punctuation">{</span>
  <span class="token string">&quot;actions&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token string">&quot;add&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;index&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;index_v2&quot;</span>,
        <span class="token string">&quot;alias&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;index&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>,
    <span class="token punctuation">{</span>
      <span class="token string">&quot;remove_index&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;index&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;index&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/apple54whn/notes/edit/master/docs/DataBase/Elasticsearch/4 Index &amp; Document.md" target="_blank" rel="noopener noreferrer">编辑文档！</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次更新时间:</span> <span class="time">5/11/2020, 5:18:15 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/DataBase/Elasticsearch/3 插件.html" class="prev">插件</a></span> <span class="next"><a href="/DataBase/Elasticsearch/5 搜索.html">搜索</a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.4c2406b8.js" defer></script><script src="/assets/js/2.4ce794f3.js" defer></script><script src="/assets/js/35.07031e68.js" defer></script><script src="/assets/js/33.9b523a1b.js" defer></script>
  </body>
</html>
