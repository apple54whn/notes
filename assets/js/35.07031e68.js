(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{232:function(s,t,a){s.exports=a.p+"assets/img/image-20200420003109861.efa6d206.png"},233:function(s,t,a){s.exports=a.p+"assets/img/1551547245658.81dc0a5d.png"},436:function(s,t,a){"use strict";a.r(t);var n=a(2),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"index-document"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#index-document"}},[s._v("#")]),s._v(" Index & Document")]),s._v(" "),n("p",[s._v("ES 作为一个索引及搜索服务，对外提供丰富的 RESTful 接口。如下示例使用 Kibana 操作，PostMan 同理。")]),s._v(" "),n("h2",{attrs:{id:"dev-和-ops-视角"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dev-和-ops-视角"}},[s._v("#")]),s._v(" Dev 和 Ops 视角")]),s._v(" "),n("p",[n("img",{attrs:{src:a(232),alt:"image-20200420003109861"}})]),s._v(" "),n("ul",[n("li",[n("p",[s._v("Index 索引")]),s._v(" "),n("ul",[n("li",[n("s",[s._v("Type 类型")])]),s._v(" "),n("li",[s._v("Document 文档")])])]),s._v(" "),n("li",[n("p",[s._v("Node 节点")]),s._v(" "),n("ul",[n("li",[s._v("Shard 分片")])])])]),s._v(" "),n("h2",{attrs:{id:"index"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#index"}},[s._v("#")]),s._v(" Index")]),s._v(" "),n("ul",[n("li",[s._v("Index 是 "),n("strong",[s._v("Document 的容器")]),s._v("，是"),n("strong",[s._v("同一类（7.0 之后只允许为"),n("code",[s._v("_doc")]),s._v("） Document 的集合")]),s._v("。")]),s._v(" "),n("li",[s._v("Index 体现了"),n("strong",[s._v("逻辑")]),s._v("空间的概念，与 Node 体现物理空间不同")]),s._v(" "),n("li",[s._v("Index 就相当于 RDBMS 中的"),n("strong",[s._v("表")]),s._v("，或相当于 Mongodb 中的"),n("strong",[s._v("集合")])]),s._v(" "),n("li",[s._v("Index 包括了"),n("strong",[s._v("分词列表")]),s._v("及"),n("strong",[s._v("文档列表")])]),s._v(" "),n("li",[s._v("每个 Index 都有自己的 "),n("strong",[s._v("mapping")]),s._v(" 定义，用于定义包含的 "),n("strong",[s._v("Document 的 Field 名称 和 Field 类型")]),s._v("。不定义 mapping 直接插入 Document 时 ES 会自动判断 Field 类型并生成。setting 同理也会自动生成。")])]),s._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("思考")]),s._v(" "),n("p",[s._v("创建索引库相当于关系数据库中的数据库还是表？")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("如果相当于"),n("strong",[s._v("数据库")]),s._v("就表示一个索引库可以创建很多不同类型的文档，这在ES中也是允许的（但是 7.0 之后不允许！）")])]),s._v(" "),n("li",[n("p",[s._v("如果相当于"),n("strong",[s._v("表")]),s._v("就表示一个索引库只能存储相同类型的文档，ES官方"),n("strong",[s._v("建议")]),s._v("在一个索引库中只存"),n("strong",[s._v("储相同类型的文档")])]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",{staticStyle:{"text-align":"center"}},[s._v("RDBMS")]),s._v(" "),n("th",{staticStyle:{"text-align":"center"}},[s._v("ES")])])]),s._v(" "),n("tbody",[n("tr",[n("td",{staticStyle:{"text-align":"center"}},[s._v("Table")]),s._v(" "),n("td",{staticStyle:{"text-align":"center"}},[s._v("Index（Type）")])]),s._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[s._v("Row")]),s._v(" "),n("td",{staticStyle:{"text-align":"center"}},[s._v("Document")])]),s._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[s._v("Column")]),s._v(" "),n("td",{staticStyle:{"text-align":"center"}},[s._v("Field")])]),s._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[s._v("Schema")]),s._v(" "),n("td",{staticStyle:{"text-align":"center"}},[s._v("Mapping")])]),s._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[s._v("SQL")]),s._v(" "),n("td",{staticStyle:{"text-align":"center"}},[s._v("DSL")])])])])])])]),s._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("Index 的不同语义")]),s._v(" "),n("p",[s._v("Indexing （动词）Document 到 ES 的 Index（名词）中")]),s._v(" "),n("ul",[n("li",[s._v("名词：一个 ES 集群中，可以创建很多个不同的 Index")]),s._v(" "),n("li",[s._v("动词：保存一个 Document 到 ES 的过程也称作 Indexing（ES 创建一个倒排 Index 的过程）")]),s._v(" "),n("li",[s._v("名词：一个 B 树 Index，一个倒排 Index")])])]),s._v(" "),n("h3",{attrs:{id:"查询"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#查询"}},[s._v("#")]),s._v(" 查询")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询 index 的信息，包括 setting 和 mapping")]),s._v("\nGET /"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("index"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),n("h3",{attrs:{id:"创建"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建"}},[s._v("#")]),s._v(" 创建")]),s._v(" "),n("p",[s._v("综合 setting 和 mapping")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("PUT /"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("index"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"settings"')]),s._v(":"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index"')]),s._v(":"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"number_of_shards"')]),s._v(":1,\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"number_of_replicas"')]),s._v(":0\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"properties"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"description"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v(",\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"analyzer"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_max_word"')]),s._v(",\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"search_analyzer"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_smart"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v(",\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"analyzer"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_max_word"')]),s._v(",\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"search_analyzer"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_smart"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pic"')]),s._v(":"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v(",\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index"')]),s._v(":false\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"price"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"float"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"studymodel"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"keyword"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"timestamp"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"date"')]),s._v(",\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"format"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yyyy‐MM‐dd HH:mm:ss||yyyy‐MM‐dd||epoch_millis"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),n("h3",{attrs:{id:"只可删除-index"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#只可删除-index"}},[s._v("#")]),s._v(" 只可删除 index")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("DELETE /"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("index"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),n("p",[s._v("删除 Index 的同时会删除该 Index 下的所有 setting、mapping 和 Document")]),s._v(" "),n("h3",{attrs:{id:"无法修改，只能迁移数据"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#无法修改，只能迁移数据"}},[s._v("#")]),s._v(" 无法修改，只能迁移数据")]),s._v(" "),n("p",[s._v("映射创建成功可以"),n("strong",[s._v("添加新字段")]),s._v("，"),n("strong",[s._v("已有字段不允许更新 type")])]),s._v(" "),n("h2",{attrs:{id:"setting"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#setting"}},[s._v("#")]),s._v(" setting")]),s._v(" "),n("p",[s._v("setting 定义了不同的数据分布（索引的分片，副本）")]),s._v(" "),n("h3",{attrs:{id:"查询-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#查询-2"}},[s._v("#")]),s._v(" 查询")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("GET /"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("index"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/_settings\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询所有 index 的 setting")]),s._v("\nGET /_settings\n")])])]),n("h3",{attrs:{id:"创建-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建-2"}},[s._v("#")]),s._v(" 创建")]),s._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),n("p",[s._v("使用 PUT 是由于"),n("strong",[s._v("幂等")]),s._v("；不能使用 POST 是由于"),n("strong",[s._v("非幂等")]),s._v("且 POST "),n("strong",[s._v("默认会添加 Document")]),s._v("，同时设置 setting 和 mapping")])]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("PUT /"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("index"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"settings"')]),s._v(":"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index"')]),s._v(":"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"number_of_shards"')]),s._v(":1,\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"number_of_replicas"')]),s._v(":0\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),n("ul",[n("li",[n("p",[n("code",[s._v("number_of_shards")]),s._v("：设置"),n("strong",[s._v("分片的数量")]),s._v("，在集群中通常设置多个分片，表示一个索引库将拆分成多片分别存储不同的结点，提高了ES的处理能力和高可用性，入门程序使用单机环境，这里设置为1。")])]),s._v(" "),n("li",[n("p",[n("code",[s._v("number_of_replicas")]),s._v("：设置"),n("strong",[s._v("副本")]),s._v("的数量，设置副本是为了提高 ES 的高可靠性，单机环境设置为0。")])])]),s._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),n("p",[s._v("ES6.0 之前的版本有 Type（类型）概念，相当于关系数据库的表，ES 官方将在 ES9.0 版本中彻底删除 Type")])]),s._v(" "),n("h3",{attrs:{id:"只可删除-index-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#只可删除-index-2"}},[s._v("#")]),s._v(" 只可删除 index")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("DELETE /"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("index"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),n("p",[s._v("删除 Index 的同时会删除该 Index 下的所有 setting、mapping 和 Document")]),s._v(" "),n("h3",{attrs:{id:"无法修改，只能迁移数据-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#无法修改，只能迁移数据-2"}},[s._v("#")]),s._v(" 无法修改，只能迁移数据")]),s._v(" "),n("h2",{attrs:{id:"mapping"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mapping"}},[s._v("#")]),s._v(" mapping")]),s._v(" "),n("p",[s._v("在 Index 中每个 Document 都包括了一个或多个 Field，创建 mapping 就是向"),n("strong",[s._v("Index（索引库）"),n("strong",[s._v("中")]),s._v("创建 Field")]),s._v(" 并指定 "),n("strong",[s._v("Field 类型")]),s._v("的过程。虽然 ES 会根据 Document 自动设置类型，但是有些 Field 需要自己手动设置！")]),s._v(" "),n("h3",{attrs:{id:"查询-3"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#查询-3"}},[s._v("#")]),s._v(" 查询")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("GET /"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("index"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/_mapping\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询所有 index 的 mapping")]),s._v("\nGET /_mapping\n")])])]),n("h3",{attrs:{id:"创建-3"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建-3"}},[s._v("#")]),s._v(" 创建")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建 Index 的 mapping")]),s._v("\nPUT /"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("index"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mappings"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"properties"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"age"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"integer"')]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mail"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"keyword"')]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hobby"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v(",\n                "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"analyzer"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_max_word"')]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),n("h3",{attrs:{id:"添加新字段"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#添加新字段"}},[s._v("#")]),s._v(" 添加新字段")]),s._v(" "),n("p",[s._v("映射创建成功后可以"),n("strong",[s._v("添加新字段")])]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("PUT /"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("index"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/_mapping/_doc\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"properties"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sex"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t\t"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v("\n\t\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),n("h3",{attrs:{id:"已有字段不允许更新-field"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#已有字段不允许更新-field"}},[s._v("#")]),s._v(" 已有字段不允许更新 Field")]),s._v(" "),n("p",[s._v("可以迁移数据，使用 Reindex 和 alias 完成")]),s._v(" "),n("h3",{attrs:{id:"只可删除-index-3"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#只可删除-index-3"}},[s._v("#")]),s._v(" 只可删除 index")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("DELETE /"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("index"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),n("p",[s._v("删除 Index 的同时会删除该 Index 下的所有 setting、mapping 和 Document")]),s._v(" "),n("h2",{attrs:{id:"常用映射类型"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#常用映射类型"}},[s._v("#")]),s._v(" 常用映射类型")]),s._v(" "),n("h3",{attrs:{id:"字符串—text"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#字符串—text"}},[s._v("#")]),s._v(" 字符串—text")]),s._v(" "),n("ul",[n("li",[n("p",[n("strong",[s._v("index")])]),s._v(" "),n("p",[s._v("通过index属性指定"),n("strong",[s._v("是否索引")]),s._v("，"),n("strong",[s._v("默认为index=true")]),s._v("，即要进行索引，只有进行索引才可以从索引库搜索到。")]),s._v(" "),n("p",[s._v("但是也有一些内容不需要索引，比如：商品图片地址只被用来展示图片，不进行搜索图片，此时可以将index设置为false")])]),s._v(" "),n("li",[n("p",[n("strong",[s._v("analyzer")])]),s._v(" "),n("p",[s._v("通过analyzer属性指定分词器。下边指定name的字段类型为text，使用ik分词器的ik_max_word分词模式。")]),s._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"analyzer"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_max_word"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])])]),s._v(" "),n("li",[n("p",[n("strong",[s._v("search_analyzer")])]),s._v(" "),n("p",[s._v("上边指定了analyzer是指在索引和搜索都使用ik_max_word，如果"),n("strong",[s._v("单独")]),s._v("想定义"),n("strong",[s._v("搜索时使用的分词器")]),s._v("则可以通过该属性")]),s._v(" "),n("p",[s._v("对于ik分词器建议是"),n("strong",[s._v("索引")]),s._v("时使用**"),n("code",[s._v("ik_max_word")]),n("strong",[s._v("将搜索内容进行细粒度分词，"),n("strong",[s._v("搜索")]),s._v("时使用")]),n("code",[s._v("ik_smart")]),s._v("**提高搜索精确性")]),s._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"analyzer"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_max_word"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"search_analyzer"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_smart"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])])]),s._v(" "),n("li",[n("p",[n("strong",[s._v("store")])]),s._v(" "),n("p",[s._v('是否在source之外存储，默认为false。每个文档索引后会在 ES中保存一份原始文档，存放在"'),n("code",[s._v("_source")]),s._v('"中，一般情况下不需要设置store为true，因为在_source中已经有一份原始文档了。')])])]),s._v(" "),n("p",[s._v("测试")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("手动删除xc_course/doc下的映射，即删除索引库，创建索引库")])]),s._v(" "),n("li",[n("p",[s._v("创建新映射："),n("code",[s._v("Post http://localhost:9200/xc_course/doc/_mapping")])]),s._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"properties"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"analyzer"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_max_word"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"search_analyzer"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_smart"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"description"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"analyzer"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_max_word"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"search_analyzer"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_smart"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"pic"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"index"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"studymodel"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])])]),s._v(" "),n("li",[n("p",[s._v("插入文档："),n("code",[s._v("post http://localhost:9200/xc_course/doc/4028e58161bcf7f40161bcf8b77c0000")])]),s._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Bootstrap开发框架"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"description"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Bootstrap是由Twitter推出的一个前台页面开发框架，在行业之中使用较为广泛。此开发框架包含了大量的CSS、JS程序代码，可以帮助开发者（尤其是不擅长页面开发的程序人员）轻松的实现一个不受浏览器限制的精美界面效果。"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"pic"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"group1/M00/00/01/wKhlQFqO4MmAOP53AAAcwDwm6SU490.jpg"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"studymodel"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"201002"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])])]),s._v(" "),n("li",[n("p",[s._v("查询测试：")]),s._v(" "),n("ul",[n("li",[n("code",[s._v("Get http://localhost:9200/xc_course/_search?q=name:java开发")]),s._v("。也能搜到，会先搜索分词")]),s._v(" "),n("li",[n("code",[s._v("Get http://localhost:9200/xc_course/_search?q=description:开发")])]),s._v(" "),n("li",[n("code",[s._v("Get http://localhost:9200/xc_course/_search? q=pic:group1/M00/00/01/wKhlQFqO4MmAOP53AAAcwDwm6SU490.jpg")])]),s._v(" "),n("li",[n("code",[s._v("Get http://localhost:9200/xc_course/_search?q=studymodel:201002")])])]),s._v(" "),n("p",[s._v("【结论】name、description和studymodel都支持全文检索，pic不可作为查询条件")])])]),s._v(" "),n("h3",{attrs:{id:"字符串—keyword"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#字符串—keyword"}},[s._v("#")]),s._v(" 字符串—keyword")]),s._v(" "),n("p",[s._v("上边介绍的text文本字段在映射时要设置分词器，keyword字段为关键字字段，通常搜索keyword按照"),n("strong",[s._v("整体搜索精确匹配")]),s._v("，所以创建keyword字段的索引时是"),n("strong",[s._v("不进行分词")]),s._v("的，比如：邮政编码、手机号码、身份证等。keyword字段通常用于"),n("strong",[s._v("过虑、排序、聚合")]),s._v("等")]),s._v(" "),n("p",[s._v("测试：")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("手动删除xc_course/doc下的映射，即删除索引库，创建索引库")])]),s._v(" "),n("li",[n("p",[s._v("创建新映射："),n("code",[s._v("Post http://localhost:9200/xc_course/doc/_mapping")])]),s._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"properties"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"keyword"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"description"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"analyzer"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_max_word"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"search_analyzer"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_smart"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"pic"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"index"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"studymodel"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"keyword"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])])]),s._v(" "),n("li",[n("p",[s._v("插入文档："),n("code",[s._v("post http://localhost:9200/xc_course/doc/4028e58161bcf7f40161bcf8b77c0000")])]),s._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"java编程基础"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"description"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"java语言是世界第一编程语言，在软件开发领域使用人数最多。"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"pic"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"group1/M00/00/01/wKhlQFqO4MmAOP53AAAcwDwm6SU490.jpg"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"studymodel"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"201001"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])])]),s._v(" "),n("li",[n("p",[s._v("根据studymodel查询文档："),n("code",[s._v("get http://localhost:9200/xc_course/_search?q=name:java")])]),s._v(" "),n("p",[s._v("name是keyword类型，所以查询方式是精确查询，全部匹配！！！")])])]),s._v(" "),n("h3",{attrs:{id:"数值类型"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#数值类型"}},[s._v("#")]),s._v(" 数值类型")]),s._v(" "),n("p",[s._v("下边是ES支持的数值类型")]),s._v(" "),n("p",[n("img",{attrs:{src:a(233),alt:"1551547245658"}})]),s._v(" "),n("ul",[n("li",[n("p",[s._v("尽量选择"),n("strong",[s._v("范围小")]),s._v("的类型，提高搜索效率（比如long类型别乱选）")])]),s._v(" "),n("li",[n("p",[s._v("对于"),n("strong",[s._v("浮点数")]),s._v("尽量用"),n("strong",[s._v("比例因子")]),s._v("，比如一个价格字段，单位为元，我们将比例因子设置为100这在ES中会按分存储，映射如下：")]),s._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"price"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"scaled_float"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scaling_factor"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n")])])]),n("p",[s._v("由于比例因子为100，如果我们输入的价格是23.45则ES中会将23.45乘以100存储在ES中")]),s._v(" "),n("p",[s._v("如果输入的价格是23.456，ES会将23.456乘以100再取一个接近原始值的数，得出2346")]),s._v(" "),n("p",[s._v("使用比例因子的好处是"),n("strong",[s._v("整型比浮点型更易压缩")]),s._v("，"),n("strong",[s._v("节省磁盘空间")])]),s._v(" "),n("p",[s._v("如果比例因子不适合，则从下表选择范围小的去用：")]),s._v(" "),n("p",[n("img",{attrs:{src:"images/1551547392387.png",alt:"1551547392387"}})])])]),s._v(" "),n("h3",{attrs:{id:"te-布尔值"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#te-布尔值"}},[s._v("#")]),s._v(" te 布尔值")]),s._v(" "),n("ul",[n("li",[s._v("boolean")])]),s._v(" "),n("h3",{attrs:{id:"date"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#date"}},[s._v("#")]),s._v(" date")]),s._v(" "),n("p",[s._v("日期类型不用设置分词器。通常用于"),n("strong",[s._v("排序")]),s._v("。")]),s._v(" "),n("ul",[n("li",[s._v("format：设置日期格式")])]),s._v(" "),n("p",[s._v("测试")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("下边的设置允许date字段存储年月日时分秒、年月日及毫秒三种格式：")]),s._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"properties"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"timestamp"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"date"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"format"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yyyy‐MM‐dd HH:mm:ss||yyyy‐MM‐dd"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])])]),s._v(" "),n("li",[n("p",[s._v("插入文档："),n("code",[s._v("Post http://localhost:9200/xc_course/doc/3")])]),s._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"spring开发基础"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"description"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"spring 在java领域非常流行，java程序员都在用。"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"studymodel"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"201001"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"pic"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"group1/M00/00/01/wKhlQFqO4MmAOP53AAAcwDwm6SU490.jpg"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"timestamp"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2018‐07‐04 18:28:58"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])])])]),s._v(" "),n("h3",{attrs:{id:"二进制"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#二进制"}},[s._v("#")]),s._v(" 二进制")]),s._v(" "),n("ul",[n("li",[s._v("binary")])]),s._v(" "),n("h3",{attrs:{id:"综合例子"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#综合例子"}},[s._v("#")]),s._v(" 综合例子")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("PUT /"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("index"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/_doc/_mapping\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"properties"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"description"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v(",\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"analyzer"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_max_word"')]),s._v(",\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"search_analyzer"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_smart"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v(",\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"analyzer"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_max_word"')]),s._v(",\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"search_analyzer"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_smart"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pic"')]),s._v(":"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v(",\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index"')]),s._v(":false\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"price"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"float"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"studymodel"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"keyword"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"timestamp"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"date"')]),s._v(",\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"format"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yyyy‐MM‐dd HH:mm:ss||yyyy‐MM‐dd||epoch_millis"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),n("h2",{attrs:{id:"type"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#type"}},[s._v("#")]),s._v(" "),n("s",[s._v("Type")])]),s._v(" "),n("ul",[n("li",[s._v("在 7.0 之前，一个 Index 可以设置多个 Types")]),s._v(" "),n("li",[s._v("6.0 开始，Type 已经被 Deprecated。7.0 开始一个 Index 只能创建一个 Type："),n("code",[s._v("_doc")])])]),s._v(" "),n("h2",{attrs:{id:"document"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#document"}},[s._v("#")]),s._v(" Document")]),s._v(" "),n("ul",[n("li",[s._v("ES 是"),n("strong",[s._v("面向 Document 的")]),s._v("，Document 是所有"),n("strong",[s._v("可搜索数据的最小单位")]),s._v(" "),n("ul",[n("li",[s._v("日志文件中的日志项")]),s._v(" "),n("li",[s._v("一本电影的具体信息；一张唱片的详细信息")]),s._v(" "),n("li",[s._v("MP3 播放器里的一首歌；一篇 PDF 文档中的具体内容")])])]),s._v(" "),n("li",[s._v("一篇 Documemt 包含了一系列的 Field，类似数据库中表的一条记录")]),s._v(" "),n("li",[n("strong",[s._v("Document 会被序列化成 JSON，保存")]),s._v("在 ES 中\n"),n("ul",[n("li",[n("strong",[s._v("JSON 对象由 Field 组成")])]),s._v(" "),n("li",[s._v("每个 Field 都有对应的类型（字符串、数值、布尔、日期、二进制、范围类型）")])])]),s._v(" "),n("li",[n("strong",[s._v("每个 Document 都有一个 Unique ID")]),s._v(" "),n("ul",[n("li",[s._v("可以自己指定 ID")]),s._v(" "),n("li",[s._v("可以通过 ES 自动生成，32 位长度字符串")])])])]),s._v(" "),n("h3",{attrs:{id:"元数据"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#元数据"}},[s._v("#")]),s._v(" 元数据")]),s._v(" "),n("p",[s._v("每一篇 Document 都有元数据，用于标注 Document 的相关信息")]),s._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"_index"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"movies"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"_type"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_doc"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"_id"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2665"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"_version"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"_score"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"_source"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"@version"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"title"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Earth vs. the Flying Saucers"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"genre"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Sci-Fi"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"year"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1956")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"id"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2665"')]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),n("ul",[n("li",[s._v("_index：Document 所属的 Index 名")]),s._v(" "),n("li",[s._v("_type：Document 所属的 Type 名")]),s._v(" "),n("li",[s._v("_id：文档的唯一 ID")]),s._v(" "),n("li",[s._v("_version：Document 的版本信息，每次修改都会加一")]),s._v(" "),n("li",[s._v("_score：相关性打分")]),s._v(" "),n("li",[s._v("_source：文档的原始 JSON 数据")]),s._v(" "),n("li",[n("s",[s._v("_all：整合所有 Field 内容到该字段。已被废除")])])]),s._v(" "),n("h3",{attrs:{id:"创建-4"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建-4"}},[s._v("#")]),s._v(" 创建")]),s._v(" "),n("p",[s._v("ES 中的文档相当于 RDBMS 中的一条"),n("strong",[s._v("记录")])]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建，如果不指定 id 值 ES 会自动生成ID（不推荐，影响 RESTful 语义）")]),s._v("\nPOST /"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("index"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/_doc\nPOST /"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("index"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/_doc/"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nPOST /"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("index"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/_create/"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"zhangsan11111"')]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"age"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mail"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"11111@qq.com"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),n("ul",[n("li",[s._v("若不指定 ID 值 ES 会自动生成 ID")]),s._v(" "),n("li",[n("strong",[s._v("若 ID 已存在，则修改")]),s._v("，且根据提供的数据修改，没有的 Field 则删除掉。不推荐，影响 RESTful 语义")])]),s._v(" "),n("h3",{attrs:{id:"修改（覆盖）"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#修改（覆盖）"}},[s._v("#")]),s._v(" 修改（覆盖）")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改（全修改），若 ID 所在 Document 不存在，则创建")]),s._v("\nPUT /"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("index"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/_doc/"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"zhangsan11111"')]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"age"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mail"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"11111@qq.com"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),n("ul",[n("li",[s._v("若指定的 ID 值所在 Document 不存在，则创建")]),s._v(" "),n("li",[s._v("删除并重新添加，指定同一 ID，Field 数量可能改变")])]),s._v(" "),n("h3",{attrs:{id:"修改（局部修改）🔥"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#修改（局部修改）🔥"}},[s._v("#")]),s._v(" 修改（局部修改）🔥")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("POST /"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("index"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/_update/"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"doc"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3232322"')]),s._v(",\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"age"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(",\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mail"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"11111@qq.com"')]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),n("ul",[n("li",[s._v("当检测到 "),n("strong",[s._v("Document没有改变时，则 version 不会加一")])])]),s._v(" "),n("h3",{attrs:{id:"删除"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#删除"}},[s._v("#")]),s._v(" 删除")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("DELETE /"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("index"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/_doc/"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),n("h2",{attrs:{id:"cat-查询"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#cat-查询"}},[s._v("#")]),s._v(" _cat 查询")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询所有 Index")]),s._v("\nGET /_cat/indices\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#==================================================================================================")]),s._v("\ngreen "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),s._v(" movies                       ILYU9p8_TF-zQ0Dhv6g2lg "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9743")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".7mb    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".3mb\ngreen "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),s._v(" kibana_sample_data_ecommerce e7UYtIrwTCueNbynAYtzKw "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4675")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(".6mb    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(".8mb\ngreen "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),s._v(" .kibana_task_manager_1       GKq_Aw38S_2Ds3A69S-OGQ "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(".9kb   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(".8kb\ngreen "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),s._v(" my_index                     yIAGPwWLSbi24XluT-hQ5w "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("   283b     283b\ngreen "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),s._v(" itcast                       YmdieZ30TNOiScO83pRF2g "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(".5kb    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".3kb\ngreen "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),s._v(" .apm-agent-configuration     2wojrVAESi6IBQC1ljromQ "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("    "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("   566b     283b\ngreen "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),s._v(" .kibana_1                    wzLuski5Q7CFPUnSNhia2A "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("74")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".9mb "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1003")]),s._v(".4kb\n")])])]),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 根据 Index name 查询")]),s._v("\nGET /_cat/indices/"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("index"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#==================================================================================================")]),s._v("\ngreen "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),s._v(" my_index yIAGPwWLSbi24XluT-hQ5w "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" 283b 283b\n")])])]),n("h2",{attrs:{id:"reindex-alias-迁移数据"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#reindex-alias-迁移数据"}},[s._v("#")]),s._v(" Reindex & alias 迁移数据")]),s._v(" "),n("p",[s._v("Reindex：")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("将文档从一个索引复制到另一个索引。")])]),s._v(" "),n("li",[n("p",[s._v("Reindex 要求为源索引中的所有文档启用 "),n("code",[s._v("_source")]),s._v("。")])]),s._v(" "),n("li",[n("p",[s._v("您必须在调用"),n("code",[s._v("_reindex")]),n("strong",[s._v("之前设置目标索引")]),s._v("。 重新索引不会从源索引复制设置。 映射，分片计数，副本等必须提前配置。")])])]),s._v(" "),n("p",[s._v("alias：")]),s._v(" "),n("ul",[n("li",[s._v("通过 alias 来切换索引，因为 alias 中的多条命令是原子性")])]),s._v(" "),n("p",[s._v("步骤：")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("查询 source index，据此修改")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("GET /"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("index"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])])]),s._v(" "),n("li",[n("p",[s._v("创建 dest index（7.0 后和 7.0 之前有些许区别，自己查文档）")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("PUT /"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("index"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"settings"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"number_of_shards"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),s._v(",\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"number_of_replicas"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"properties"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"docContent"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"analyzer"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_max_word"')]),s._v(",\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"docName"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"analyzer"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_max_word"')]),s._v(",\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fuseEeason"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"analyzer"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_max_word"')]),s._v(",\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"appliedScope"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"analyzer"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_max_word"')]),s._v(",\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"docNumber"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"analyzer"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_max_word"')]),s._v(",\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"exeDate"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"analyzer"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_max_word"')]),s._v(",\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"departName"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"analyzer"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_max_word"')]),s._v(",\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fileSuffix"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"favType"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])])]),s._v(" "),n("li",[n("p",[s._v("_reindex 复制索引数据")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("POST _reindex\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"source"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index-v1"')]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dest"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index-v2"')]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])])]),s._v(" "),n("li",[n("p",[s._v("alias 切换，之后查询的索引还是 index（别名）")]),s._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("POST _aliases\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"actions"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"add"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index_v2"')]),s._v(",\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"alias"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"remove_index"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])])])])])}),[],!1,null,null,null);t.default=e.exports}}]);