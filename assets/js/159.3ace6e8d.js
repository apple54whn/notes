(window.webpackJsonp=window.webpackJsonp||[]).push([[159],{563:function(t,e,s){"use strict";s.r(e);var a=s(2),n=Object(a.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"_2-listener"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-listener"}},[t._v("#")]),t._v(" 2 Listener")]),t._v(" "),s("blockquote",[s("p",[t._v("web的三大组件之一")])]),t._v(" "),s("h2",{attrs:{id:"事件监听机制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#事件监听机制"}},[t._v("#")]),t._v(" 事件监听机制")]),t._v(" "),s("ul",[s("li",[t._v("事件源（被监听对象）：小偷")]),t._v(" "),s("li",[t._v("事件（事件源行为）：偷东西")]),t._v(" "),s("li",[t._v("监听器（用于监听事件源的对象）：警察，监听器中的方法：抓捕\n"),s("ul",[s("li",[t._v("它是一个"),s("strong",[t._v("接口")]),t._v("，内容由我们来实现")]),t._v(" "),s("li",[t._v("它需要"),s("strong",[t._v("注册")]),t._v("，例如注册在按钮上")]),t._v(" "),s("li",[t._v("监听器中的方法，会在特殊"),s("strong",[t._v("事件发生时被调用")])])])]),t._v(" "),s("li",[t._v("注册监听：将事件、事件源、监听器绑定在一起。 当事件源上发生某个事件后，执行监听器中的方法")])]),t._v(" "),s("h2",{attrs:{id:"编写-listener"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#编写-listener"}},[t._v("#")]),t._v(" 编写 Listener")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Java Web中完成编写监听器（以后写监听器机会很少！）")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("写一个监听器类(实现某个监听器接口)，重写方法")])]),t._v(" "),s("li",[s("p",[t._v("注册，即配置。")])]),t._v(" "),s("li",[s("p",[t._v("可以通过"),s("code",[t._v("getInitParameter()")]),t._v("获取初始化参数，加载资源文件")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("注解："),s("code",[t._v("@WebListener")])])]),t._v(" "),s("li",[s("p",[t._v("web.xml")]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("listener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("listener-class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("cn.itcast.web.listener.ContextLoaderListener"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("listener-class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("listener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!--还可以指定初始化参数--\x3e")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("context-param")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("param-name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("contextConfig"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("param-name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("param-value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("/WEB-INF/classes/prop.xml"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("param-value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("context-param")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])])])])])])])]),t._v(" "),s("h2",{attrs:{id:"java-web中8个监听器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#java-web中8个监听器"}},[t._v("#")]),t._v(" Java Web中8个监听器")]),t._v(" "),s("h3",{attrs:{id:"监听-servletcontext"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#监听-servletcontext"}},[t._v("#")]),t._v(" 监听 ServletContext")]),t._v(" "),s("ul",[s("li",[t._v("生命周期监听："),s("span",{staticStyle:{background:"yellow"}},[s("strong",[t._v("ServletContextListener")])]),t._v("，有两个方法，一个在服务器启动后调用，一个在服务器正常关闭前调用\n"),s("ul",[s("li",[s("code",[t._v("void contextInitialized(ServletContextEvent sce)")]),t._v("："),s("strong",[t._v("ServletContext对象创建后")]),t._v("会调用该方法")]),t._v(" "),s("li",[s("code",[t._v("void contextDestroyed(ServletContextEvent sce)")]),t._v("："),s("strong",[t._v("ServletContext对象被销毁之前")]),t._v("会调用该方法")])])]),t._v(" "),s("li",[t._v("属性监听："),s("strong",[t._v("ServletContextAttributeListener")]),t._v("，它有三个方法，在添加、替换、移除属性时调用\n"),s("ul",[s("li",[t._v("void attributeAdded(ServletContextAttributeEvent event)：添加属性时")]),t._v(" "),s("li",[t._v("void attributeReplaced(ServletContextAttributeEvent event)：替换属性时")]),t._v(" "),s("li",[t._v("void attributeRemoved(ServletContextAttributeEvent event)：移除属性时")])])])]),t._v(" "),s("h3",{attrs:{id:"监听-httpsession"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#监听-httpsession"}},[t._v("#")]),t._v(" 监听 HttpSession")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("生命周期监听："),s("strong",[t._v("HttpSessionListener")]),t._v("，它有两个方法，一个在出生时调用，一个在死亡时调用")]),t._v(" "),s("ul",[s("li",[t._v("void sessionCreated(HttpSessionEvent se)：创建session时")]),t._v(" "),s("li",[t._v("void sessionDestroyed(HttpSessionEvent se)：销毁session时")])])]),t._v(" "),s("li",[s("p",[t._v("属性监听："),s("strong",[t._v("HttpSessioniAttributeListener")]),t._v("，它有三个方法，在添加、替换、移除属性时调用")]),t._v(" "),s("ul",[s("li",[t._v("void attributeAdded(HttpSessionBindingEvent event)：添加属性时")]),t._v(" "),s("li",[t._v("void attributeReplaced(HttpSessionBindingEvent event)：替换属性时")]),t._v(" "),s("li",[t._v("void attributeRemoved(HttpSessionBindingEvent event)：移除属性时")])])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("感知监听")]),t._v("：用来"),s("strong",[t._v("添加到JavaBean上（需实现接口）")]),t._v("，"),s("strong",[t._v("不需要在web.xml中注册")])]),t._v(" "),s("ul",[s("li",[s("p",[s("strong",[t._v("HttpSessionBindingListener")]),t._v("：添加到javabean上，javabean就知道自己是否添加到session中")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("HttpSessionActivationListener")]),t._v("：监听JavaBean(实现序列化接口)是否随Session被钝化、活化")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Session的序列化：context.xml中打开被注释掉的Manager即可不允许Session序列化")])]),t._v(" "),s("li",[s("p",[t._v("Tomcat会在session长时间不被使用时"),s("strong",[t._v("钝化")]),t._v("session对象，所谓钝化session，就是把session通过序列化的方式"),s("strong",[t._v("保存到硬盘文件中")]),t._v("。当用户再使用session时，Tomcat还会把钝化的对象再活化session，所谓活化就是把硬盘文件中的session在反序列化回内存")]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!--配置Tomcat钝化session参数;放到tomcat\\conf\\catalina\\localhost\\项目名--\x3e")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Context")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Manager")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("className")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("org.apache.catalina.session.PersistentManager"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("maxIdleSwap")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Store")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("className")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("org.apache.catalina.session.FileStore"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("directory")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("mysession"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("Manager")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("Context")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])])])])])])])]),t._v(" "),s("h3",{attrs:{id:"监听-servletrequest"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#监听-servletrequest"}},[t._v("#")]),t._v(" 监听 ServletRequest")]),t._v(" "),s("ul",[s("li",[t._v("生命周期监听："),s("strong",[t._v("ServletRequestListener")]),t._v("，它有两个方法，一个在出生时调用，一个在死亡时调用\n"),s("ul",[s("li",[t._v("void requestInitialized(ServletRequestEvent sre)：创建request时")]),t._v(" "),s("li",[t._v("void requestDestroyed(ServletRequestEvent sre)：销毁request时")])])]),t._v(" "),s("li",[t._v("属性监听："),s("strong",[t._v("ServletRequestAttributeListener")]),t._v("，它有三个方法，在添加、替换、移除属性时调用\n"),s("ul",[s("li",[t._v("void attributeAdded(ServletRequestAttributeEvent srae)：添加属性时")]),t._v(" "),s("li",[t._v("void attributeReplaced(ServletRequestAttributeEvent srae)：替换属性时")]),t._v(" "),s("li",[t._v("void attributeRemoved(ServletRequestAttributeEvent srae)：移除属性时")])])])]),t._v(" "),s("h3",{attrs:{id:"事件对象"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#事件对象"}},[t._v("#")]),t._v(" 事件对象")]),t._v(" "),s("ul",[s("li",[s("p",[s("strong",[t._v("ServletContextEvent")]),t._v("："),s("code",[t._v("ServletContext getServletContext()")]),t._v("，"),s("strong",[t._v("可以获取"),s("code",[t._v("ServletContext")])])])]),t._v(" "),s("li",[s("p",[t._v("ServletContextAttributeEvent：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("ServletContext getServletContext()；")])]),t._v(" "),s("li",[s("p",[t._v("String getName()：获取属性名")])]),t._v(" "),s("li",[s("p",[t._v("Object getValue()：获取属性值")])])])]),t._v(" "),s("li",[s("p",[t._v("HttpSessionEvent：HttpSession getSession()")])]),t._v(" "),s("li",[s("p",[t._v("HttpSessionBindingEvent：略")])]),t._v(" "),s("li",[s("p",[t._v("ServletRequestEvent ：")]),t._v(" "),s("ul",[s("li",[t._v("ServletContext getServletContext()；")]),t._v(" "),s("li",[t._v("ServletRequest getServletRequest()；")])])]),t._v(" "),s("li",[s("p",[t._v("ServletRequestAttributeEvent ：略")])])])])}),[],!1,null,null,null);e.default=n.exports}}]);